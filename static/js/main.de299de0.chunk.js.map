{"version":3,"sources":["utils/serviceUtils/storageUtil.tsx","utils/fileUtils/xmlUtil.tsx","utils/readUtils/linkUtil.tsx","model/Note.ts","components/popups/popupNote/component.tsx","components/popups/popupNote/index.tsx","components/colorOption/component.tsx","components/colorOption/index.tsx","constants/popupList.tsx","components/popups/popupOption/component.tsx","components/popups/popupOption/index.tsx","constants/translationList.tsx","components/popups/popupTrans/component.tsx","components/popups/popupTrans/index.tsx","components/popups/popupMenu/component.tsx","components/popups/popupMenu/index.tsx","components/dialogs/deletePopup/component.tsx","components/dialogs/deletePopup/index.tsx","utils/readUtils/recordLocation.tsx","utils/fileUtils/bookUtil.tsx","model/Book.ts","containers/htmlViewer/component.tsx","utils/readUtils/recordRecent.tsx","constants/mimetype.tsx","utils/fileUtils/rtfUtil.tsx","utils/serviceUtils/langUtil.tsx","components/background/component.tsx","components/background/index.tsx","components/imageViewer/component.tsx","components/imageViewer/index.tsx","utils/serviceUtils/mouseEvent.tsx","utils/serviceUtils/docUtil.tsx","store/actions/manager.tsx","store/actions/book.tsx","store/actions/backupPage.tsx","store/actions/progressPanel.tsx","store/actions/reader.tsx","store/actions/sidebar.tsx","store/actions/viewArea.tsx","utils/readUtils/addTrash.tsx","utils/readUtils/sortUtil.tsx","utils/serviceUtils/urlUtil.tsx","utils/syncUtils/common.tsx","i18n.tsx","store/reducers/book.tsx","store/reducers/manager.tsx","store/reducers/progressPanel.tsx","store/reducers/reader.tsx","store/reducers/viewArea.tsx","store/reducers/sidebar.tsx","store/reducers/backupPage.tsx","store/index.tsx","constants/sideMenu.tsx","containers/sidebar/component.tsx","containers/sidebar/index.tsx","utils/serviceUtils/searchUtil.tsx","components/searchBox/component.tsx","components/searchBox/index.tsx","utils/fileUtils/md5Util.tsx","utils/fileUtils/fileUtil.tsx","components/importLocal/component.tsx","components/importLocal/index.tsx","components/dialogs/updateDialog/component.tsx","components/dialogs/updateDialog/index.tsx","utils/syncUtils/restoreUtil.tsx","utils/syncUtils/backupUtil.tsx","containers/header/component.tsx","containers/header/index.tsx","utils/readUtils/deleteUtil.tsx","utils/readUtils/shelfUtil.tsx","utils/readUtils/addFavorite.tsx","components/dialogs/deleteDialog/component.tsx","components/dialogs/deleteDialog/index.tsx","components/dialogs/editDialog/component.tsx","components/dialogs/editDialog/index.tsx","components/dialogs/addDialog/component.tsx","components/dialogs/addDialog/index.tsx","components/dialogs/sortDialog/component.tsx","components/dialogs/sortDialog/index.tsx","components/dialogs/aboutDialog/component.tsx","components/dialogs/aboutDialog/index.tsx","constants/driveList.tsx","utils/syncUtils/dropbox.tsx","utils/syncUtils/webdav.tsx","components/dialogs/tokenDialog/component.tsx","components/dialogs/tokenDialog/index.tsx","components/dialogs/backupDialog/component.tsx","components/dialogs/backupDialog/index.tsx","constants/dropdownList.tsx","constants/settingList.tsx","constants/themeList.tsx","components/dialogs/settingDialog/component.tsx","components/dialogs/settingDialog/index.tsx","components/dialogs/actionDialog/component.tsx","components/dialogs/actionDialog/index.tsx","components/emptyCover/index.tsx","components/bookCardItem/component.tsx","components/bookCardItem/index.tsx","components/bookListItem/component.tsx","components/bookListItem/index.tsx","components/bookCoverItem/component.tsx","components/bookCoverItem/index.tsx","constants/emptyList.tsx","containers/emptyPage/component.tsx","containers/emptyPage/index.tsx","constants/viewMode.tsx","components/viewMode/component.tsx","components/viewMode/index.tsx","components/selectBook/component.tsx","components/selectBook/index.tsx","components/shelfSelector/component.tsx","components/shelfSelector/index.tsx","containers/lists/bookList/component.tsx","containers/lists/bookList/index.tsx","containers/lists/deletedBookList/component.tsx","containers/lists/deletedBookList/index.tsx","containers/lists/cardList/component.tsx","containers/lists/cardList/index.tsx","containers/lists/noteList/component.tsx","containers/lists/noteList/index.tsx","containers/lists/digestList/component.tsx","containers/lists/digestList/index.tsx","containers/loadingPage/component.tsx","containers/loadingPage/index.tsx","router/routes.tsx","components/arrow/index.tsx","components/dialogs/loadingDialog/index.tsx","components/dialogs/TipDialog/component.tsx","components/dialogs/TipDialog/index.tsx","pages/manager/component.tsx","pages/manager/index.tsx","containers/pageWidget/component.tsx","containers/pageWidget/index.tsx","utils/readUtils/themeUtil.tsx","components/readerSettings/themeList/component.tsx","components/readerSettings/themeList/index.tsx","components/readerSettings/sliderList/component.tsx","components/readerSettings/sliderList/index.tsx","components/readerSettings/dropdownList/component.tsx","components/readerSettings/dropdownList/index.tsx","components/readerSettings/modeControl/component.tsx","components/readerSettings/modeControl/index.tsx","components/textToSpeech/component.tsx","components/textToSpeech/index.tsx","components/readerSettings/settingSwitch/component.tsx","components/readerSettings/settingSwitch/index.tsx","containers/panels/settingPanel/component.tsx","containers/panels/settingPanel/index.tsx","containers/lists/contentList/component.tsx","containers/lists/contentList/index.tsx","containers/lists/navList/component.tsx","containers/lists/navList/index.tsx","containers/panels/navigationPanel/component.tsx","containers/panels/navigationPanel/index.tsx","model/Bookmark.ts","containers/panels/operationPanel/component.tsx","containers/panels/operationPanel/index.tsx","containers/panels/progressPanel/component.tsx","containers/panels/progressPanel/index.tsx","containers/htmlViewer/index.tsx","pages/htmlReader/component.tsx","pages/htmlReader/index.tsx","components/backToMain/index.tsx","pages/djvuReader/component.tsx","pages/djvuReader/index.tsx","pages/pdfReader/component.tsx","pages/pdfReader/index.tsx","pages/redirect/component.tsx","pages/redirect/index.tsx","router/index.tsx","utils/serviceUtils/analytics.tsx","utils/serviceUtils/launchUtil.tsx","index.tsx","utils/readUtils/tagUtil.tsx","components/noteTag/component.tsx","components/noteTag/index.tsx","utils/readUtils/styleUtil.tsx","utils/readUtils/readingTime.tsx","utils/fileUtils/pdfUtil.tsx","components/deleteIcon/component.tsx","components/deleteIcon/index.tsx"],"names":["StorageUtil","key","JSON","parse","localStorage","getItem","value","readerConfig","setItem","stringify","kookitConfig","xmlMetadata","xml","Promise","resolve","reject","objBook","xml2js","Parser","parseString","err","result","console","log","fictionBook","FictionBook","bookDesc","description","name","author","binary","cover","xmlBookParser","bookString","bookStart","match","bookBody","slice","search","length","replace","xmlImageHandler","strArr","split","i","j","startsWith","id","join","handleLinkJump","event","href","target","parentNode","innerText","indexOf","src","openExternalUrl","Note","bookKey","chapter","chapterIndex","text","cfi","range","notes","percentage","color","tag","date","this","Date","getTime","year","getFullYear","month","getMonth","day","getDate","classes","PopupNote","props","handleTag","setState","removePDFHighlight","selected","colorCode","noteKey","iWin","getPDFIframeDoc","pageIndex","page","PDFViewerApplication","pdfViewer","getPageView","div","textLayer","textLayerDiv","querySelectorAll","forEach","item","getAttribute","removeChild","handleClose","note","noteIndex","index","splice","localforage","then","handleOpenMenu","handleMenuMode","toast","success","t","handleFetchNotes","handleNoteKey","state","textArea","document","querySelector","focus","currentBook","format","RecordLocation","getPDFLocation","md5","getHtmlLocation","pageArea","getElementById","iframe","getElementsByTagName","charRange","doc","contentDocument","window","rangy","getSelection","saveCharacterRanges","body","getHightlightCoords","toString","noteArr","push","className","style","position","bottom","height","onClick","Trans","createNote","React","Component","actionCreator","connect","book","reader","withTranslation","ColorOption","handleChangeOption","isLine","map","backgroundColor","border","handleColor","setReaderConfig","borderBottom","handleSelection","About","popupList","title","icon","PopupOption","handleNote","handleChangeDirection","handleEdge","offsetLeft","clientWidth","popupMenu","posX","left","posY","top","parseInt","substr","rightEdge","pageWidth","setAttribute","handleCopy","copy","getIframeDoc","empty","handleTrans","handleOriginalText","handleDigest","digest","handleJump","url","handleSearchInternet","getReaderConfig","navigator","language","handleSearchBook","leftPanel","clickEvent","MouseEvent","view","bubbles","cancelable","dispatchEvent","focusEvent","searchBox","searchIcon","keyEvent","KeyboardEvent","keyCode","handleSpeak","msg","SpeechSynthesisUtterance","voice","speechSynthesis","getVoices","speak","trigger","selection","viewArea","translationList","lang","PopupTrans","script","createElement","type","head","appendChild","handleCallback","res","error_code","translatedText","trans_result","dst","originalText","display","width","onChange","targetLang","colors","lines","PopupMenu","highlighter","timer","mode","showNote","isFirstShow","rect","getHighlighter","createHighlighter","config","ignoreWhiteSpace","elementTagName","elementProperties","onclick","handleNoteClick","onElementCreate","element","dataset","applier","createClassApplier","addClassApplier","sel","getRangeAt","removeAllRanges","addRange","getBoundingClientRect","showMenu","handleClickHighlighter","currentTarget","stopPropagation","handlePDFClick","showPDFHighlight","pageElement","viewport","coords","bounds","convertToViewportRectangle","el","Math","min","abs","addEventListener","dialog","filter","handleShowDelete","deleteKey","x","y","pageHeight","menuMode","renderHighlighters","highlighters","highlightersByChapter","contentWindow","defaultView","removeAllHighlights","temp","restoreCharacterRanges","highlightSelection","e","warn","openMenu","isOpenMenu","isCollapsed","rendition","on","setTimeout","nextProps","handleHighlight","PopupProps","isChangeDirection","digests","DeletePopup","handleCancel","handleDeletePopup","handleComfirm","handleDeleteOpearion","handleFetchBooks","json","obj","chapterTitle","count","location","fingerprint","arr","files","_","findLastIndex","_obj","Kookit","MobiRender","Azw3Render","EpubRender","BookUtil","buffer","isElectron","fs","require","path","dataPath","ipcRenderer","sendSync","FileReader","readAsArrayBuffer","Blob","onload","a","writeFileSync","Buffer","from","onerror","remove","removeItem","bookPath","_bookPath","existsSync","isArrayBuffer","data","readFileSync","blobTemp","fileTemp","File","lastModified","Uint8Array","isBookExist","error","ref","toLowerCase","invoke","isMergeWord","isFullscreen","isPreventSleep","open","__dirname","pdfLocation","URL","platform","bookName","extension","size","file_content","publisher","charset","getPDFCover","epubRendition","getMetadata","metadata","creator","compression","chardet","detect","fb2Str","iconv","decode","fb2Obj","toUpperCase","BookModel","Book","TxtRender","StrRender","ComicRender","Unrar","JSZip","Viewer","lock","handlePageWidth","handleRenderBook","handleHtmlBook","removeContent","init","fetchBook","handleMobi","handleAzw3","handleEpub","handleTxt","handleMD","handleFb2","handleRtf","handleDocx","handleHtml","handleCbr","handleCbt","handleCbz","handleReadingState","RecentBooks","setRecent","handleRest","HtmlMouseEvent","readerMode","getChapter","chapters","flattenChapters","flatChapter","getPageSize","StyleUtil","addDefaultCss","setStyle","getCustomCss","bookLocation","goToPosition","handleCurrentChapter","htmlBook","label","trim","tsTransform","handleLeaveReader","unrar","entries","getEntries","renderTo","getElementsByClassName","zip","loadAsync","contents","Object","keys","sort","untar","extractedFiles","extractedFile","handleCharset","books","handleReadingBook","blob","evt","docStr","marked","readAsText","rtfToHTML","fromString","html","removeExtraQuestionMark","mammoth","convertToHtml","arrayBuffer","bookObj","mimetype","toLocaleLowerCase","cfiRange","isFirst","scale","margin","handleFetchBookmarks","doit","handleRenderFunc","clearTimeout","ab","buf","alloc","byteLength","extraMargin","right","parseFloat","overflowY","overflowX","isShow","handleEnterReader","withRouter","RecordRecent","bookArr","unshift","svg","png","jpg","jpeg","gif","webp","rar","tar","htm","xhtml","replaceAll","innerHTML","Chinese","s2t","t2s","Background","isSingle","background","boxShadow","ImageViewer","showImage","preventDefault","isShowImage","zoomIndex","rotateIndex","imageRatio","img","Image","direction","naturalWidth","naturalHeight","image","hideImage","handleZoomIn","marginTop","handleZoomOut","handleSave","fetch","r","FileSaver","saveAs","toLocaleDateString","handleClock","transform","handleCounterClock","alt","Hammer","sleep","ms","throttleTime","arrowKeys","prev","next","handleShortcut","mouseChrome","wheelDelta","gesture","handleLocation","getPosition","recordHtmlLocation","record","bindHtmlEvent","pdfMouseEvent","djvuMouseEvent","handleBooks","payload","handleDeletedBooks","deletedBooks","handleSearchResults","searchResults","handleSearch","isSearch","handleTipDialog","isTipDialog","handleTip","tip","handleSetting","isSettingOpen","handleAbout","isAboutOpen","handleSortDisplay","isSortDisplay","handleLoadingDialog","isShowLoading","handleNewDialog","isShowNew","handleSelectBook","isSelectBook","handleSelectedBooks","selectedBooks","handleNewWarning","isNewWarning","handleBookSort","isBookSort","handleNoteSort","isNoteSort","handleBookSortCode","bookSortCode","handleNoteSortCode","noteSortCode","isTrash","dispatch","keyArr","AddTrash","getAllTrash","handleKeyFilter","handleKeyRemove","handleFetchBookSortCode","SortUtil","getBookSortCode","handleFetchNoteSortCode","getNoteSortCode","handleFetchList","viewMode","items","itemArr","handleEditDialog","handleDeleteDialog","handleAddDialog","renderFunc","handleActionDialog","handleDragItem","handleBackupDialog","handleTokenDialog","handleFetchPercentage","handlePercentage","handleBookmarks","bookmarks","currentChapter","bookmarkArr","handleShelfIndex","shelfIndex","handleCollapse","handleMode","handleShowBookmark","isShowBookmark","getBookName","getAuthorName","getBookKey","getBookIndex","nameArr","oldNameArr","indexArr","concat","oldRecentArr","recentArr","getAllRecent","order","reverse","durationKeys","durationObj","ReadingTime","getAllTime","sortable","b","getDurationArr","bookKeys","union","oldAuthorArr","authorArr","percentagenKeys","locationObj","getAllCfi","getPercentageArr","clone","dateArr","uniq","noteObj","sortCode","orderCode","shell","openExternal","configArr","getParamsFromUrl","hashParams","q","hash","substring","exec","decodeURIComponent","changePath","oldPath","newPath","readdir","isConfiged","file","emptyDirSync","syncData","isSync","AdmZip","extractAllTo","deleteBooks","all","zipBook","bookZip","folder","results","unzipConfig","content","async","catch","unzipBook","addBook","zipConfig","resources","en","translation","translationEN","zh","translationCN","cht","translationTW","jp","translationJP","ru","translationRU","es","fr","translationFR","fa","ptBR","i18n","use","initReactI18next","lng","fallbackLng","keySeparator","interpolation","escapeValue","initState","isOpenEditDialog","isOpenDeleteDialog","isOpenAddDialog","isOpenActionDialog","isReading","dragItem","message","locations","isBackup","isOpenTokenDialog","rootReducer","combineReducers","action","isRedirect","manager","section","progressPanel","isOpenHighlight","dialogLocation","sidebar","backupPage","store","createStore","compose","applyMiddleware","thunk","devToolsExtension","f","sideMenu","Sidebar","handleSidebar","history","handleHover","hoverIndex","distance","onMouseEnter","onMouseLeave","marginLeft","SearchUtil","arr1","arr2","_arr","flag","list","keyWord","keyword","bookNameArr","AuthorNameArr","bookResults","fuzzyQuery","authorResults","MergeArray","textArr","noteResults","textResults","SearchBox","handleMouse","refs","isNavSearch","handleSearchState","tabMode","MouseNoteSearch","MouseSearch","handleKey","KeyNoteSearch","KeySearch","doSearch","searchList","handleSearchList","excerpt","onKeyDown","onFocus","placeholder","paddingRight","onCompositionStart","onCompositionEnd","pdfjsLib","fetchMD5","fileReader","ev","getDocument","promise","pdfDoc","_pdfInfo","blobSlice","prototype","mozSlice","webkitSlice","chunkSize","chunks","ceil","currentChunk","spark","SparkMD5","Error","appendBinary","loadNext","end","start","readAsBinaryString","call","fetchFileFromPath","filePath","readFile","clickFilePath","ImportLocal","handleFilePath","isRepeat","repeatBook","isOpenFile","getMd5WithBrowser","getBookUrl","RedirectBook","handleAddBook","handleBook","generateBook","_filePath","onDrop","acceptedFiles","handleDrag","accept","multiple","getRootProps","getInputProps","fontSize","fontWeight","newOptions","loop","autoplay","animationData","animationNew","rendererSettings","preserveAspectRatio","successOptions","animationSuccess","UpdateInfo","renderList","updateLog","isUpdated","axios","get","newVersion","version","localeCompare","options","marginBottom","new","fix","restore","backup","generateAsync","Header","syncFromLocation","storageLocation","sourcePath","outPath","isdataChange","lastSyncTime","handleSync","syncToLocation","timestamp","isOnlyLocal","isNewVersion","dirPath","mkdirSync","DeleteUtil","defaultShelf","New","Study","Work","Entertainment","ShelfUtil","shelfTitle","undefined","currentShelfTitle","shelfList","AddFavorite","DeleteDialog","handleDeleteOther","deleteBookmarks","deleteNotes","clearShelf","deleteBook","setTrash","clear","deletefromAllShelf","i18nKey","EditDialog","isCheck","nameBox","authorBox","AddDialog","inputElement","isNaN","getShelf","shelfTitles","isNew","hasOwnProperty","setShelf","handleChange","renderShelfList","disabled","SortDialog","handleSort","code","isNote","setNoteSortCode","setBookSortCode","handleOrder","opacity","AboutDialog","callback_url","token_url","dropbox_client_id","googledrive_client_id","onedrive_client_id","driveList","Dropbox","DropboxUtil","ACCESS_TOKEN","dbx","accessToken","filesUpload","response","filesListFolder","folderArr","filesDownload","fileBlob","lastModifiedDate","WebdavUtil","UploadFile","createClient","username","password","client","wfs","exists","createDirectory","writeFile","copyFile","DownloadFile","request","downloadLink","getFileDownloadLink","stream","createWriteStream","pipe","TokenDialog","handleTokenComfirm","token","driveName","handleDavComfirm","BackupDialog","handleFinish","currentStep","showMessage","handleRestoreToLocal","handleDrive","currentDrive","dialogProps","lineHeight","dropdownList","option","speedList","settingList","desc","propName","langList","skinList","readerSettingList","backgroundList","textList","themeList","SettingDialog","bool","changeLanguage","changeSearch","searchEngine","changeSkin","skin","reload","changeFont","font","stateName","handleChangeLocation","filePaths","handleTheme","currentThemeIndex","handleMergeWord","isOpenInMain","handleOpenInMain","isTouch","isImportPath","isPreventTrigger","isAutoFullscreen","isPreventAdd","isOpenBook","isExpandContent","isDisableUpdate","appSkin","isDisableAnalytics","isUseBuiltIn","isPDFCover","children","transition","ActionDialog","handleDeleteBook","handleEditBook","handleAddShelf","handleRestoreBook","maxHeight","paddingTop","toFixed","toLocaleString","getBookPosition","emptyCover","BookCardItem","handleMoreAction","clientX","clientHeight","clientY","handleLoveBook","setFavorite","isFavorite","handleCancelLoveBook","getAllFavorite","handleConfig","isOpenConfig","isSelected","actionProps","onMouseOver","onContextMenu","floor","BookListItem","handleResoreBook","isDeleteDialog","round","BookItem","BookCoverItem","emptyList","main","sub","EmptyPage","visibility","ViewMode","SelectBook","isOpenDelete","favoriteBooks","ShelfChooser","handleShelfItem","handleDeleteShelf","removeShelf","deletePopupProps","BookList","subItem","handleIndexFilter","renderBookList","handleShelf","sortBooks","zIndex","to","currentShelfList","CardList","handleBookName","recordPDFLocation","cards","sortNotes","cardProps","itemKey","overflow","isCard","NoteList","handleFilter","filterTag","noteProps","DigestList","LoadingPage","routes","component","DeletedBookList","Arrow","xmlns","viewBox","fill","stroke","strokeWidth","cx","cy","y2","strokeLinecap","d","defaultOptions","LoadingDialog","downloadOptions","TipDialog","Manager","isDrag","totalBooks","isAuthed","isError","isCopied","isMobile","onDragEnter","ele","render","prevPage","nextPage","isHideFooter","isHideHeader","getProgress","pageInfo","currentPage","ThemeUtil","themeName","themeArr","ThemeList","handleChangeBgColor","currentBackgroundIndex","handleChooseBgColor","handleColorTextPicker","isShowTextPicker","getAllThemes","findIndex","setThemes","handleColorBgPicker","isShowBgPicker","handleChooseTextColor","currentTextIndex","enableAlpha","animation","SliderList","onValueChange","letterSpacing","paraSpacing","brightness","onValueInput","handleMinus","step","handleAdd","defaultValue","onBlur","minLabel","max","maxValue","minValue","onInput","onMouseUp","maxLabel","DropdownList","currentFontFamilyIndex","currentLineHeightIndex","currentTextAlignIndex","chineseConversionIndex","getFonts","disableQuoting","handleView","ModeControl","handleChangeMode","TextToSpeech","handleChangeAudio","isAudioOn","cancel","synth","setInterval","clearInterval","isSupported","voices","handleAudio","visibleText","handleSpeech","voiceIndex","speed","rate","onend","SettingSwitch","_handleRest","_handleChange","isBold","isIndent","isSliding","isUnderline","isShadow","isItalic","isInvert","isHideBackground","isHidePageButton","isHideMenuButton","SettingPanel","handleLock","isSettingLocked","float","ContentList","currentIndex","bind","newChapter","subitems","goToChapter","renderContentList","level","NavList","deleteIndex","currentData","currentTab","bookmarkProps","cursor","NavigationPanel","handleChangeTab","isNavLocked","renderSearchList","renderSearchPage","startIndex","pageList","total","searchProps","time","Bookmark","OperationPanel","timeStamp","handleAddBookmark","bookmark","isBookmark","currentPercentage","timeLeft","now","pageProgress","totalPage","handleFullScreen","handleExitFullScreen","setTime","de","documentElement","requestFullscreen","fullscreenElement","exitFullscreen","handleExit","close","handleScreen","ProgressPanel","onProgressChange","onProgressInput","displayPercentage","nextChapter","prevChapter","handleJumpChapter","currentChapterIndex","onTouchEnd","Reader","messageTimer","tickTimer","isOpenRightPanel","isOpenLeftPanel","isOpenTopPanel","isOpenBottomPanel","hoverPanel","renditionProps","handleDjvu","ViewerInstance","DjVu","loadDocument","loading","getPDFUrl","scrollWidth","scrollHeight","status","callback","Redirect","alert","params","access_token","Router","useEffect","DjvuReader","HtmlReader","PDFReader","_Redirect","ga","clientId","GA","debug","process","set","pkg","one","mac","getClientId","pageview","evCategory","evAction","clientID","exDesc","exFatal","exception","elem","rel","isNight","matchMedia","matches","initTheme","ReactDOM","evLabel","removeScript","applyTheme","TagUtil","tagName","tagArr","NoteTag","tagToIndex","getAllTags","indextoTag","tagIndex","handleChangeTag","indexResult","handleAddTag","isInput","setTags","handleInput","handleShowTags","isShowTags","offsetTop","styleUtil","css","getDefaultCss","textContent","isJSON","padding","addStyle","currentPageNumber","pageRect","canvas","getClientRects","selectionRects","tempRect","convertToPdfPoint","getPage","getViewport","context","getContext","canvasContext","toDataURL","DeleteIcon","handleDelete","deleteItems","deleteFunc"],"mappings":"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","file":"static/js/main.de299de0.chunk.js","sourcesContent":["class StorageUtil {\r\n  static getReaderConfig(key: string) {\r\n    let readerConfig = JSON.parse(localStorage.getItem(\"readerConfig\")!) || {};\r\n    return readerConfig[key];\r\n  }\r\n\r\n  static setReaderConfig(key: string, value: string) {\r\n    let readerConfig = JSON.parse(localStorage.getItem(\"readerConfig\")!) || {};\r\n    readerConfig[key] = value;\r\n    localStorage.setItem(\"readerConfig\", JSON.stringify(readerConfig));\r\n  }\r\n  static getKookitConfig(key: string) {\r\n    let kookitConfig = JSON.parse(localStorage.getItem(\"kookitConfig\")!) || {};\r\n    return kookitConfig[key];\r\n  }\r\n\r\n  static setKookitConfig(key: string, value: string) {\r\n    let kookitConfig = JSON.parse(localStorage.getItem(\"kookitConfig\")!) || {};\r\n    kookitConfig[key] = value;\r\n    localStorage.setItem(\"kookitConfig\", JSON.stringify(kookitConfig));\r\n  }\r\n}\r\n\r\nexport default StorageUtil;\r\n","import xml2js from \"xml2js\";\r\nexport const xmlMetadata = (xml: string) => {\r\n  return new Promise<object>((resolve, reject) => {\r\n    var objBook: any = {};\r\n    let parser = new xml2js.Parser();\r\n    parser.parseString(xml, function (err, result) {\r\n      if (err) {\r\n        console.log(\"Error with parsing xml\" + err);\r\n        resolve({});\r\n      }\r\n      var fictionBook = result.FictionBook;\r\n      var bookDesc = fictionBook.description[0][\"title-info\"][0];\r\n      objBook.name = bookDesc[\"book-title\"][0];\r\n\r\n      if (bookDesc[\"author\"] && bookDesc[\"author\"][0][\"first-name\"]) {\r\n        objBook.author = bookDesc[\"author\"][0][\"first-name\"][0];\r\n\r\n        if (bookDesc[\"author\"][0][\"last-name\"]) {\r\n          objBook.author += \" \" + bookDesc[\"author\"][0][\"last-name\"][0];\r\n        }\r\n      }\r\n      if (fictionBook.binary) {\r\n        objBook.cover = \"data:image/jpeg;base64,\" + fictionBook.binary[0][\"_\"];\r\n      }\r\n      resolve(objBook);\r\n    });\r\n  });\r\n};\r\n\r\nexport const xmlBookParser = (xml: any, bookString: string) => {\r\n  var regExpTagDelete = /<epigraph>|<\\/epigraph>|<empty-line\\/>|/gi;\r\n  var regExpTitleOpen = /<title>/gi;\r\n  var regExpTitleClose = /<\\/title>/gi;\r\n  var bookStart = bookString.match(/<body.*?>/i) || [\"\"];\r\n  var bookBody = bookString.slice(\r\n    bookString.search(/<body.*?>/i) + bookStart[0].length,\r\n    bookString.search(/<\\/body>/i)\r\n  );\r\n\r\n  bookBody = bookBody.replace(regExpTagDelete, \"\");\r\n  bookBody = bookBody.replace(regExpTitleOpen, \"<h3>\");\r\n  bookBody = bookBody.replace(regExpTitleClose, \"</h3>\");\r\n\r\n  return xmlImageHandler(xml, bookBody);\r\n};\r\n\r\nexport const xmlImageHandler = (xml: any, bookString: string) => {\r\n  let parser = new xml2js.Parser();\r\n  parser.parseString(xml, function (err, result) {\r\n    if (err) {\r\n      console.log(\"Error with parsing xml\" + err);\r\n      return \"\";\r\n    }\r\n\r\n    var fictionBook = result.FictionBook;\r\n    if (fictionBook.binary) {\r\n      let strArr = bookString.split(`<image xlink:href=\"#`);\r\n\r\n      for (let i = 0; i < strArr.length; i++) {\r\n        for (let j = 0; j < fictionBook.binary.length; j++) {\r\n          if (strArr[i].startsWith(fictionBook.binary[j][\"$\"].id)) {\r\n            strArr[i] =\r\n              '<img alt=\"poster\" style=\"max-width: 100%; max-height: 100%\" src=\"' +\r\n              \"data:image/jpeg;base64,\" +\r\n              fictionBook.binary[j][\"_\"] +\r\n              strArr[i].slice(fictionBook.binary[j][\"$\"].id.length);\r\n          }\r\n        }\r\n      }\r\n\r\n      bookString = strArr.join(\"\");\r\n    }\r\n  });\r\n\r\n  return bookString;\r\n};\r\n","import { openExternalUrl } from \"../serviceUtils/urlUtil\";\r\n\r\nexport const handleLinkJump = (event: any) => {\r\n  let href;\r\n\r\n  if (\r\n    event.target &&\r\n    event.target.parentNode &&\r\n    event.target.parentNode.parentNode\r\n  ) {\r\n    href =\r\n      (event.target.innerText.indexOf(\"http\") > -1 && event.target.innerText) ||\r\n      event.target.src ||\r\n      event.target.href ||\r\n      event.target.parentNode.href ||\r\n      event.target.parentNode.parentNode.href ||\r\n      \"\";\r\n  }\r\n  if (\r\n    href &&\r\n    href.indexOf(\"../\") === -1 &&\r\n    href.indexOf(\"http\") === 0 &&\r\n    href.indexOf(\"OEBPF\") === -1 &&\r\n    href.indexOf(\"OEBPS\") === -1 &&\r\n    href.indexOf(\"footnote\") === -1 &&\r\n    href.indexOf(\"blob\") === -1 &&\r\n    href.indexOf(\"data:application\") === -1 &&\r\n    href.indexOf(\".htm\") === -1\r\n  ) {\r\n    openExternalUrl(href);\r\n  }\r\n};\r\n","class Note {\r\n  key: string;\r\n  bookKey: string;\r\n  date: { year: number; month: number; day: number };\r\n  chapter: string;\r\n  chapterIndex: number;\r\n  text: string;\r\n  cfi: string;\r\n  range: string;\r\n  notes: string;\r\n  percentage: number;\r\n  color: number;\r\n  tag: string[];\r\n  constructor(\r\n    bookKey: string,\r\n    chapter: string,\r\n    chapterIndex: number,\r\n    text: string,\r\n    cfi: string,\r\n    range: string,\r\n    notes: string,\r\n    percentage: number,\r\n    color: number,\r\n    tag: string[]\r\n  ) {\r\n    this.key = new Date().getTime() + \"\"; //笔记的键值\r\n    this.bookKey = bookKey; //笔记的所在书的键值\r\n    this.date = {\r\n      year: new Date().getFullYear(),\r\n      month: new Date().getMonth() + 1,\r\n      day: new Date().getDate(),\r\n    }; //笔记的添加日期\r\n    this.chapter = chapter; //笔记的所在章节\r\n    this.chapterIndex = chapterIndex; //笔记的所在章节\r\n    this.text = text; //笔记对应的书本的内容\r\n    this.cfi = cfi; //添加笔记的位置\r\n    this.range = range; // Rangy.js产生的将Range对象序列化后的字符串\r\n    this.notes = notes || \"\"; //笔记的内容\r\n    this.percentage = percentage; //笔记在文中的进度\r\n    this.color = color; //笔记高亮的颜色\r\n    this.tag = tag; //笔记高亮的颜色\r\n  }\r\n}\r\n\r\nexport default Note;\r\n","//添加笔记的弹窗\r\nimport React from \"react\";\r\nimport \"./popupNote.css\";\r\nimport Note from \"../../../model/Note\";\r\nimport localforage from \"localforage\";\r\nimport { PopupNoteProps, PopupNoteState } from \"./interface\";\r\nimport RecordLocation from \"../../../utils/readUtils/recordLocation\";\r\nimport NoteTag from \"../../noteTag\";\r\nimport NoteModel from \"../../../model/Note\";\r\nimport { Trans } from \"react-i18next\";\r\nimport toast from \"react-hot-toast\";\r\nimport { getHightlightCoords } from \"../../../utils/fileUtils/pdfUtil\";\r\nimport { getPDFIframeDoc } from \"../../../utils/serviceUtils/docUtil\";\r\ndeclare var window: any;\r\nlet classes = [\r\n  \"color-0\",\r\n  \"color-1\",\r\n  \"color-2\",\r\n  \"color-3\",\r\n  \"line-0\",\r\n  \"line-1\",\r\n  \"line-2\",\r\n  \"line-3\",\r\n];\r\nclass PopupNote extends React.Component<PopupNoteProps, PopupNoteState> {\r\n  constructor(props: PopupNoteProps) {\r\n    super(props);\r\n    this.state = { tag: [] };\r\n  }\r\n  componentDidMount() {\r\n    let textArea: any = document.querySelector(\".editor-box\");\r\n    textArea && textArea.focus();\r\n  }\r\n  handleTag = (tag: string[]) => {\r\n    this.setState({ tag });\r\n  };\r\n  removePDFHighlight = (selected: any, colorCode: string, noteKey: string) => {\r\n    let iWin = getPDFIframeDoc();\r\n    if (!iWin) return;\r\n    var pageIndex = selected.page;\r\n    if (!iWin.PDFViewerApplication.pdfViewer) return;\r\n    var page = iWin.PDFViewerApplication.pdfViewer.getPageView(pageIndex);\r\n    if (page && page.div && page.textLayer && page.textLayer.textLayerDiv) {\r\n      var pageElement =\r\n        colorCode.indexOf(\"color\") > -1\r\n          ? page.textLayer.textLayerDiv\r\n          : page.div;\r\n      let noteElements = pageElement.querySelectorAll(\".pdf-note\");\r\n      noteElements.forEach((item: Element) => {\r\n        if (item.getAttribute(\"key\") === noteKey) {\r\n          item.parentNode?.removeChild(item);\r\n        }\r\n      });\r\n    }\r\n  };\r\n  createNote() {\r\n    let notes = (document.querySelector(\".editor-box\") as HTMLInputElement)\r\n      .value;\r\n    if (this.props.noteKey) {\r\n      //编辑笔记\r\n      this.props.notes.forEach((item) => {\r\n        if (item.key === this.props.noteKey) {\r\n          item.notes = notes;\r\n          item.tag = this.state.tag;\r\n        }\r\n      });\r\n      localforage.setItem(\"notes\", this.props.notes).then(() => {\r\n        this.props.handleOpenMenu(false);\r\n        toast.success(this.props.t(\"Add Successfully\"));\r\n        this.props.handleFetchNotes();\r\n        this.props.handleMenuMode(\"highlight\");\r\n        this.props.handleNoteKey(\"\");\r\n      });\r\n    } else {\r\n      //创建笔记\r\n      let bookKey = this.props.currentBook.key;\r\n      let cfi = \"\";\r\n      if (this.props.currentBook.format === \"PDF\") {\r\n        cfi = JSON.stringify(\r\n          RecordLocation.getPDFLocation(this.props.currentBook.md5)\r\n        );\r\n      } else {\r\n        cfi = JSON.stringify(\r\n          RecordLocation.getHtmlLocation(this.props.currentBook.key)\r\n        );\r\n      }\r\n\r\n      let pageArea = document.getElementById(\"page-area\");\r\n      if (!pageArea) return;\r\n      let iframe = pageArea.getElementsByTagName(\"iframe\")[0];\r\n      if (!iframe) return;\r\n      let doc = iframe.contentDocument;\r\n      if (!doc) {\r\n        return;\r\n      }\r\n      let charRange;\r\n      if (this.props.currentBook.format !== \"PDF\") {\r\n        charRange = window.rangy\r\n          .getSelection(iframe)\r\n          .saveCharacterRanges(doc.body)[0];\r\n      }\r\n\r\n      let range =\r\n        this.props.currentBook.format === \"PDF\"\r\n          ? JSON.stringify(getHightlightCoords())\r\n          : JSON.stringify(charRange);\r\n      let text = doc.getSelection()?.toString();\r\n      if (!text) {\r\n        return;\r\n      }\r\n      text = text.replace(/\\s\\s/g, \"\");\r\n      text = text.replace(/\\r/g, \"\");\r\n      text = text.replace(/\\n/g, \"\");\r\n      text = text.replace(/\\t/g, \"\");\r\n      text = text.replace(/\\f/g, \"\");\r\n      let percentage = 0;\r\n\r\n      let color = this.props.color || 0;\r\n      let tag = this.state.tag;\r\n\r\n      let note = new Note(\r\n        bookKey,\r\n        this.props.chapter,\r\n        this.props.chapterIndex,\r\n        text,\r\n        cfi,\r\n        range,\r\n        notes,\r\n        percentage,\r\n        color,\r\n        tag\r\n      );\r\n\r\n      let noteArr = this.props.notes;\r\n      noteArr.push(note);\r\n      localforage.setItem(\"notes\", noteArr).then(() => {\r\n        this.props.handleOpenMenu(false);\r\n        toast.success(this.props.t(\"Add Successfully\"));\r\n        this.props.handleFetchNotes();\r\n        this.props.handleMenuMode(\"highlight\");\r\n      });\r\n    }\r\n  }\r\n  handleClose = () => {\r\n    let noteIndex = -1;\r\n    let note: NoteModel;\r\n    if (this.props.noteKey) {\r\n      this.props.notes.forEach((item, index) => {\r\n        if (item.key === this.props.noteKey) {\r\n          noteIndex = index;\r\n          note = item;\r\n        }\r\n      });\r\n      if (noteIndex > -1) {\r\n        this.props.notes.splice(noteIndex, 1);\r\n        localforage.setItem(\"notes\", this.props.notes).then(() => {\r\n          this.props.handleOpenMenu(false);\r\n          this.props.handleMenuMode(\"menu\");\r\n          this.removePDFHighlight(\r\n            JSON.parse(note.range),\r\n            classes[note.color],\r\n            note.key\r\n          );\r\n          toast.success(this.props.t(\"Delete Successfully\"));\r\n          this.props.handleMenuMode(\"highlight\");\r\n          this.props.handleFetchNotes();\r\n          this.props.handleNoteKey(\"\");\r\n        });\r\n      }\r\n    } else {\r\n      this.props.handleOpenMenu(false);\r\n      this.props.handleMenuMode(\"menu\");\r\n      this.props.handleNoteKey(\"\");\r\n    }\r\n  };\r\n\r\n  render() {\r\n    let note: NoteModel;\r\n    if (this.props.noteKey) {\r\n      this.props.notes.forEach((item) => {\r\n        if (item.key === this.props.noteKey) {\r\n          note = item;\r\n        }\r\n      });\r\n    }\r\n\r\n    const renderNoteEditor = () => {\r\n      return (\r\n        <div className=\"note-editor\">\r\n          <div className=\"editor-box-parent\">\r\n            <textarea className=\"editor-box\" />\r\n          </div>\r\n          <div\r\n            className=\"note-tags\"\r\n            style={{ position: \"absolute\", bottom: \"0px\", height: \"70px\" }}\r\n          >\r\n            <NoteTag\r\n              {...{\r\n                handleTag: this.handleTag,\r\n                tag: this.props.noteKey && note ? note.tag : [],\r\n              }}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"note-button-container\">\r\n            <span\r\n              className=\"book-manage-title\"\r\n              onClick={() => {\r\n                this.handleClose();\r\n              }}\r\n            >\r\n              {this.props.noteKey ? (\r\n                <Trans>Delete</Trans>\r\n              ) : (\r\n                <Trans>Cancel</Trans>\r\n              )}\r\n            </span>\r\n            <span\r\n              className=\"book-manage-title\"\r\n              onClick={() => {\r\n                this.createNote();\r\n              }}\r\n            >\r\n              <Trans>Confirm</Trans>\r\n            </span>\r\n          </div>\r\n        </div>\r\n      );\r\n    };\r\n    return renderNoteEditor();\r\n  }\r\n}\r\nexport default PopupNote;\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleOpenMenu,\r\n  handleMenuMode,\r\n  handleNoteKey,\r\n  handleFetchNotes,\r\n} from \"../../../store/actions\";\r\nimport { stateType } from \"../../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport PopupNote from \"./component\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentBook: state.book.currentBook,\r\n    notes: state.reader.notes,\r\n    color: state.reader.color,\r\n    noteKey: state.reader.noteKey,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleOpenMenu,\r\n  handleMenuMode,\r\n  handleNoteKey,\r\n  handleFetchNotes,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(PopupNote as any));\r\n","import React from \"react\";\r\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\nimport \"./colorOption.css\";\r\nimport { ColorProps, ColorStates } from \"./interface\";\r\n\r\nclass ColorOption extends React.Component<ColorProps, ColorStates> {\r\n  constructor(props: ColorProps) {\r\n    super(props);\r\n    this.state = {\r\n      isLine: this.props.color > 3 ? true : false,\r\n    };\r\n  }\r\n  handleChangeOption = () => {\r\n    this.setState({ isLine: !this.state.isLine });\r\n  };\r\n  render() {\r\n    const renderLine = () => {\r\n      return [\"#FF0000\", \"#000080\", \"#0000FF\", \"#2EFF2E\"].map((item, index) => {\r\n        return (\r\n          <div\r\n            className=\"line-option\"\r\n            style={{\r\n              border: `${this.props.color === index + 4 ? \"\" : \"2px\"}`,\r\n            }}\r\n            key={item}\r\n            onClick={() => {\r\n              this.props.handleColor(index + 4);\r\n              StorageUtil.setReaderConfig(\r\n                \"highlightIndex\",\r\n                (index + 4).toString()\r\n              );\r\n            }}\r\n          >\r\n            <div\r\n              className=\"demo-line\"\r\n              style={{ borderBottom: `solid 2px ${item}` }}\r\n            ></div>\r\n          </div>\r\n        );\r\n      });\r\n    };\r\n    const renderColor = () => {\r\n      return [\"#FBF1D1\", \"#EFEEB0\", \"#CAEFC9\", \"#76BEE9\"].map((item, index) => {\r\n        return (\r\n          <div\r\n            className=\"color-option\"\r\n            style={{\r\n              backgroundColor: item,\r\n              border: `${this.props.color === index ? \"\" : \"0px\"}`,\r\n            }}\r\n            key={item}\r\n            onClick={() => {\r\n              this.props.handleColor(index);\r\n              StorageUtil.setReaderConfig(\"highlightIndex\", index.toString());\r\n            }}\r\n          ></div>\r\n        );\r\n      });\r\n    };\r\n    return (\r\n      <div className=\"color-option-container\">\r\n        {!this.state.isLine && renderColor()}\r\n        <span\r\n          className=\"icon-sort popup-color-more\"\r\n          onClick={() => {\r\n            this.handleChangeOption();\r\n          }}\r\n        ></span>\r\n        {this.state.isLine && renderLine()}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ColorOption;\r\n","import { connect } from \"react-redux\";\r\nimport { handleColor, handleSelection } from \"../../store/actions\";\r\nimport { stateType } from \"../../store\";\r\nimport About from \"./component\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    color: state.reader.color,\r\n    currentBook: state.book.currentBook,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleColor,\r\n  handleSelection,\r\n};\r\nexport default connect(mapStateToProps, actionCreator)(About);\r\n","export const popupList = [\r\n  { name: \"note\", title: \"Take Note\", icon: \"note\" },\r\n  { name: \"digest\", title: \"Highlight\", icon: \"highlight\" },\r\n  { name: \"translation\", title: \"Translate\", icon: \"translation\" },\r\n  { name: \"copy\", title: \"Copy\", icon: \"copy\" },\r\n  { name: \"search-book\", title: \"Search in the book\", icon: \"search-book\" },\r\n  { name: \"google\", title: \"Search on the internet\", icon: \"google\" },\r\n  { name: \"speaker\", title: \"Speak the text\", icon: \"Speaker\" },\r\n];\r\n","import React from \"react\";\r\nimport \"./popupOption.css\";\r\nimport localforage from \"localforage\";\r\nimport Note from \"../../../model/Note\";\r\nimport { PopupOptionProps } from \"./interface\";\r\nimport ColorOption from \"../../colorOption\";\r\nimport RecordLocation from \"../../../utils/readUtils/recordLocation\";\r\nimport { Tooltip } from \"react-tippy\";\r\nimport { popupList } from \"../../../constants/popupList\";\r\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\r\nimport toast from \"react-hot-toast\";\r\nimport { getSelection } from \"../../../utils/serviceUtils/mouseEvent\";\r\nimport copy from \"copy-text-to-clipboard\";\r\nimport { getHightlightCoords } from \"../../../utils/fileUtils/pdfUtil\";\r\nimport { getIframeDoc } from \"../../../utils/serviceUtils/docUtil\";\r\nimport { openExternalUrl } from \"../../../utils/serviceUtils/urlUtil\";\r\n\r\ndeclare var window: any;\r\n\r\nclass PopupOption extends React.Component<PopupOptionProps> {\r\n  handleNote = () => {\r\n    this.props.handleChangeDirection(false);\r\n    this.props.handleMenuMode(\"note\");\r\n    this.handleEdge();\r\n  };\r\n  handleEdge = () => {\r\n    let page: any = { offsetLeft: 0 };\r\n    if (this.props.currentBook.format !== \"PDF\") {\r\n      page = document.getElementById(\"page-area\");\r\n      if (!page.clientWidth) return;\r\n    }\r\n    let popupMenu: any = document.querySelector(\".popup-menu-container\");\r\n    let posX = popupMenu?.style.left;\r\n    let posY = popupMenu?.style.top;\r\n    posX = parseInt(posX.substr(0, posX.length - 2));\r\n    posY = parseInt(posY.substr(0, posY.length - 2));\r\n    let rightEdge = this.props.pageWidth - 310 + page.offsetLeft * 2;\r\n\r\n    if (posX > rightEdge) {\r\n      popupMenu?.setAttribute(\"style\", `left:${rightEdge}px;top:${posY}px`);\r\n    }\r\n  };\r\n  handleCopy = () => {\r\n    let text = getSelection();\r\n    if (!text) return;\r\n    copy(text);\r\n    this.props.handleOpenMenu(false);\r\n    let doc = getIframeDoc();\r\n    if (!doc) return;\r\n    doc.getSelection()?.empty();\r\n    toast.success(this.props.t(\"Copy Successfully\"));\r\n  };\r\n  handleTrans = () => {\r\n    this.props.handleMenuMode(\"trans\");\r\n    this.props.handleOriginalText(getSelection() || \"\");\r\n    this.handleEdge();\r\n  };\r\n  handleDigest = () => {\r\n    let bookKey = this.props.currentBook.key;\r\n    let cfi = \"\";\r\n    if (this.props.currentBook.format === \"PDF\") {\r\n      cfi = JSON.stringify(\r\n        RecordLocation.getPDFLocation(this.props.currentBook.md5)\r\n      );\r\n    } else {\r\n      cfi = JSON.stringify(\r\n        RecordLocation.getHtmlLocation(this.props.currentBook.key)\r\n      );\r\n    }\r\n    let percentage = RecordLocation.getHtmlLocation(this.props.currentBook.key)\r\n      .percentage\r\n      ? RecordLocation.getHtmlLocation(this.props.currentBook.key).percentage\r\n      : 0;\r\n    let color = this.props.color;\r\n    let notes = \"\";\r\n    let pageArea = document.getElementById(\"page-area\");\r\n    if (!pageArea) return;\r\n    let iframe = pageArea.getElementsByTagName(\"iframe\")[0];\r\n    if (!iframe) return;\r\n    let doc = iframe.contentDocument;\r\n    if (!doc) return;\r\n    let charRange;\r\n    if (this.props.currentBook.format !== \"PDF\") {\r\n      charRange = window.rangy\r\n        .getSelection(iframe)\r\n        .saveCharacterRanges(doc.body)[0];\r\n    }\r\n    let range =\r\n      this.props.currentBook.format === \"PDF\"\r\n        ? JSON.stringify(getHightlightCoords())\r\n        : JSON.stringify(charRange);\r\n    let text = doc.getSelection()?.toString();\r\n    if (!text) return;\r\n    text = text.replace(/\\s\\s/g, \"\");\r\n    text = text.replace(/\\r/g, \"\");\r\n    text = text.replace(/\\n/g, \"\");\r\n    text = text.replace(/\\t/g, \"\");\r\n    text = text.replace(/\\f/g, \"\");\r\n    let digest = new Note(\r\n      bookKey,\r\n      this.props.chapter,\r\n      this.props.chapterIndex,\r\n      text,\r\n      cfi,\r\n      range,\r\n      notes,\r\n      percentage,\r\n      color,\r\n      []\r\n    );\r\n    let noteArr = this.props.notes;\r\n    noteArr.push(digest);\r\n    localforage.setItem(\"notes\", noteArr).then(() => {\r\n      this.props.handleOpenMenu(false);\r\n      toast.success(this.props.t(\"Add Successfully\"));\r\n      this.props.handleFetchNotes();\r\n      this.props.handleMenuMode(\"highlight\");\r\n    });\r\n  };\r\n  handleJump = (url: string) => {\r\n    openExternalUrl(url);\r\n  };\r\n  handleSearchInternet = () => {\r\n    switch (StorageUtil.getReaderConfig(\"searchEngine\")) {\r\n      case \"google\":\r\n        this.handleJump(\"https://www.google.com/search?q=\" + getSelection());\r\n        break;\r\n      case \"baidu\":\r\n        this.handleJump(\"https://www.baidu.com/s?wd=\" + getSelection());\r\n        break;\r\n      case \"bing\":\r\n        this.handleJump(\"https://www.bing.com/search?q=\" + getSelection());\r\n        break;\r\n      case \"duckduckgo\":\r\n        this.handleJump(\"https://duckduckgo.com/?q=\" + getSelection());\r\n        break;\r\n      case \"yandex\":\r\n        this.handleJump(\"https://yandex.com/search/?text=\" + getSelection());\r\n        break;\r\n      case \"yahoo\":\r\n        this.handleJump(\"https://search.yahoo.com/search?p=\" + getSelection());\r\n        break;\r\n      case \"naver\":\r\n        this.handleJump(\r\n          \"https://search.naver.com/search.naver?where=nexearch&sm=top_hty&fbm=1&ie=utf8&query=\" +\r\n            getSelection()\r\n        );\r\n        break;\r\n      case \"baike\":\r\n        this.handleJump(\"https://baike.baidu.com/item/\" + getSelection());\r\n        break;\r\n      case \"wiki\":\r\n        this.handleJump(\"https://en.wikipedia.org/wiki/\" + getSelection());\r\n        break;\r\n      default:\r\n        this.handleJump(\r\n          navigator.language === \"zh-CN\"\r\n            ? \"https://www.baidu.com/s?wd=\" + getSelection()\r\n            : \"https://www.google.com/search?q=\" + getSelection()\r\n        );\r\n        break;\r\n    }\r\n  };\r\n  handleSearchBook = () => {\r\n    let leftPanel = document.querySelector(\".left-panel\");\r\n    const clickEvent = new MouseEvent(\"click\", {\r\n      view: window,\r\n      bubbles: true,\r\n      cancelable: true,\r\n    });\r\n    if (!leftPanel) return;\r\n    leftPanel.dispatchEvent(clickEvent);\r\n    const focusEvent = new MouseEvent(\"focus\", {\r\n      view: window,\r\n      bubbles: true,\r\n      cancelable: true,\r\n    });\r\n    let searchBox: any = document.querySelector(\".header-search-box\");\r\n    searchBox.dispatchEvent(focusEvent);\r\n    let searchIcon = document.querySelector(\".header-search-icon\");\r\n    searchIcon?.dispatchEvent(clickEvent);\r\n    searchBox.value = getSelection() || \"\";\r\n    const keyEvent: any = new KeyboardEvent(\"keydown\", {\r\n      bubbles: true,\r\n      cancelable: true,\r\n      keyCode: 13,\r\n    } as any);\r\n    searchBox.dispatchEvent(keyEvent);\r\n    this.props.handleOpenMenu(false);\r\n  };\r\n\r\n  handleSpeak = () => {\r\n    var msg = new SpeechSynthesisUtterance();\r\n    msg.text = getSelection() || \"\";\r\n    msg.voice = window.speechSynthesis.getVoices()[0];\r\n    window.speechSynthesis.speak(msg);\r\n  };\r\n  render() {\r\n    const renderMenuList = () => {\r\n      return (\r\n        <>\r\n          <div className=\"menu-list\">\r\n            {popupList.map((item, index) => {\r\n              return (\r\n                <div\r\n                  key={item.name}\r\n                  className={item.name + \"-option\"}\r\n                  onClick={() => {\r\n                    switch (index) {\r\n                      case 0:\r\n                        this.handleNote();\r\n                        break;\r\n                      case 1:\r\n                        this.handleDigest();\r\n                        break;\r\n                      case 2:\r\n                        this.handleTrans();\r\n                        break;\r\n                      case 3:\r\n                        this.handleCopy();\r\n                        break;\r\n                      case 4:\r\n                        this.handleSearchBook();\r\n                        break;\r\n                      case 5:\r\n                        this.handleSearchInternet();\r\n                        break;\r\n                      case 6:\r\n                        this.handleSpeak();\r\n                        break;\r\n\r\n                      default:\r\n                        break;\r\n                    }\r\n                  }}\r\n                >\r\n                  <Tooltip\r\n                    title={this.props.t(item.title)}\r\n                    position=\"top\"\r\n                    trigger=\"mouseenter\"\r\n                  >\r\n                    <span\r\n                      className={`icon-${item.icon} ${item.name}-icon`}\r\n                    ></span>\r\n                  </Tooltip>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n          <ColorOption />\r\n        </>\r\n      );\r\n    };\r\n    return renderMenuList();\r\n  }\r\n}\r\n\r\nexport default PopupOption;\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleOpenMenu,\r\n  handleMenuMode,\r\n  handleChangeDirection,\r\n} from \"../../../store/actions\";\r\nimport { handleFetchNotes, handleOriginalText } from \"../../../store/actions\";\r\nimport { stateType } from \"../../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport PopupOption from \"./component\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentBook: state.book.currentBook,\r\n    selection: state.viewArea.selection,\r\n    notes: state.reader.notes,\r\n    color: state.reader.color,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleOpenMenu,\r\n  handleMenuMode,\r\n  handleFetchNotes,\r\n  handleOriginalText,\r\n  handleChangeDirection,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(PopupOption as any));\r\n","export const translationList = [\r\n  {\r\n    name: \"简体中文\",\r\n    value: \"zh\",\r\n    lang: \"zh-CN\",\r\n  },\r\n  {\r\n    name: \"繁体中文\",\r\n    value: \"cht\",\r\n  },\r\n  {\r\n    name: \"English\",\r\n    value: \"en\",\r\n  },\r\n  {\r\n    name: \"한국어\",\r\n    value: \"kor\",\r\n  },\r\n  {\r\n    name: \"日本語\",\r\n    value: \"jp\",\r\n  },\r\n  {\r\n    name: \"español\",\r\n    value: \"spa\",\r\n  },\r\n  {\r\n    name: \"Русский\",\r\n    value: \"ru\",\r\n  },\r\n  {\r\n    name: \"italiano\",\r\n    value: \"it\",\r\n  },\r\n  {\r\n    name: \"português\",\r\n    value: \"pt\",\r\n  },\r\n  {\r\n    name: \"français\",\r\n    value: \"fra\",\r\n  },\r\n  {\r\n    name: \"العربية\",\r\n    value: \"ara\",\r\n  },\r\n  {\r\n    name: \"ไทย\",\r\n    value: \"th\",\r\n  },\r\n  {\r\n    name: \"Deutsch\",\r\n    value: \"de\",\r\n  },\r\n  {\r\n    name: \"Ελληνικά\",\r\n    value: \"el\",\r\n  },\r\n  {\r\n    name: \"Nederlands\",\r\n    value: \"Polskie\",\r\n  },\r\n  {\r\n    name: \"български\",\r\n    value: \"bul\",\r\n  },\r\n  {\r\n    name: \"Eestlane\",\r\n    value: \"est\",\r\n  },\r\n  {\r\n    name: \"dansk\",\r\n    value: \"dan\",\r\n  },\r\n  {\r\n    name: \"Suomalainen\",\r\n    value: \"fin\",\r\n  },\r\n  {\r\n    name: \"čeština\",\r\n    value: \"cs\",\r\n  },\r\n  {\r\n    name: \"Română\",\r\n    value: \"rom\",\r\n  },\r\n  {\r\n    name: \"Slovenščina\",\r\n    value: \"slo\",\r\n  },\r\n  {\r\n    name: \"svenska\",\r\n    value: \"swe\",\r\n  },\r\n  {\r\n    name: \"Magyar\",\r\n    value: \"hu\",\r\n  },\r\n  {\r\n    name: \"Tiếng Việt\",\r\n    value: \"vie\",\r\n  },\r\n];\r\n","import React from \"react\";\r\nimport \"./popupTrans.css\";\r\nimport { PopupTransProps, PopupTransState } from \"./interface\";\r\nimport md5 from \"md5\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { translationList } from \"../../../constants/translationList\";\r\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\r\n\r\nclass PopupTrans extends React.Component<PopupTransProps, PopupTransState> {\r\n  constructor(props: PopupTransProps) {\r\n    super(props);\r\n    this.state = {\r\n      translatedText: \"\",\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    let originalText = this.props.originalText.replace(/(\\r\\n|\\n|\\r)/gm, \"\");\r\n    this.handleTrans(originalText);\r\n  }\r\n  handleTrans = (text: string) => {\r\n    var script = document.createElement(\"script\");\r\n    script.type = \"text/javascript\";\r\n    script.src = `https://fanyi-api.baidu.com/api/trans/vip/translate?q=${text}&from=auto&to=${\r\n      StorageUtil.getReaderConfig(\"transTarget\") || \"auto\"\r\n    }&appid=20200802000531425&salt=1435660288&sign=${md5(\r\n      // eslint-disable-next-line\r\n      \"20200802000531425\" + text + \"1435660288\" + \"sJRHTorJq8j8_ru2GkHl\"\r\n    )}&callback=handleCallback`;\r\n    document.head.appendChild(script);\r\n    (window as any).handleCallback = (res: any) => {\r\n      if (res.error_code && res.error_code === 54003) {\r\n        this.setState({\r\n          translatedText: this.props.t(\"Reach frequency limit\"),\r\n        });\r\n      } else {\r\n        this.setState({\r\n          translatedText: res.trans_result\r\n            ? res.trans_result[0].dst\r\n            : this.props.t(\"Error happens\"),\r\n        });\r\n      }\r\n    };\r\n  };\r\n  render() {\r\n    const renderNoteEditor = () => {\r\n      return (\r\n        <div className=\"trans-container\">\r\n          <div className=\"trans-text-box\">{this.state.translatedText}</div>\r\n          <div className=\"target-lang-container\">\r\n            <p className=\"general-setting-title\" style={{ display: \"inline\" }}>\r\n              <Trans>Target</Trans>\r\n            </p>\r\n            <select\r\n              className=\"booklist-shelf-list\"\r\n              style={{ width: \"100px\" }}\r\n              onChange={(event: React.ChangeEvent<HTMLSelectElement>) => {\r\n                let targetLang = event.target.value;\r\n                StorageUtil.setReaderConfig(\"transTarget\", targetLang);\r\n                this.handleTrans(\r\n                  this.props.originalText.replace(/(\\r\\n|\\n|\\r)/gm, \"\")\r\n                );\r\n              }}\r\n            >\r\n              {translationList.map((item, index) => {\r\n                return (\r\n                  <option\r\n                    value={item.value}\r\n                    key={index}\r\n                    className=\"add-dialog-shelf-list-option\"\r\n                    selected={\r\n                      StorageUtil.getReaderConfig(\"transTarget\") === item.value\r\n                        ? true\r\n                        : false\r\n                    }\r\n                  >\r\n                    {item.name}\r\n                  </option>\r\n                );\r\n              })}\r\n            </select>\r\n          </div>\r\n        </div>\r\n      );\r\n    };\r\n    return renderNoteEditor();\r\n  }\r\n}\r\nexport default PopupTrans;\r\n","import { connect } from \"react-redux\";\r\nimport { handleOpenMenu, handleMenuMode } from \"../../../store/actions\";\r\nimport { stateType } from \"../../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport PopupTrans from \"./component\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    originalText: state.reader.originalText,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleOpenMenu,\r\n  handleMenuMode,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(PopupTrans as any));\r\n","import React from \"react\";\r\nimport \"./popupMenu.css\";\r\nimport PopupNote from \"../popupNote\";\r\nimport PopupOption from \"../popupOption\";\r\nimport PopupTrans from \"../popupTrans\";\r\nimport { PopupMenuProps, PopupMenuStates } from \"./interface\";\r\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\r\nimport {\r\n  getIframeDoc,\r\n  getPDFIframeDoc,\r\n} from \"../../../utils/serviceUtils/docUtil\";\r\nlet colors = [\"#fac106\", \"#ebe702\", \"#0be603\", \"#0493e6\"];\r\nlet lines = [\"#FF0000\", \"#000080\", \"#0000FF\", \"#2EFF2E\"];\r\n\r\ndeclare var window: any;\r\n\r\nclass PopupMenu extends React.Component<PopupMenuProps, PopupMenuStates> {\r\n  highlighter: any;\r\n  timer!: NodeJS.Timeout;\r\n  key: any;\r\n  mode: string;\r\n  showNote: boolean;\r\n  isFirstShow: boolean;\r\n  rect: any;\r\n  constructor(props: PopupMenuProps) {\r\n    super(props);\r\n    this.showNote = false;\r\n    this.isFirstShow = false;\r\n    this.highlighter = null;\r\n    this.mode = \"\";\r\n    this.state = {\r\n      deleteKey: \"\",\r\n      rect: this.props.rect,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.rendition.on(\"rendered\", () => {\r\n      new Promise<void>((resolve, reject) => {\r\n        this.getHighlighter();\r\n        resolve();\r\n      }).then(() => {\r\n        this.renderHighlighters();\r\n      });\r\n      let doc = getIframeDoc();\r\n      if (!doc) return;\r\n      doc.addEventListener(\"mousedown\", this.openMenu);\r\n      if (this.props.currentBook.format === \"PDF\") {\r\n        setTimeout(() => {\r\n          this.renderHighlighters();\r\n        }, 1000);\r\n\r\n        doc.addEventListener(\"mousewheel\", () => {\r\n          this.renderHighlighters();\r\n        });\r\n      }\r\n    });\r\n  }\r\n  UNSAFE_componentWillReceiveProps(nextProps: PopupMenuProps) {\r\n    if (nextProps.rect !== this.props.rect) {\r\n      this.setState(\r\n        {\r\n          rect: nextProps.rect,\r\n        },\r\n        () => {\r\n          this.openMenu();\r\n        }\r\n      );\r\n    }\r\n  }\r\n  //新建高亮\r\n  getHighlighter = () => {\r\n    // 注意点一\r\n    // 为了每次切换章节时都有与当前文档相关联的 pen\r\n    let doc = getIframeDoc();\r\n    if (!doc) return;\r\n    this.highlighter = window.rangy.createHighlighter(doc);\r\n    let classes = [\r\n      \"color-0\",\r\n      \"color-1\",\r\n      \"color-2\",\r\n      \"color-3\",\r\n      \"line-0\",\r\n      \"line-1\",\r\n      \"line-2\",\r\n      \"line-3\",\r\n    ];\r\n    classes.forEach((item) => {\r\n      let config = {\r\n        ignoreWhiteSpace: true,\r\n        elementTagName: \"span\",\r\n        elementProperties: {\r\n          onclick: this.handleNoteClick,\r\n        },\r\n        onElementCreate: (element: any) => {\r\n          element.dataset.key =\r\n            this.key || this.props.notes[this.props.notes.length - 1].key;\r\n        },\r\n      };\r\n      let applier = window.rangy.createClassApplier(item, config);\r\n      this.highlighter.addClassApplier(applier);\r\n    });\r\n  };\r\n  handleNoteClick = (event: any) => {\r\n    let doc = getIframeDoc();\r\n    if (!doc) return;\r\n    this.props.handleMenuMode(\"note\");\r\n    let sel = doc.getSelection();\r\n    if (!sel) return;\r\n    let range = sel.getRangeAt(0);\r\n    sel.removeAllRanges();\r\n    sel.addRange(range);\r\n    this.setState({ rect: range.getBoundingClientRect() }, () => {\r\n      this.showMenu();\r\n      this.handleClickHighlighter(event.currentTarget.dataset.key);\r\n      event.stopPropagation();\r\n    });\r\n  };\r\n  handlePDFClick = (event: any) => {\r\n    this.props.handleMenuMode(\"note\");\r\n    this.setState({ rect: event.currentTarget.getBoundingClientRect() }, () => {\r\n      this.showMenu();\r\n      this.handleClickHighlighter(event.currentTarget.getAttribute(\"key\"));\r\n      event.stopPropagation();\r\n    });\r\n  };\r\n\r\n  showPDFHighlight = (selected: any, colorCode: string, noteKey: string) => {\r\n    let iWin = getPDFIframeDoc();\r\n    if (!iWin) return;\r\n    var pageIndex = selected.page;\r\n    if (!iWin.PDFViewerApplication.pdfViewer) return;\r\n    var page = iWin.PDFViewerApplication.pdfViewer.getPageView(pageIndex);\r\n    if (page && page.div && page.textLayer && page.textLayer.textLayerDiv) {\r\n      var pageElement =\r\n        colorCode.indexOf(\"color\") > -1\r\n          ? page.textLayer.textLayerDiv\r\n          : page.div;\r\n\r\n      var viewport = page.viewport;\r\n      selected.coords.forEach((rect) => {\r\n        var bounds = viewport.convertToViewportRectangle(rect);\r\n        var el = iWin.document.createElement(\"div\");\r\n\r\n        el?.setAttribute(\r\n          \"style\",\r\n          \"position: absolute;\" +\r\n            (colorCode.indexOf(\"color\") > -1\r\n              ? \"background-color: \"\r\n              : \"border-bottom: \") +\r\n            (colorCode.indexOf(\"color\") > -1\r\n              ? colors[colorCode.split(\"-\")[1]]\r\n              : `2px solid ${lines[colorCode.split(\"-\")[1]]}`) +\r\n            \"; left:\" +\r\n            Math.min(bounds[0], bounds[2]) +\r\n            \"px; top:\" +\r\n            Math.min(bounds[1], bounds[3]) +\r\n            \"px;\" +\r\n            \"width:\" +\r\n            Math.abs(bounds[0] - bounds[2]) +\r\n            \"px; height:\" +\r\n            Math.abs(bounds[1] - bounds[3]) +\r\n            \"px; z-index:0;\"\r\n        );\r\n        el?.setAttribute(\"key\", noteKey);\r\n        el?.setAttribute(\"class\", \"pdf-note\");\r\n        el?.addEventListener(\"click\", (event: any) => {\r\n          this.handlePDFClick(event);\r\n        });\r\n\r\n        pageElement.appendChild(el);\r\n      });\r\n    }\r\n  };\r\n\r\n  handleClickHighlighter = (key: string) => {\r\n    let dialog: HTMLInputElement | null = document.querySelector(\".editor-box\");\r\n    if (!dialog) return;\r\n    let note = this.props.notes.filter((item) => item.key === key)[0];\r\n    if (note && note.notes) {\r\n      dialog.value = note.notes;\r\n    }\r\n    dialog?.focus();\r\n    this.props.handleNoteKey(key);\r\n  };\r\n  handleShowDelete = (deleteKey: string) => {\r\n    this.setState({ deleteKey });\r\n  };\r\n  showMenu = () => {\r\n    let rect = this.state.rect;\r\n    if (!rect) return;\r\n    this.props.handleChangeDirection(false);\r\n    let page: any = { offsetLeft: 0 };\r\n    if (this.props.currentBook.format !== \"PDF\") {\r\n      page = document.getElementById(\"page-area\");\r\n      if (!page.clientWidth) return;\r\n    }\r\n\r\n    let height = 200;\r\n    let x =\r\n      this.props.currentBook.format === \"PDF\"\r\n        ? rect.left\r\n        : StorageUtil.getReaderConfig(\"readerMode\") === \"single\"\r\n        ? (rect.x % this.props.pageWidth) + page.offsetLeft\r\n        : StorageUtil.getReaderConfig(\"readerMode\") === \"scroll\"\r\n        ? rect.left + page.offsetLeft\r\n        : rect.x % this.props.pageWidth;\r\n    let y = rect.y % this.props.pageHeight;\r\n    let posX = x + rect.width / 2 - 20;\r\n    //防止menu超出图书\r\n    let rightEdge =\r\n      this.props.menuMode === \"note\" || this.props.menuMode === \"trans\"\r\n        ? this.props.pageWidth - 310 + page.offsetLeft * 2\r\n        : this.props.pageWidth - 200 + page.offsetLeft * 2;\r\n    let posY: number;\r\n    //控制menu方向\r\n    if (y < height) {\r\n      this.props.handleChangeDirection(true);\r\n      posY = y + 67;\r\n    } else {\r\n      posY = y - height / 2 - 57;\r\n    }\r\n    posX = posX > rightEdge ? rightEdge : posX;\r\n    this.props.handleOpenMenu(true);\r\n    let popupMenu = document.querySelector(\".popup-menu-container\");\r\n    popupMenu?.setAttribute(\"style\", `left:${posX}px;top:${posY}px`);\r\n    this.setState({ rect: null });\r\n  };\r\n  //渲染高亮\r\n  renderHighlighters = () => {\r\n    let highlighters: any = this.props.notes;\r\n    if (!highlighters) return;\r\n    let highlightersByChapter = highlighters.filter((item: any) => {\r\n      return (\r\n        item.chapterIndex === this.props.chapterIndex &&\r\n        item.chapter === this.props.chapter &&\r\n        item.bookKey === this.props.currentBook.key\r\n      );\r\n    });\r\n    let pageArea = document.getElementById(\"page-area\");\r\n    if (!pageArea) return;\r\n    let iframe = pageArea.getElementsByTagName(\"iframe\")[0];\r\n    if (!iframe || !iframe.contentWindow) return;\r\n    let iWin = iframe.contentWindow || iframe.contentDocument?.defaultView;\r\n    this.highlighter && this.highlighter.removeAllHighlights(); // 为了避免下次反序列化失败，必须先清除已有的高亮\r\n\r\n    let classes = [\r\n      \"color-0\",\r\n      \"color-1\",\r\n      \"color-2\",\r\n      \"color-3\",\r\n      \"line-0\",\r\n      \"line-1\",\r\n      \"line-2\",\r\n      \"line-3\",\r\n    ];\r\n    highlightersByChapter &&\r\n      highlightersByChapter.forEach((item: any) => {\r\n        this.key = item.key;\r\n        //控制渲染指定图书的指定高亮\r\n        if (item.bookKey === this.props.currentBook.key) {\r\n          try {\r\n            if (this.props.currentBook.format === \"PDF\") {\r\n              this.showPDFHighlight(\r\n                JSON.parse(item.range),\r\n                classes[item.color],\r\n                item.key\r\n              );\r\n            } else {\r\n              let temp = JSON.parse(item.range);\r\n              temp = [temp];\r\n              let doc = iframe.contentDocument;\r\n              window.rangy\r\n                .getSelection(iframe)\r\n                .restoreCharacterRanges(doc, temp);\r\n              this.highlighter.highlightSelection(classes[item.color]);\r\n            }\r\n          } catch (e) {\r\n            console.warn(\r\n              e,\r\n              \"Exception has been caught when restore character ranges.\"\r\n            );\r\n            return;\r\n          }\r\n        }\r\n      });\r\n    if (!iWin || !iWin.getSelection()) return;\r\n    iWin.getSelection()?.empty(); // 清除文本选取\r\n    // this.props.isOpenMenu &&\r\n    //   window.rangy.deserializeSelection(serial, null, iWin); // （为了选取文本后不被上一行代码清除掉）恢复原本的文本选取\r\n  };\r\n  //控制弹窗\r\n  openMenu = () => {\r\n    this.setState({ deleteKey: \"\" });\r\n    let pageArea = document.getElementById(\"page-area\");\r\n    if (!pageArea) return;\r\n    let iframe = pageArea.getElementsByTagName(\"iframe\")[0];\r\n    if (!iframe) return;\r\n    let doc = iframe.contentDocument;\r\n    if (!doc) return;\r\n    let sel = doc.getSelection();\r\n    this.props.handleChangeDirection(false);\r\n    // 如果 popmenu正在被展示，则隐藏\r\n    if (this.props.isOpenMenu) {\r\n      this.props.handleMenuMode(\"menu\");\r\n      this.props.handleOpenMenu(false);\r\n      this.props.handleNoteKey(\"\");\r\n    }\r\n    if (!sel) return;\r\n    // 使弹出菜单更加灵活可控;\r\n    if (sel.isCollapsed) {\r\n      this.props.isOpenMenu && this.props.handleOpenMenu(false);\r\n      this.props.handleMenuMode(\"menu\");\r\n      this.props.handleNoteKey(\"\");\r\n      return;\r\n    }\r\n    this.showMenu();\r\n    this.props.handleMenuMode(\"menu\");\r\n  };\r\n  //添加高亮\r\n  handleHighlight() {\r\n    let pageArea = document.getElementById(\"page-area\");\r\n    if (!pageArea) return;\r\n    let iframe = pageArea.getElementsByTagName(\"iframe\")[0];\r\n    if (!iframe) return;\r\n    let doc = iframe.contentDocument;\r\n    if (!doc) return;\r\n    let color = this.props.color;\r\n    let classes = [\r\n      \"color-0\",\r\n      \"color-1\",\r\n      \"color-2\",\r\n      \"color-3\",\r\n      \"line-0\",\r\n      \"line-1\",\r\n      \"line-2\",\r\n      \"line-3\",\r\n    ];\r\n    if (!this.highlighter) return;\r\n    this.highlighter.highlightSelection(classes[color]);\r\n    this.props.handleMenuMode(\"menu\");\r\n    this.props.handleOpenMenu(false);\r\n\r\n    doc.getSelection()?.empty();\r\n    this.props.handleMenuMode(\"menu\");\r\n    this.highlighter && this.highlighter.removeAllHighlights();\r\n    new Promise<void>((resolve) => {\r\n      this.getHighlighter();\r\n      resolve();\r\n    }).then(() => {\r\n      this.renderHighlighters();\r\n    });\r\n  }\r\n  render() {\r\n    if (this.props.menuMode === \"highlight\") {\r\n      // this.getHighlighter();\r\n      this.handleHighlight();\r\n    }\r\n    const PopupProps = {\r\n      pageWidth: this.props.pageWidth,\r\n      pageHeight: this.props.pageHeight,\r\n      chapterIndex: this.props.chapterIndex,\r\n      chapter: this.props.chapter,\r\n    };\r\n    return (\r\n      <div>\r\n        <div\r\n          className=\"popup-menu-container\"\r\n          style={this.props.isOpenMenu ? {} : { display: \"none\" }}\r\n        >\r\n          <div className=\"popup-menu-box\">\r\n            {this.props.menuMode === \"menu\" ? (\r\n              <PopupOption {...PopupProps} />\r\n            ) : this.props.menuMode === \"note\" ? (\r\n              <PopupNote {...PopupProps} />\r\n            ) : this.props.menuMode === \"trans\" ? (\r\n              <PopupTrans {...PopupProps} />\r\n            ) : null}\r\n            <span\r\n              className=\"icon-close popup-close\"\r\n              onClick={() => {\r\n                this.props.handleOpenMenu(false);\r\n              }}\r\n              style={this.props.isChangeDirection ? { top: \"170px\" } : {}}\r\n            ></span>\r\n          </div>\r\n          {this.props.isChangeDirection ? (\r\n            <span\r\n              className=\"icon-popup popup-menu-triangle-up\"\r\n              style={\r\n                this.props.menuMode === \"highlight\" ? { bottom: \"110px\" } : {}\r\n              }\r\n            ></span>\r\n          ) : (\r\n            <span className=\"icon-popup popup-menu-triangle-down\"></span>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default PopupMenu;\r\n","import {\r\n  handleSelection,\r\n  handleOpenMenu,\r\n  handleMenuMode,\r\n  handleChangeDirection,\r\n  handleNoteKey,\r\n} from \"../../../store/actions\";\r\nimport { connect } from \"react-redux\";\r\nimport { stateType } from \"../../../store\";\r\nimport PopupMenu from \"./component\";\r\nimport { withTranslation } from \"react-i18next\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    digests: state.reader.digests,\r\n    notes: state.reader.notes,\r\n    noteKey: state.reader.noteKey,\r\n    currentBook: state.book.currentBook,\r\n    isOpenMenu: state.viewArea.isOpenMenu,\r\n    menuMode: state.viewArea.menuMode,\r\n    color: state.reader.color,\r\n    isChangeDirection: state.viewArea.isChangeDirection,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleSelection,\r\n  handleOpenMenu,\r\n  handleMenuMode,\r\n  handleChangeDirection,\r\n  handleNoteKey,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(PopupMenu));\r\n","import React from \"react\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { DeletePopupProps } from \"./interface\";\r\nimport toast from \"react-hot-toast\";\r\nclass DeletePopup extends React.Component<DeletePopupProps> {\r\n  handleCancel = () => {\r\n    this.props.handleDeletePopup(false);\r\n  };\r\n  handleComfirm = () => {\r\n    //从列表删除和从图书库删除判断\r\n    this.props.handleDeletePopup(false);\r\n    this.props.handleDeleteOpearion();\r\n    toast.success(this.props.t(\"Delete Successfully\"));\r\n  };\r\n  render() {\r\n    return (\r\n      <div className=\"delete-dialog-container\">\r\n        <div className=\"delete-dialog-title\">\r\n          <Trans>{this.props.title}</Trans>\r\n        </div>\r\n\r\n        <div className=\"delete-dialog-book\">\r\n          <div className=\"delete-dialog-book-title\">{this.props.name}</div>\r\n        </div>\r\n\r\n        <div className=\"delete-dialog-other-option\">\r\n          <Trans>{this.props.description}</Trans>\r\n        </div>\r\n\r\n        <div\r\n          className=\"delete-dialog-cancel\"\r\n          onClick={() => {\r\n            this.handleCancel();\r\n          }}\r\n        >\r\n          <Trans>Cancel</Trans>\r\n        </div>\r\n        <div\r\n          className=\"delete-dialog-comfirm\"\r\n          onClick={() => {\r\n            this.handleComfirm();\r\n          }}\r\n        >\r\n          <Trans>Delete</Trans>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DeletePopup;\r\n","import { connect } from \"react-redux\";\r\nimport { handleFetchBooks } from \"../../../store/actions\";\r\nimport { stateType } from \"../../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport DeletePopup from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {};\r\n};\r\nconst actionCreator = {\r\n  handleFetchBooks,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(DeletePopup as any));\r\n","import _ from \"underscore\";\r\n\r\nclass RecordLocation {\r\n  static recordCfi(bookKey: string, cfi: string, percentage: number) {\r\n    let json = localStorage.getItem(\"recordLocation\");\r\n    let obj = JSON.parse(json || \"{}\");\r\n    obj[bookKey] = { cfi: cfi, percentage: percentage };\r\n    localStorage.setItem(\"recordLocation\", JSON.stringify(obj));\r\n  }\r\n\r\n  static getCfi(bookKey: string) {\r\n    let json = localStorage.getItem(\"recordLocation\");\r\n    let obj = JSON.parse(json || \"{}\");\r\n    return obj[bookKey] || {};\r\n  }\r\n  static recordHtmlLocation(\r\n    bookKey: string,\r\n    text: string,\r\n    chapterTitle: string,\r\n    count: string,\r\n    percentage: string,\r\n    cfi: string = \"\"\r\n  ) {\r\n    if (cfi) {\r\n      let json = localStorage.getItem(\"recordLocation\");\r\n      let obj = JSON.parse(json || \"{}\");\r\n      obj[bookKey] = { text, chapterTitle, count, percentage, cfi };\r\n      localStorage.setItem(\"recordLocation\", JSON.stringify(obj));\r\n    } else {\r\n      if (\r\n        (!text || !chapterTitle || !count || !percentage) &&\r\n        document.location.href.indexOf(\"/cb\") === -1 //漫画的情况，cbr,cbt,cbz\r\n      )\r\n        return;\r\n      let json = localStorage.getItem(\"recordLocation\");\r\n      let obj = JSON.parse(json || \"{}\");\r\n      obj[bookKey] = { text, chapterTitle, count, percentage, cfi };\r\n      localStorage.setItem(\"recordLocation\", JSON.stringify(obj));\r\n    }\r\n  }\r\n\r\n  static getHtmlLocation(bookKey: string) {\r\n    let json = localStorage.getItem(\"recordLocation\");\r\n    let obj = JSON.parse(json || \"{}\");\r\n    return obj[bookKey] || {};\r\n  }\r\n  static getPDFLocation(fingerprint: string) {\r\n    let json = localStorage.getItem(\"pdfjs.history\");\r\n    let arr = JSON.parse(json || \"{}\").files || [];\r\n    return arr[_.findLastIndex(arr, { fingerprint })] || {};\r\n  }\r\n  static recordPDFLocation(fingerprint: string, obj: object) {\r\n    let json = localStorage.getItem(\"pdfjs.history\");\r\n    let _obj = JSON.parse(json || \"{}\");\r\n    _obj.files[_.findLastIndex(_obj.files, { fingerprint })] = obj;\r\n    localStorage.setItem(\"pdfjs.history\", JSON.stringify(_obj));\r\n  }\r\n  static getAllCfi() {\r\n    let json = localStorage.getItem(\"recordLocation\");\r\n    let obj = JSON.parse(json || \"{}\");\r\n    return obj;\r\n  }\r\n  static clear(bookKey: string) {\r\n    let json = localStorage.getItem(\"recordLocation\");\r\n    let obj = JSON.parse(json || \"{}\");\r\n    delete obj[bookKey];\r\n    localStorage.setItem(\"recordLocation\", JSON.stringify(obj));\r\n  }\r\n}\r\n\r\nexport default RecordLocation;\r\n","import StorageUtil from \"../serviceUtils/storageUtil\";\r\nimport { isElectron } from \"react-device-detect\";\r\nimport localforage from \"localforage\";\r\nimport BookModel from \"../../model/Book\";\r\nimport toast from \"react-hot-toast\";\r\nimport { getPDFCover } from \"./pdfUtil\";\r\nimport chardet from \"chardet\";\r\nimport iconv from \"iconv-lite\";\r\nimport { xmlMetadata } from \"./xmlUtil\";\r\n// import { base64ArrayBuffer } from \"./coverUtil\";\r\ndeclare var window: any;\r\nconst { MobiRender, Azw3Render, EpubRender } = window.Kookit;\r\n\r\n// let Unrar = window.Unrar;\r\nclass BookUtil {\r\n  static addBook(key: string, buffer: ArrayBuffer) {\r\n    if (isElectron) {\r\n      const fs = window.require(\"fs\");\r\n      const path = window.require(\"path\");\r\n      const dataPath = localStorage.getItem(\"storageLocation\")\r\n        ? localStorage.getItem(\"storageLocation\")\r\n        : window\r\n            .require(\"electron\")\r\n            .ipcRenderer.sendSync(\"storage-location\", \"ping\");\r\n      return new Promise<void>((resolve, reject) => {\r\n        var reader = new FileReader();\r\n        reader.readAsArrayBuffer(new Blob([buffer]));\r\n        reader.onload = async (event) => {\r\n          if (!event.target) return;\r\n          try {\r\n            fs.writeFileSync(\r\n              path.join(dataPath, \"book\", key),\r\n              Buffer.from(event.target.result as any)\r\n            );\r\n            resolve();\r\n          } catch (error) {\r\n            reject();\r\n            throw error;\r\n          }\r\n        };\r\n        reader.onerror = () => {\r\n          reject();\r\n        };\r\n      });\r\n    } else {\r\n      return localforage.setItem(key, buffer);\r\n    }\r\n  }\r\n  static deleteBook(key: string) {\r\n    if (isElectron) {\r\n      const fs = window.require(\"fs-extra\");\r\n      const path = window.require(\"path\");\r\n      const dataPath = localStorage.getItem(\"storageLocation\")\r\n        ? localStorage.getItem(\"storageLocation\")\r\n        : window\r\n            .require(\"electron\")\r\n            .ipcRenderer.sendSync(\"storage-location\", \"ping\");\r\n      return new Promise<void>((resolve, reject) => {\r\n        try {\r\n          fs.remove(path.join(dataPath, `book`, key), (err) => {\r\n            if (err) throw err;\r\n            resolve();\r\n          });\r\n        } catch (e) {\r\n          reject();\r\n        }\r\n      });\r\n    } else {\r\n      return localforage.removeItem(key);\r\n    }\r\n  }\r\n  static isBookExist(key: string, bookPath: string = \"\") {\r\n    return new Promise<boolean>((resolve, reject) => {\r\n      if (isElectron) {\r\n        var fs = window.require(\"fs\");\r\n        var path = window.require(\"path\");\r\n        let _bookPath = path.join(\r\n          localStorage.getItem(\"storageLocation\")\r\n            ? localStorage.getItem(\"storageLocation\")\r\n            : window\r\n                .require(\"electron\")\r\n                .ipcRenderer.sendSync(\"storage-location\", \"ping\"),\r\n          `book`,\r\n          key\r\n        );\r\n\r\n        if ((bookPath && fs.existsSync(bookPath)) || fs.existsSync(_bookPath)) {\r\n          resolve(true);\r\n        } else {\r\n          resolve(false);\r\n        }\r\n      } else {\r\n        localforage.getItem(key).then((result) => {\r\n          if (result) {\r\n            resolve(true);\r\n          } else {\r\n            resolve(false);\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n  static fetchBook(\r\n    key: string,\r\n    isArrayBuffer: boolean = false,\r\n    bookPath: string = \"\"\r\n  ) {\r\n    if (isElectron) {\r\n      return new Promise<File | ArrayBuffer | boolean>((resolve, reject) => {\r\n        var fs = window.require(\"fs\");\r\n        var path = window.require(\"path\");\r\n        let _bookPath = path.join(\r\n          localStorage.getItem(\"storageLocation\")\r\n            ? localStorage.getItem(\"storageLocation\")\r\n            : window\r\n                .require(\"electron\")\r\n                .ipcRenderer.sendSync(\"storage-location\", \"ping\"),\r\n          `book`,\r\n          key\r\n        );\r\n        var data;\r\n        if (bookPath && fs.existsSync(bookPath)) {\r\n          data = fs.readFileSync(bookPath);\r\n        } else if (fs.existsSync(_bookPath)) {\r\n          data = fs.readFileSync(_bookPath);\r\n        } else {\r\n          resolve(false);\r\n        }\r\n\r\n        let blobTemp = new Blob([data]);\r\n        let fileTemp = new File([blobTemp], \"data\", {\r\n          lastModified: new Date().getTime(),\r\n          type: blobTemp.type,\r\n        });\r\n        if (isArrayBuffer) {\r\n          resolve(new Uint8Array(data).buffer);\r\n        } else {\r\n          resolve(fileTemp);\r\n        }\r\n      });\r\n    } else {\r\n      return localforage.getItem(key);\r\n    }\r\n  }\r\n  static async RedirectBook(book: BookModel) {\r\n    if (!(await this.isBookExist(book.key, book.path))) {\r\n      toast.error(\"Book not exist\");\r\n      return;\r\n    }\r\n    let ref = book.format.toLowerCase();\r\n\r\n    if (isElectron) {\r\n      const { ipcRenderer } = window.require(\"electron\");\r\n      ipcRenderer.invoke(\"open-book\", {\r\n        url: `${window.location.href.split(\"#\")[0]}#/${ref}/${book.key}`,\r\n        isMergeWord:\r\n          book.format === \"PDF\" || book.format === \"DJVU\"\r\n            ? \"no\"\r\n            : StorageUtil.getReaderConfig(\"isMergeWord\"),\r\n        isFullscreen: StorageUtil.getReaderConfig(\"isAutoFullscreen\"),\r\n        isPreventSleep: StorageUtil.getReaderConfig(\"isPreventSleep\"),\r\n      });\r\n    } else {\r\n      window.open(\r\n        `${window.location.href.split(\"#\")[0]}#/${ref}/${book.key}?title=${\r\n          book.name\r\n        }`\r\n      );\r\n    }\r\n  }\r\n  static getBookUrl(book: BookModel) {\r\n    let ref = book.format.toLowerCase();\r\n    return `/${ref}/${book.key}`;\r\n  }\r\n  static getPDFUrl(book: BookModel) {\r\n    if (isElectron) {\r\n      const path = window.require(\"path\");\r\n      const { ipcRenderer } = window.require(\"electron\");\r\n      localStorage.setItem(\"pdfPath\", book.path);\r\n      const __dirname = ipcRenderer.sendSync(\"get-dirname\", \"ping\");\r\n      let pdfLocation =\r\n        document.URL.indexOf(\"localhost\") > -1\r\n          ? \"http://localhost:3000/\"\r\n          : `file://${path.join(\r\n              __dirname,\r\n              \"./build\",\r\n              \"lib\",\r\n              \"pdf\",\r\n              \"web\",\r\n              \"viewer.html\"\r\n            )}`;\r\n      let url = `${\r\n        window.navigator.platform.indexOf(\"Win\") > -1\r\n          ? \"lib/pdf/web/\"\r\n          : \"lib\\\\pdf\\\\web\\\\\"\r\n      }viewer.html?file=${book.key}`;\r\n      return document.URL.indexOf(\"localhost\") > -1\r\n        ? pdfLocation + url\r\n        : `${pdfLocation}?file=${book.key}`;\r\n    } else {\r\n      return `./lib/pdf/web/viewer.html?file=${book.key}`;\r\n    }\r\n  }\r\n  static generateBook(\r\n    bookName: string,\r\n    extension: string,\r\n    md5: string,\r\n    size: number,\r\n    path: string,\r\n    file_content: ArrayBuffer\r\n  ) {\r\n    return new Promise<BookModel | boolean>(async (resolve, reject) => {\r\n      let cover: any = \"\";\r\n      let key: string,\r\n        name: string,\r\n        author: string,\r\n        publisher: string,\r\n        description: string,\r\n        charset: string;\r\n      [name, author, description, publisher, charset] = [\r\n        bookName,\r\n        \"Unknown Authur\",\r\n        \"\",\r\n        \"\",\r\n        \"\",\r\n      ];\r\n      switch (extension) {\r\n        case \"pdf\":\r\n          cover = await getPDFCover(file_content);\r\n          break;\r\n        case \"epub\":\r\n          let epubRendition = new EpubRender(\r\n            file_content,\r\n            \"scroll\",\r\n            StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\r\n          );\r\n          let metadata = await epubRendition.getMetadata();\r\n\r\n          [name, author, description, publisher, cover] = [\r\n            metadata.title,\r\n            metadata.creator,\r\n            metadata.description,\r\n            metadata.publisher,\r\n            metadata.cover,\r\n          ];\r\n          break;\r\n        case \"mobi\":\r\n          let mobiRendition = new MobiRender(\r\n            file_content,\r\n            \"scroll\",\r\n            StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\r\n          );\r\n          if (mobiRendition.getMetadata().compression === 17480) {\r\n            resolve(false);\r\n          }\r\n          break;\r\n        case \"azw3\":\r\n          let azw3Rendition = new Azw3Render(\r\n            file_content,\r\n            \"scroll\",\r\n            StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\r\n          );\r\n          if (azw3Rendition.getMetadata().compression === 17480) {\r\n            resolve(false);\r\n          }\r\n          break;\r\n        case \"fb2\":\r\n          charset = chardet.detect(Buffer.from(file_content)) || \"\";\r\n          let fb2Str = iconv.decode(\r\n            Buffer.from(file_content),\r\n            charset || \"utf8\"\r\n          );\r\n          let fb2Obj: any = await xmlMetadata(fb2Str);\r\n          cover = fb2Obj.cover;\r\n          name = fb2Obj.name;\r\n          author = fb2Obj.author;\r\n          break;\r\n        // case \"cbr\":\r\n        //   let unrar = new Unrar(file_content);\r\n        //   let buffer = unrar.decompress(\r\n        //     unrar.getEntries().map((item: any) => item.name)[0]\r\n        //   );\r\n        //   cover = base64ArrayBuffer(buffer);\r\n        //   break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n\r\n      let format = extension.toUpperCase();\r\n      key = new Date().getTime() + \"\";\r\n      resolve(\r\n        new BookModel(\r\n          key,\r\n          name,\r\n          author,\r\n          description,\r\n          md5,\r\n          cover,\r\n          format,\r\n          publisher,\r\n          size,\r\n          path,\r\n          charset\r\n        )\r\n      );\r\n    });\r\n  }\r\n}\r\n\r\nexport default BookUtil;\r\n","class Book {\r\n  key: string;\r\n  name: string;\r\n  author: string;\r\n  description: string;\r\n  md5: string;\r\n  cover: string;\r\n  format: string;\r\n  publisher: string;\r\n  size: number;\r\n  path: string;\r\n  charset: string;\r\n  constructor(\r\n    key: string,\r\n    name: string,\r\n    author: string,\r\n    description: string,\r\n    md5: string,\r\n    cover: string,\r\n    format: string,\r\n    publisher: string,\r\n    size: number,\r\n    path: string,\r\n    charset: string\r\n  ) {\r\n    this.key = key; // 数据库的键\r\n    this.name = name; // 书籍名\r\n    this.author = author; // 作者\r\n    this.description = description; // 书籍的描述\r\n    this.md5 = md5; //epub的md5值，防止重复导入\r\n    this.cover = cover;\r\n    this.format = format;\r\n    this.publisher = publisher;\r\n    this.size = size;\r\n    this.path = path;\r\n    this.charset = charset;\r\n  }\r\n}\r\n\r\nexport default Book;\r\n","import React from \"react\";\r\nimport RecentBooks from \"../../utils/readUtils/recordRecent\";\r\nimport { ViewerProps, ViewerState } from \"./interface\";\r\nimport localforage from \"localforage\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport BookUtil from \"../../utils/fileUtils/bookUtil\";\r\nimport iconv from \"iconv-lite\";\r\nimport chardet from \"chardet\";\r\nimport rtfToHTML from \"@iarna/rtf-to-html\";\r\nimport PopupMenu from \"../../components/popups/popupMenu\";\r\nimport { xmlBookParser } from \"../../utils/fileUtils/xmlUtil\";\r\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\r\nimport { mimetype } from \"../../constants/mimetype\";\r\nimport Background from \"../../components/background\";\r\nimport toast from \"react-hot-toast\";\r\nimport StyleUtil from \"../../utils/readUtils/styleUtil\";\r\nimport \"./index.css\";\r\nimport { HtmlMouseEvent } from \"../../utils/serviceUtils/mouseEvent\";\r\nimport untar from \"js-untar\";\r\nimport ImageViewer from \"../../components/imageViewer\";\r\nimport _ from \"underscore\";\r\nimport { removeExtraQuestionMark } from \"../../utils/fileUtils/rtfUtil\";\r\nimport { getIframeDoc } from \"../../utils/serviceUtils/docUtil\";\r\nimport { tsTransform } from \"../../utils/serviceUtils/langUtil\";\r\n\r\ndeclare var window: any;\r\n\r\nconst {\r\n  MobiRender,\r\n  Azw3Render,\r\n  EpubRender,\r\n  TxtRender,\r\n  StrRender,\r\n  ComicRender,\r\n} = window.Kookit;\r\nlet Unrar = window.Unrar;\r\nlet JSZip = window.JSZip;\r\n\r\nclass Viewer extends React.Component<ViewerProps, ViewerState> {\r\n  lock: boolean;\r\n  constructor(props: ViewerProps) {\r\n    super(props);\r\n    this.state = {\r\n      cfiRange: null,\r\n      contents: null,\r\n      rect: null,\r\n      key: \"\",\r\n      isFirst: true,\r\n      scale: StorageUtil.getReaderConfig(\"scale\") || 1,\r\n      chapterTitle:\r\n        RecordLocation.getHtmlLocation(this.props.currentBook.key)\r\n          .chapterTitle || \"\",\r\n      readerMode: StorageUtil.getReaderConfig(\"readerMode\") || \"double\",\r\n      margin: parseInt(StorageUtil.getReaderConfig(\"margin\")) || 30,\r\n      chapterIndex: 0,\r\n      chapter: \"\",\r\n      pageWidth: 0,\r\n      pageHeight: 0,\r\n      rendition: null,\r\n    };\r\n    this.lock = false;\r\n  }\r\n  UNSAFE_componentWillMount() {\r\n    this.props.handleFetchBookmarks();\r\n    this.props.handleFetchNotes();\r\n    this.props.handleFetchBooks();\r\n  }\r\n  componentDidMount() {\r\n    this.handleRenderBook();\r\n\r\n    this.props.handleRenderFunc(this.handleRenderBook);\r\n\r\n    var doit;\r\n    window.addEventListener(\"resize\", () => {\r\n      clearTimeout(doit);\r\n      doit = setTimeout(this.handleRenderBook, 100);\r\n    });\r\n  }\r\n  handlePageWidth = () => {\r\n    let reader = document.querySelector(\"#page-area\");\r\n    //解决文字遮挡问题\r\n    if (reader) {\r\n      reader.setAttribute(\r\n        \"style\",\r\n        reader.getAttribute(\"style\") +\r\n          \"width:\" +\r\n          (parseInt(reader.clientWidth + \"\") % 2\r\n            ? parseInt(reader.clientWidth + \"\") - 1\r\n            : parseInt(reader.clientWidth + \"\")) +\r\n          \"px\"\r\n      );\r\n    }\r\n  };\r\n  handleRenderBook = () => {\r\n    let { key, path, format, name } = this.props.currentBook;\r\n    this.props.handleHtmlBook(null);\r\n    let doc = getIframeDoc();\r\n    if (doc && this.state.rendition) {\r\n      this.state.rendition.removeContent();\r\n    }\r\n    this.handlePageWidth();\r\n    window.rangy.init();\r\n    BookUtil.fetchBook(key, true, path).then((result) => {\r\n      if (!result) {\r\n        toast.error(this.props.t(\"Book not exsits\"));\r\n        return;\r\n      }\r\n\r\n      if (format === \"MOBI\") {\r\n        this.handleMobi(result as ArrayBuffer);\r\n      } else if (format === \"AZW3\") {\r\n        this.handleAzw3(result as ArrayBuffer);\r\n      } else if (format === \"EPUB\") {\r\n        this.handleEpub(result as ArrayBuffer);\r\n      } else if (format === \"TXT\") {\r\n        this.handleTxt(result as ArrayBuffer);\r\n      } else if (format === \"MD\") {\r\n        this.handleMD(result as ArrayBuffer);\r\n      } else if (format === \"FB2\") {\r\n        this.handleFb2(result as ArrayBuffer);\r\n      } else if (format === \"RTF\") {\r\n        this.handleRtf(result as ArrayBuffer);\r\n      } else if (format === \"DOCX\") {\r\n        this.handleDocx(result as ArrayBuffer);\r\n      } else if (\r\n        format === \"HTML\" ||\r\n        format === \"XHTML\" ||\r\n        format === \"HTM\" ||\r\n        format === \"XML\"\r\n      ) {\r\n        this.handleHtml(result as ArrayBuffer, format);\r\n      } else if (format === \"CBR\") {\r\n        this.handleCbr(result as ArrayBuffer);\r\n      } else if (format === \"CBT\") {\r\n        this.handleCbt(result as ArrayBuffer);\r\n      } else if (format === \"CBZ\") {\r\n        this.handleCbz(result as ArrayBuffer);\r\n      }\r\n      this.props.handleReadingState(true);\r\n\r\n      RecentBooks.setRecent(this.props.currentBook.key);\r\n      document.title = name + \" - Koodo Reader\";\r\n    });\r\n  };\r\n\r\n  handleRest = async (rendition: any) => {\r\n    HtmlMouseEvent(\r\n      rendition,\r\n      this.props.currentBook.key,\r\n      this.state.readerMode\r\n    );\r\n    let chapters = await rendition.getChapter();\r\n    let flattenChapters = rendition.flatChapter(chapters);\r\n    this.props.handleHtmlBook({\r\n      key: this.props.currentBook.key,\r\n      chapters,\r\n      flattenChapters,\r\n      rendition: rendition,\r\n    });\r\n    this.setState({ rendition });\r\n\r\n    this.setState({\r\n      pageWidth: rendition.getPageSize().width,\r\n      pageHeight: rendition.getPageSize().height,\r\n    });\r\n\r\n    StyleUtil.addDefaultCss();\r\n    rendition.setStyle(\r\n      StyleUtil.getCustomCss(\r\n        this.props.currentBook.format === \"EPUB\" ? false : true\r\n      )\r\n    );\r\n\r\n    let bookLocation: {\r\n      text: string;\r\n      count: string;\r\n      chapterTitle: string;\r\n      percentage: string;\r\n      cfi: string;\r\n    } = RecordLocation.getHtmlLocation(this.props.currentBook.key);\r\n    await rendition.goToPosition(\r\n      JSON.stringify({\r\n        text: bookLocation.text,\r\n        chapterTitle: bookLocation.chapterTitle,\r\n        count: bookLocation.count,\r\n        percentage: bookLocation.percentage,\r\n        cfi: bookLocation.cfi,\r\n      })\r\n    );\r\n\r\n    rendition.on(\"rendered\", () => {\r\n      let bookLocation: { text: string; count: string; chapterTitle: string } =\r\n        RecordLocation.getHtmlLocation(this.props.currentBook.key);\r\n      this.props.handleCurrentChapter(bookLocation.chapterTitle);\r\n      if (this.props.currentBook.format.startsWith(\"CB\")) {\r\n        this.setState({\r\n          chapter:\r\n            this.props.htmlBook.flattenChapters[\r\n              parseInt(bookLocation.count) || 0\r\n            ].label,\r\n          chapterIndex: parseInt(bookLocation.count) || 0,\r\n        });\r\n      } else {\r\n        this.setState({\r\n          chapter:\r\n            bookLocation.chapterTitle ||\r\n            (this.props.htmlBook\r\n              ? this.props.htmlBook.flattenChapters[0].label\r\n              : \"Unknown Chapter\"),\r\n          chapterIndex:\r\n            bookLocation.chapterTitle && this.props.htmlBook\r\n              ? _.findLastIndex(\r\n                  this.props.htmlBook.flattenChapters.map((item) => {\r\n                    item.label = item.label.trim();\r\n                    return item;\r\n                  }),\r\n                  {\r\n                    label: bookLocation.chapterTitle.trim(),\r\n                  }\r\n                )\r\n              : 0,\r\n        });\r\n      }\r\n      tsTransform();\r\n      let doc = getIframeDoc();\r\n      if (!doc) return;\r\n      doc.addEventListener(\"click\", (event) => {\r\n        this.props.handleLeaveReader(\"left\");\r\n        this.props.handleLeaveReader(\"right\");\r\n        this.props.handleLeaveReader(\"top\");\r\n        this.props.handleLeaveReader(\"bottom\");\r\n      });\r\n      doc.addEventListener(\"mouseup\", () => {\r\n        if (!doc!.getSelection()) return;\r\n        var rect = doc!.getSelection()!.getRangeAt(0).getBoundingClientRect();\r\n        this.setState({ rect });\r\n      });\r\n    });\r\n  };\r\n  handleCbr = async (result: ArrayBuffer) => {\r\n    let unrar = new Unrar(result);\r\n    var entries = unrar.getEntries();\r\n    let bookLocation = RecordLocation.getHtmlLocation(\r\n      this.props.currentBook.key\r\n    );\r\n    let rendition = new ComicRender(\r\n      entries.map((item: any) => item.name),\r\n      unrar,\r\n      this.state.readerMode,\r\n      \"cbr\",\r\n      StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\r\n    );\r\n    await rendition.renderTo(\r\n      document.getElementsByClassName(\"html-viewer-page\")[0],\r\n      parseInt(bookLocation.count) || 0\r\n    );\r\n    this.handleRest(rendition);\r\n  };\r\n  handleCbz = (result: ArrayBuffer) => {\r\n    let zip = new JSZip();\r\n    let bookLocation = RecordLocation.getHtmlLocation(\r\n      this.props.currentBook.key\r\n    );\r\n    zip.loadAsync(result).then(async (contents) => {\r\n      let rendition = new ComicRender(\r\n        Object.keys(contents.files).sort(),\r\n        zip,\r\n        this.state.readerMode,\r\n        \"cbz\",\r\n        StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\r\n      );\r\n      await rendition.renderTo(\r\n        document.getElementsByClassName(\"html-viewer-page\")[0],\r\n        parseInt(bookLocation.count) || 0\r\n      );\r\n      this.handleRest(rendition);\r\n    });\r\n  };\r\n  handleCbt = (result: ArrayBuffer) => {\r\n    let bookLocation = RecordLocation.getHtmlLocation(\r\n      this.props.currentBook.key\r\n    );\r\n    untar(result).then(\r\n      async (extractedFiles) => {\r\n        let rendition = new ComicRender(\r\n          extractedFiles.map((item: any) => item.name),\r\n          extractedFiles,\r\n          this.state.readerMode,\r\n          \"cbt\",\r\n          StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\r\n        );\r\n        await rendition.renderTo(\r\n          document.getElementsByClassName(\"html-viewer-page\")[0],\r\n          parseInt(bookLocation.count) || 0\r\n        );\r\n        this.handleRest(rendition);\r\n      },\r\n      function (err) {\r\n        // onError\r\n      },\r\n      function (extractedFile) {\r\n        // onProgress\r\n      }\r\n    );\r\n  };\r\n  handleMobi = async (result: ArrayBuffer) => {\r\n    let rendition = new MobiRender(\r\n      result,\r\n      this.state.readerMode,\r\n      StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\r\n    );\r\n    await rendition.renderTo(\r\n      document.getElementsByClassName(\"html-viewer-page\")[0]\r\n    );\r\n    this.handleRest(rendition);\r\n  };\r\n  handleEpub = async (result: ArrayBuffer) => {\r\n    let rendition = new EpubRender(\r\n      result,\r\n      this.state.readerMode,\r\n      StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\r\n    );\r\n    let bookLocation: {\r\n      text: string;\r\n      count: string;\r\n      chapterTitle: string;\r\n      percentage: string;\r\n      cfi: string;\r\n    } = RecordLocation.getHtmlLocation(this.props.currentBook.key);\r\n    await rendition.renderTo(\r\n      document.getElementsByClassName(\"html-viewer-page\")[0],\r\n      bookLocation.cfi\r\n    );\r\n    this.handleRest(rendition);\r\n  };\r\n  handleAzw3 = async (result: ArrayBuffer) => {\r\n    let rendition = new Azw3Render(\r\n      result,\r\n      this.state.readerMode,\r\n      StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\r\n    );\r\n    await rendition.renderTo(\r\n      document.getElementsByClassName(\"html-viewer-page\")[0]\r\n    );\r\n    this.handleRest(rendition);\r\n  };\r\n  handleCharset = (result: ArrayBuffer) => {\r\n    return new Promise<string>(async (resolve, reject) => {\r\n      let { books } = this.props;\r\n      let charset = \"\";\r\n      books.forEach((item) => {\r\n        if (item.key === this.props.currentBook.key) {\r\n          charset = chardet.detect(Buffer.from(result)) || \"\";\r\n          item.charset = charset;\r\n          this.props.handleReadingBook(item);\r\n        }\r\n      });\r\n\r\n      await localforage.setItem(\"books\", books);\r\n      // this.props.handleFetchBooks();\r\n      resolve(charset);\r\n    });\r\n  };\r\n  handleTxt = async (result: ArrayBuffer) => {\r\n    let charset = \"\";\r\n    if (!this.props.currentBook.charset) {\r\n      charset = await this.handleCharset(result);\r\n    }\r\n    let rendition = new TxtRender(\r\n      result,\r\n      this.state.readerMode,\r\n      this.props.currentBook.charset || charset || \"utf8\",\r\n      StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\r\n    );\r\n    await rendition.renderTo(\r\n      document.getElementsByClassName(\"html-viewer-page\")[0]\r\n    );\r\n    this.handleRest(rendition);\r\n  };\r\n  handleMD = (result: ArrayBuffer) => {\r\n    var blob = new Blob([result], { type: \"text/plain\" });\r\n    var reader = new FileReader();\r\n    reader.onload = async (evt) => {\r\n      let docStr = window.marked(evt.target?.result as any);\r\n      let rendition = new StrRender(\r\n        docStr,\r\n        this.state.readerMode,\r\n        StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\r\n      );\r\n      await rendition.renderTo(\r\n        document.getElementsByClassName(\"html-viewer-page\")[0]\r\n      );\r\n      this.handleRest(rendition);\r\n    };\r\n    reader.readAsText(blob, \"UTF-8\");\r\n  };\r\n  handleRtf = async (result: ArrayBuffer) => {\r\n    let charset = \"\";\r\n    if (!this.props.currentBook.charset) {\r\n      charset = await this.handleCharset(result);\r\n    }\r\n    let text = iconv.decode(\r\n      Buffer.from(result),\r\n      this.props.currentBook.charset || charset || \"utf8\"\r\n    );\r\n\r\n    rtfToHTML.fromString(text, async (err: any, html: any) => {\r\n      let rendition = new StrRender(\r\n        removeExtraQuestionMark(html),\r\n        this.state.readerMode,\r\n        StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\r\n      );\r\n      await rendition.renderTo(\r\n        document.getElementsByClassName(\"html-viewer-page\")[0]\r\n      );\r\n      this.handleRest(rendition);\r\n    });\r\n  };\r\n  handleDocx = (result: ArrayBuffer) => {\r\n    window.mammoth\r\n      .convertToHtml({ arrayBuffer: result })\r\n      .then(async (res: any) => {\r\n        let rendition = new StrRender(\r\n          res.value,\r\n          this.state.readerMode,\r\n          StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\r\n        );\r\n        await rendition.renderTo(\r\n          document.getElementsByClassName(\"html-viewer-page\")[0]\r\n        );\r\n        this.handleRest(rendition);\r\n      });\r\n  };\r\n  toBuffer(ab) {\r\n    const buf = Buffer.alloc(ab.byteLength);\r\n    const view = new Uint8Array(ab);\r\n    for (let i = 0; i < buf.length; ++i) {\r\n      buf[i] = view[i];\r\n    }\r\n    return buf;\r\n  }\r\n  handleFb2 = async (result: ArrayBuffer) => {\r\n    let charset = \"\";\r\n    if (!this.props.currentBook.charset) {\r\n      charset = await this.handleCharset(result);\r\n    }\r\n    let fb2Str = iconv.decode(\r\n      Buffer.from(result),\r\n      this.props.currentBook.charset || charset || \"utf8\"\r\n    );\r\n    let bookObj = xmlBookParser(Buffer.from(result), fb2Str);\r\n    let rendition = new StrRender(\r\n      bookObj,\r\n      this.state.readerMode,\r\n      StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\r\n    );\r\n    await rendition.renderTo(\r\n      document.getElementsByClassName(\"html-viewer-page\")[0]\r\n    );\r\n    this.handleRest(rendition);\r\n  };\r\n  handleHtml = (result: ArrayBuffer, format: string) => {\r\n    var blob = new Blob([result], {\r\n      type: mimetype[format.toLocaleLowerCase()],\r\n    });\r\n    var reader = new FileReader();\r\n    reader.onload = async (evt) => {\r\n      const html = evt.target?.result as any;\r\n      let rendition = new StrRender(\r\n        html,\r\n        this.state.readerMode,\r\n        StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\r\n      );\r\n      await rendition.renderTo(\r\n        document.getElementsByClassName(\"html-viewer-page\")[0]\r\n      );\r\n      this.handleRest(rendition);\r\n    };\r\n    reader.readAsText(blob, \"UTF-8\");\r\n  };\r\n  render() {\r\n    let extraMargin =\r\n      this.props.currentBook.format === \"EPUB\"\r\n        ? (document.body.clientWidth - 2 * this.state.margin - 20) / 24\r\n        : 0;\r\n    return (\r\n      <>\r\n        <div\r\n          className=\"html-viewer-page\"\r\n          id=\"page-area\"\r\n          style={\r\n            document.body.clientWidth < 570\r\n              ? { left: 0, right: 0 }\r\n              : this.state.readerMode === \"scroll\"\r\n              ? {\r\n                  left: `calc(50vw - ${\r\n                    270 * parseFloat(this.state.scale)\r\n                  }px + 20px)`,\r\n                  right: `calc(50vw - ${\r\n                    270 * parseFloat(this.state.scale)\r\n                  }px + 15px)`,\r\n                  overflowY: \"scroll\",\r\n                  overflowX: \"hidden\",\r\n                }\r\n              : this.state.readerMode === \"single\"\r\n              ? {\r\n                  left: `calc(50vw - ${\r\n                    270 * parseFloat(this.state.scale)\r\n                  }px + 15px)`,\r\n                  right: `calc(50vw - ${\r\n                    270 * parseFloat(this.state.scale)\r\n                  }px + 15px)`,\r\n                }\r\n              : this.state.readerMode === \"double\"\r\n              ? {\r\n                  left: this.state.margin + 10 - extraMargin + \"px\",\r\n                  right: this.state.margin + 10 - extraMargin + \"px\",\r\n                }\r\n              : {}\r\n          }\r\n        ></div>\r\n        {StorageUtil.getReaderConfig(\"isHideBackground\") === \"yes\" ? null : this\r\n            .props.currentBook.key ? (\r\n          <Background />\r\n        ) : null}\r\n        {this.props.htmlBook && (\r\n          <PopupMenu\r\n            {...{\r\n              rendition: this.props.htmlBook.rendition,\r\n              rect: this.state.rect,\r\n              pageWidth: this.state.pageWidth,\r\n              pageHeight: this.state.pageHeight,\r\n              chapterIndex: this.state.chapterIndex,\r\n              chapter: this.state.chapter,\r\n            }}\r\n          />\r\n        )}\r\n        {this.props.htmlBook && (\r\n          <ImageViewer\r\n            {...{\r\n              isShow: this.props.isShow,\r\n              rendition: this.props.htmlBook.rendition,\r\n              handleEnterReader: this.props.handleEnterReader,\r\n              handleLeaveReader: this.props.handleLeaveReader,\r\n            }}\r\n          />\r\n        )}\r\n      </>\r\n    );\r\n  }\r\n}\r\nexport default withRouter(Viewer as any);\r\n","import BookModel from \"../../model/Book\";\r\nclass RecordRecent {\r\n  static setRecent(bookKey: string) {\r\n    let bookArr =\r\n      localStorage.getItem(\"recentBooks\") !== \"{}\" &&\r\n      localStorage.getItem(\"recentBooks\")\r\n        ? JSON.parse(localStorage.getItem(\"recentBooks\") || \"\")\r\n        : [];\r\n    const index = bookArr.indexOf(bookKey);\r\n    if (index > -1) {\r\n      bookArr.splice(index, 1);\r\n      bookArr.unshift(bookKey);\r\n    } else {\r\n      bookArr.unshift(bookKey);\r\n    }\r\n\r\n    localStorage.setItem(\"recentBooks\", JSON.stringify(bookArr));\r\n  }\r\n  static setAllRecent(books: BookModel[]) {\r\n    let bookArr: string[] = [];\r\n    books.forEach((item) => {\r\n      bookArr.push(item.key);\r\n    });\r\n    localStorage.setItem(\"recentBooks\", JSON.stringify(bookArr));\r\n  }\r\n\r\n  static clear(bookKey: string) {\r\n    let bookArr =\r\n      localStorage.getItem(\"recentBooks\") !== \"{}\" &&\r\n      localStorage.getItem(\"recentBooks\")\r\n        ? JSON.parse(localStorage.getItem(\"recentBooks\") || \"\")\r\n        : [];\r\n    const index = bookArr.indexOf(bookKey);\r\n    if (index > -1) {\r\n      bookArr.splice(index, 1);\r\n    }\r\n    localStorage.setItem(\"recentBooks\", JSON.stringify(bookArr));\r\n  }\r\n  static getAllRecent() {\r\n    let bookArr =\r\n      localStorage.getItem(\"recentBooks\") !== \"{}\" &&\r\n      localStorage.getItem(\"recentBooks\")\r\n        ? JSON.parse(localStorage.getItem(\"recentBooks\") || \"\")\r\n        : [];\r\n    return bookArr || [];\r\n  }\r\n}\r\n\r\nexport default RecordRecent;\r\n","export const mimetype = {\r\n  svg: \"image/svg+xml\",\r\n  png: \"image/png\",\r\n  jpg: \"image/jpeg\",\r\n  jpeg: \"image/jpeg\",\r\n  gif: \"image/gif\",\r\n  webp: \"image/webp\",\r\n  zip: \"application/zip\",\r\n  rar: \"application/x-rar-compressed\",\r\n  \"7z\": \"application/x-7z-compressed\",\r\n  tar: \"application/x-tar\",\r\n  html: \"text/html\",\r\n  htm: \"text/html\",\r\n  xml: \"text/xml\",\r\n  xhtml: \"application/xhtml+xml\",\r\n};\r\n","export const removeExtraQuestionMark = (html: any) => {\r\n  return html\r\n    .replaceAll(\"–?\", \"–\")\r\n    .replaceAll(\"“?\", \"“\")\r\n    .replaceAll(\"”?\", \"”\")\r\n    .replaceAll(\"©?\", \"©\")\r\n    .replaceAll(\"’?\", \"’\")\r\n    .replaceAll(\"“?\", \"“\")\r\n    .replaceAll(\"…?\", \"…\")\r\n    .replaceAll(\"—?\", \"—\")\r\n    .replaceAll(\"‘?\", \"‘\")\r\n    .replaceAll(\"“?\", \"“\");\r\n};\r\n","import StorageUtil from \"./storageUtil\";\r\nimport Chinese from \"chinese-s2t\";\r\nimport { getIframeDoc } from \"./docUtil\";\r\nexport const tsTransform = () => {\r\n  let doc = getIframeDoc();\r\n  if (!doc) return;\r\n  if (\r\n    StorageUtil.getReaderConfig(\"convertChinese\") &&\r\n    StorageUtil.getReaderConfig(\"convertChinese\") !== \"Default\"\r\n  ) {\r\n    if (\r\n      StorageUtil.getReaderConfig(\"convertChinese\") ===\r\n      \"Simplified To Traditional\"\r\n    ) {\r\n      doc.querySelectorAll(\"p\").forEach((item) => {\r\n        item.innerHTML = item.innerHTML.replace(\r\n          item.innerText,\r\n          Chinese.s2t(item.innerText)\r\n        );\r\n      });\r\n    } else {\r\n      doc.querySelectorAll(\"p\").forEach((item) => {\r\n        item.innerHTML = item.innerHTML.replace(\r\n          item.innerText,\r\n          Chinese.t2s(item.innerText)\r\n        );\r\n      });\r\n    }\r\n  }\r\n};\r\n","import React from \"react\";\r\nimport \"./background.css\";\r\nimport { BackgroundProps, BackgroundState } from \"./interface\";\r\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\n\r\nclass Background extends React.Component<BackgroundProps, BackgroundState> {\r\n  isFirst: Boolean;\r\n  constructor(props: any) {\r\n    super(props);\r\n    this.state = {\r\n      isSingle:\r\n        StorageUtil.getReaderConfig(\"readerMode\") &&\r\n        StorageUtil.getReaderConfig(\"readerMode\") !== \"double\",\r\n      scale: StorageUtil.getReaderConfig(\"scale\") || 1,\r\n    };\r\n    this.isFirst = true;\r\n  }\r\n  componentDidMount() {\r\n    let background = document.querySelector(\".background\");\r\n    if (!background) return;\r\n    background?.setAttribute(\r\n      \"style\",\r\n      `background-color:${StorageUtil.getReaderConfig(\r\n        \"backgroundColor\"\r\n      )};filter: brightness(${\r\n        StorageUtil.getReaderConfig(\"brightness\") || 1\r\n      }) invert(${StorageUtil.getReaderConfig(\"isInvert\") === \"yes\" ? 1 : 0})`\r\n    );\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <div\r\n          className=\"background-box2\"\r\n          style={\r\n            document.body.clientWidth < 570\r\n              ? { left: 5, right: 8 }\r\n              : this.state.isSingle\r\n              ? {\r\n                  left: `calc(50vw - ${\r\n                    270 * parseFloat(this.state.scale)\r\n                  }px - ${this.state.isSingle ? \"9\" : \"5\"}px)`,\r\n                  right: `calc(50vw - ${\r\n                    270 * parseFloat(this.state.scale)\r\n                  }px - 7px)`,\r\n                  boxShadow: \"0 0 0px rgba(191, 191, 191, 1)\",\r\n                }\r\n              : {}\r\n          }\r\n        ></div>\r\n\r\n        <div\r\n          className=\"background-box3\"\r\n          style={\r\n            document.body.clientWidth < 570\r\n              ? { left: 5, right: 10 }\r\n              : this.state.isSingle\r\n              ? {\r\n                  left: `calc(50vw - ${\r\n                    270 * parseFloat(this.state.scale)\r\n                  }px - 9px)`,\r\n                  right: `calc(50vw - ${\r\n                    270 * parseFloat(this.state.scale)\r\n                  }px - 9px)`,\r\n                }\r\n              : {}\r\n          }\r\n        >\r\n          {(!StorageUtil.getReaderConfig(\"backgroundColor\") &&\r\n            (StorageUtil.getReaderConfig(\"appSkin\") === \"night\" ||\r\n              (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\r\n                StorageUtil.getReaderConfig(\"isOSNight\") === \"yes\"))) ||\r\n          StorageUtil.getReaderConfig(\"backgroundColor\") ===\r\n            \"rgba(44,47,49,1)\" ? (\r\n            <div\r\n              className=\"dark-spine-shadow-left\"\r\n              style={\r\n                this.state.isSingle ||\r\n                (StorageUtil.getReaderConfig(\"backgroundColor\") &&\r\n                  StorageUtil.getReaderConfig(\"backgroundColor\").startsWith(\r\n                    \"#\"\r\n                  ))\r\n                  ? { display: \"none\" }\r\n                  : {}\r\n              }\r\n            ></div>\r\n          ) : (\r\n            <div\r\n              className=\"spine-shadow-left\"\r\n              style={\r\n                this.state.isSingle ||\r\n                (StorageUtil.getReaderConfig(\"backgroundColor\") &&\r\n                  StorageUtil.getReaderConfig(\"backgroundColor\").startsWith(\r\n                    \"#\"\r\n                  ))\r\n                  ? { display: \"none\" }\r\n                  : {}\r\n              }\r\n            ></div>\r\n          )}\r\n          <div\r\n            className=\"book-spine\"\r\n            style={this.state.isSingle ? { display: \"none\" } : {}}\r\n          ></div>\r\n          {(!StorageUtil.getReaderConfig(\"backgroundColor\") &&\r\n            StorageUtil.getReaderConfig(\"appSkin\") === \"night\") ||\r\n          StorageUtil.getReaderConfig(\"backgroundColor\") ===\r\n            \"rgba(44,47,49,1)\" ? (\r\n            <div\r\n              className=\"dark-spine-shadow-right\"\r\n              style={\r\n                StorageUtil.getReaderConfig(\"backgroundColor\") &&\r\n                StorageUtil.getReaderConfig(\"backgroundColor\").startsWith(\"#\")\r\n                  ? { display: \"none\" }\r\n                  : this.state.isSingle\r\n                  ? {\r\n                      position: \"relative\",\r\n                      right: 0,\r\n                    }\r\n                  : {}\r\n              }\r\n            ></div>\r\n          ) : (\r\n            <div\r\n              className=\"spine-shadow-right\"\r\n              style={\r\n                StorageUtil.getReaderConfig(\"backgroundColor\") &&\r\n                StorageUtil.getReaderConfig(\"backgroundColor\").startsWith(\"#\")\r\n                  ? { display: \"none\" }\r\n                  : this.state.isSingle\r\n                  ? {\r\n                      position: \"relative\",\r\n                      right: 0,\r\n                    }\r\n                  : {}\r\n              }\r\n            ></div>\r\n          )}\r\n        </div>\r\n\r\n        <div\r\n          className=\"background-box1\"\r\n          style={\r\n            document.body.clientWidth < 570\r\n              ? { left: 5, right: 6 }\r\n              : this.state.isSingle\r\n              ? {\r\n                  left: `calc(50vw - ${\r\n                    270 * parseFloat(this.state.scale)\r\n                  }px - ${this.state.isSingle ? \"9\" : \"5\"}px)`,\r\n                  right: `calc(50vw - ${\r\n                    270 * parseFloat(this.state.scale)\r\n                  }px - 5px)`,\r\n                  boxShadow: \"0 0 0px rgba(191, 191, 191, 1)\",\r\n                }\r\n              : {}\r\n          }\r\n        ></div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Background;\r\n","import { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport Background from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentBook: state.book.currentBook,\r\n  };\r\n};\r\nconst actionCreator = {};\r\nexport default connect(mapStateToProps, actionCreator)(Background);\r\n","import React from \"react\";\r\nimport \"./imageViewer.css\";\r\nimport { ImageViewerProps, ImageViewerStates } from \"./interface\";\r\nimport FileSaver from \"file-saver\";\r\nimport { handleLinkJump } from \"../../utils/readUtils/linkUtil\";\r\nimport { getIframeDoc } from \"../../utils/serviceUtils/docUtil\";\r\n\r\nclass ImageViewer extends React.Component<ImageViewerProps, ImageViewerStates> {\r\n  constructor(props: ImageViewerProps) {\r\n    super(props);\r\n    this.state = {\r\n      isShowImage: false,\r\n      imageRatio: \"horizontal\",\r\n      zoomIndex: 0,\r\n      rotateIndex: 0,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.rendition.on(\"rendered\", () => {\r\n      let doc = getIframeDoc();\r\n      if (!doc) return;\r\n      // StyleUtil.addDefaultCss();\r\n      doc.addEventListener(\"click\", this.showImage);\r\n    });\r\n  }\r\n\r\n  showImage = (event: any) => {\r\n    event.preventDefault();\r\n    if (this.props.isShow) {\r\n      this.props.handleLeaveReader(\"left\");\r\n      this.props.handleLeaveReader(\"right\");\r\n      this.props.handleLeaveReader(\"top\");\r\n      this.props.handleLeaveReader(\"bottom\");\r\n    }\r\n    handleLinkJump(event);\r\n    if (!event.target.src) {\r\n      return;\r\n    }\r\n    if (this.state.isShowImage) {\r\n      this.setState({\r\n        isShowImage: false,\r\n        zoomIndex: 0,\r\n        rotateIndex: 0,\r\n        imageRatio: \"horizontal\",\r\n      });\r\n    }\r\n    event.preventDefault();\r\n    const handleDirection = (direction: string) => {\r\n      this.setState({ imageRatio: direction });\r\n    };\r\n    var img = new Image();\r\n    img.addEventListener(\"load\", function () {\r\n      handleDirection(\r\n        this.naturalWidth / this.naturalHeight > 1 ? \"horizontal\" : \"vertical\"\r\n      );\r\n    });\r\n    img.src = event.target.src;\r\n    let image: HTMLImageElement | null = document.querySelector(\".image\");\r\n    if (image) {\r\n      image!.src = event.target.src;\r\n      this.setState({ isShowImage: true });\r\n    }\r\n  };\r\n  hideImage = (event: any) => {\r\n    event.preventDefault();\r\n    if (event.target.src) {\r\n      let image: HTMLImageElement | null = document.querySelector(\".image\");\r\n      if (image) image.src = \"\";\r\n    }\r\n    this.setState({ isShowImage: false });\r\n  };\r\n  handleZoomIn = () => {\r\n    let image: any = document.querySelector(\".image\");\r\n    if (image.style.width === \"200vw\" || image.style.height === \"200vh\") return;\r\n    this.setState({ zoomIndex: this.state.zoomIndex + 1 }, () => {\r\n      if (this.state.imageRatio === \"horizontal\") {\r\n        image.style.width = `${60 + this.state.zoomIndex * 10}vw`;\r\n      } else {\r\n        image.style.height = `${100 + 10 * this.state.zoomIndex}vh`;\r\n        image.style.marginTop = `${10 * this.state.zoomIndex}vh`;\r\n      }\r\n    });\r\n  };\r\n  handleZoomOut = () => {\r\n    let image: any = document.querySelector(\".image\");\r\n    if (image.style.width === \"10vw\" || image.style.height === \"10vh\") return;\r\n    this.setState({ zoomIndex: this.state.zoomIndex - 1 }, () => {\r\n      if (this.state.imageRatio === \"horizontal\") {\r\n        image.style.width = `${60 + this.state.zoomIndex * 10}vw`;\r\n      } else {\r\n        image.style.height = `${100 + 10 * this.state.zoomIndex}vh`;\r\n      }\r\n    });\r\n  };\r\n  handleSave = async () => {\r\n    let image: any = document.querySelector(\".image\");\r\n    let blob = await fetch(image.src).then((r) => r.blob());\r\n    FileSaver.saveAs(blob, `${new Date().toLocaleDateString()}`);\r\n  };\r\n  handleClock = () => {\r\n    let image: any = document.querySelector(\".image\");\r\n    this.setState({ rotateIndex: this.state.rotateIndex + 1 }, () => {\r\n      image.style.transform = `rotate(${this.state.rotateIndex * 90}deg)`;\r\n    });\r\n  };\r\n  handleCounterClock = () => {\r\n    let image: any = document.querySelector(\".image\");\r\n    this.setState({ rotateIndex: this.state.rotateIndex - 1 }, () => {\r\n      image.style.transform = `rotate(${this.state.rotateIndex * 90}deg)`;\r\n    });\r\n  };\r\n  render() {\r\n    return (\r\n      <div\r\n        className=\"image-preview\"\r\n        style={this.state.isShowImage ? {} : { display: \"none\" }}\r\n      >\r\n        <div\r\n          className=\"image-background\"\r\n          style={\r\n            this.state.isShowImage\r\n              ? { backgroundColor: \"rgba(75,75,75,0.3)\" }\r\n              : {}\r\n          }\r\n          onClick={(event) => {\r\n            this.hideImage(event);\r\n          }}\r\n        ></div>\r\n        <img\r\n          src=\"\"\r\n          alt=\"\"\r\n          className=\"image\"\r\n          style={\r\n            this.state.imageRatio === \"horizontal\"\r\n              ? { width: \"60vw\" }\r\n              : { height: \"100vh\" }\r\n          }\r\n        />\r\n        <div className=\"image-operation\">\r\n          <span\r\n            className=\"icon-zoom-in zoom-in-icon\"\r\n            onClick={() => {\r\n              this.handleZoomIn();\r\n            }}\r\n          ></span>\r\n          <span\r\n            className=\"icon-zoom-out zoom-out-icon\"\r\n            onClick={() => {\r\n              this.handleZoomOut();\r\n            }}\r\n          ></span>\r\n          <span\r\n            className=\"icon-save save-icon\"\r\n            onClick={() => {\r\n              this.handleSave();\r\n            }}\r\n          ></span>\r\n          <span\r\n            className=\"icon-clockwise clockwise-icon\"\r\n            onClick={() => {\r\n              this.handleClock();\r\n            }}\r\n          ></span>\r\n          <span\r\n            className=\"icon-counterclockwise counterclockwise-icon\"\r\n            onClick={() => {\r\n              this.handleCounterClock();\r\n            }}\r\n          ></span>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ImageViewer;\r\n","import { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport ImageViewer from \"./component\";\r\nimport { withTranslation } from \"react-i18next\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentBook: state.book.currentBook,\r\n  };\r\n};\r\nconst actionCreator = {};\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(ImageViewer as any));\r\n","import StorageUtil from \"./storageUtil\";\r\nimport RecordLocation from \"../readUtils/recordLocation\";\r\nimport { isElectron } from \"react-device-detect\";\r\nimport { getIframeDoc } from \"./docUtil\";\r\nlet Hammer = (window as any).Hammer;\r\ndeclare var document: any;\r\nconst sleep = (ms: number) => {\r\n  return new Promise((resolve) => setTimeout(resolve, ms));\r\n};\r\n\r\nlet throttleTime =\r\n  StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? 1000 : 100;\r\nexport const getSelection = () => {\r\n  let doc = getIframeDoc();\r\n  if (!doc) return;\r\n  let sel = doc.getSelection();\r\n  if (!sel) return;\r\n  let text = sel.toString();\r\n  text = text && text.trim();\r\n  return text || \"\";\r\n};\r\nlet lock = false; //prevent from clicking too fasts\r\nconst arrowKeys = (rendition: any, keyCode: number, event: any) => {\r\n  if (\r\n    document.querySelector(\".editor-box\") ||\r\n    document.querySelector(\".navigation-search-title\")\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  if (lock) return;\r\n  if (keyCode === 37 || keyCode === 38) {\r\n    event.preventDefault();\r\n    rendition.prev();\r\n\r\n    lock = true;\r\n    setTimeout(function () {\r\n      lock = false;\r\n    }, throttleTime);\r\n    return false;\r\n  }\r\n  if (keyCode === 39 || keyCode === 40 || keyCode === 32) {\r\n    event.preventDefault();\r\n    rendition.next();\r\n    lock = true;\r\n    setTimeout(function () {\r\n      lock = false;\r\n    }, throttleTime);\r\n    return false;\r\n  }\r\n  handleShortcut(event, keyCode);\r\n};\r\n\r\nconst mouseChrome = (rendition: any, wheelDelta: number) => {\r\n  if (lock) return;\r\n  if (wheelDelta > 0) {\r\n    rendition.prev();\r\n    lock = true;\r\n    setTimeout(function () {\r\n      lock = false;\r\n    }, throttleTime);\r\n    return false;\r\n  }\r\n  if (wheelDelta < 0) {\r\n    rendition.next();\r\n    lock = true;\r\n    setTimeout(function () {\r\n      lock = false;\r\n    }, throttleTime);\r\n    return false;\r\n  }\r\n};\r\n\r\nconst handleShortcut = (event: any, keyCode: number) => {\r\n  if (keyCode === 9) {\r\n    if (isElectron) {\r\n      event.preventDefault();\r\n      window.require(\"electron\").ipcRenderer.invoke(\"hide-reader\", \"ping\");\r\n    }\r\n  }\r\n  if (keyCode === 27) {\r\n    if (isElectron) {\r\n      StorageUtil.setReaderConfig(\"isFullscreen\", \"no\");\r\n    }\r\n  }\r\n  if (keyCode === 122) {\r\n    if (isElectron) {\r\n      event.preventDefault();\r\n      if (StorageUtil.getReaderConfig(\"isFullscreen\") === \"yes\") {\r\n        window\r\n          .require(\"electron\")\r\n          .ipcRenderer.invoke(\"exit-fullscreen\", \"ping\");\r\n        StorageUtil.setReaderConfig(\"isFullscreen\", \"no\");\r\n      } else {\r\n        window\r\n          .require(\"electron\")\r\n          .ipcRenderer.invoke(\"enter-fullscreen\", \"ping\");\r\n        StorageUtil.setReaderConfig(\"isFullscreen\", \"yes\");\r\n      }\r\n    }\r\n  }\r\n  if (keyCode === 123) {\r\n    if (isElectron) {\r\n      event.preventDefault();\r\n      StorageUtil.setReaderConfig(\r\n        \"isMergeWord\",\r\n        StorageUtil.getReaderConfig(\"isMergeWord\") === \"yes\" ? \"no\" : \"yes\"\r\n      );\r\n      window.require(\"electron\").ipcRenderer.invoke(\"switch-moyu\", \"ping\");\r\n    }\r\n  }\r\n  lock = true;\r\n  setTimeout(function () {\r\n    lock = false;\r\n  }, throttleTime);\r\n  return false;\r\n};\r\n\r\nconst gesture = (rendition: any, type: string) => {\r\n  if (lock) return;\r\n  if (type === \"panleft\" || type === \"panup\") {\r\n    rendition.next();\r\n    lock = true;\r\n    setTimeout(function () {\r\n      lock = false;\r\n    }, throttleTime);\r\n    return false;\r\n  }\r\n  if (type === \"panright\" || type === \"pandown\") {\r\n    rendition.prev();\r\n    lock = true;\r\n    setTimeout(function () {\r\n      lock = false;\r\n    }, throttleTime);\r\n    return false;\r\n  }\r\n};\r\n\r\nconst handleLocation = (key: string, rendition: any) => {\r\n  setTimeout(async () => {\r\n    let position = await rendition.getPosition();\r\n    RecordLocation.recordHtmlLocation(\r\n      key,\r\n      position.text,\r\n      position.chapterTitle,\r\n      position.count,\r\n      position.percentage,\r\n      position.cfi\r\n    );\r\n  }, 500);\r\n};\r\nconst bindHtmlEvent = (\r\n  rendition: any,\r\n  doc: any,\r\n  key: string = \"\",\r\n  readerMode: string = \"\"\r\n) => {\r\n  doc.addEventListener(\"keydown\", async (event) => {\r\n    arrowKeys(rendition, event.keyCode, event);\r\n    handleLocation(key, rendition);\r\n  });\r\n  doc.addEventListener(\r\n    \"mousewheel\",\r\n    async (event) => {\r\n      if (readerMode === \"scroll\") {\r\n        await sleep(200);\r\n        rendition.record();\r\n      } else {\r\n        mouseChrome(rendition, event.wheelDelta);\r\n      }\r\n\r\n      handleLocation(key, rendition);\r\n    },\r\n    false\r\n  );\r\n\r\n  window.addEventListener(\"keydown\", async (event) => {\r\n    arrowKeys(rendition, event.keyCode, event);\r\n    //使用Key判断是否是htmlBook\r\n\r\n    handleLocation(key, rendition);\r\n  });\r\n\r\n  if (StorageUtil.getReaderConfig(\"isTouch\") === \"yes\") {\r\n    const mc = new Hammer(doc);\r\n    mc.on(\"panleft panright panup pandown\", async (event: any) => {\r\n      gesture(rendition, event.type);\r\n\r\n      handleLocation(key, rendition);\r\n    });\r\n  }\r\n};\r\nexport const HtmlMouseEvent = (\r\n  rendition: any,\r\n  key: string,\r\n  readerMode: string\r\n) => {\r\n  rendition.on(\"rendered\", () => {\r\n    let doc = getIframeDoc();\r\n    if (!doc) return;\r\n    lock = false;\r\n    bindHtmlEvent(rendition, doc, key, readerMode);\r\n  });\r\n};\r\nexport const pdfMouseEvent = () => {\r\n  let pageArea = document.getElementById(\"page-area\");\r\n  if (!pageArea) return;\r\n  let iframe = pageArea.getElementsByTagName(\"iframe\")[0];\r\n  if (!iframe) return;\r\n  let doc: any = iframe.contentWindow || iframe.contentDocument?.defaultView;\r\n\r\n  doc.document.addEventListener(\"keydown\", (event) => {\r\n    handleShortcut(event, event.keyCode);\r\n  });\r\n};\r\nexport const djvuMouseEvent = () => {\r\n  document.addEventListener(\"keydown\", (event) => {\r\n    handleShortcut(event, event.keyCode);\r\n  });\r\n};\r\n","export const getIframeDoc = () => {\r\n  let pageArea = document.getElementById(\"page-area\");\r\n\r\n  if (!pageArea) return null;\r\n  let iframe = pageArea.getElementsByTagName(\"iframe\")[0];\r\n  if (!iframe) return null;\r\n  let doc = iframe.contentDocument;\r\n\r\n  if (!doc) {\r\n    return null;\r\n  }\r\n  return doc;\r\n};\r\nexport const getPDFIframeDoc = () => {\r\n  let pageArea = document.getElementById(\"page-area\");\r\n  if (!pageArea) return null;\r\n  let iframe = pageArea.getElementsByTagName(\"iframe\")[0];\r\n  if (!iframe) return null;\r\n  let iWin: any = iframe.contentWindow || iframe.contentDocument?.defaultView;\r\n  if (!iWin) return null;\r\n  return iWin;\r\n};\r\n","import localforage from \"localforage\";\r\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\nimport SortUtil from \"../../utils/readUtils/sortUtil\";\r\nimport BookModel from \"../../model/Book\";\r\nimport { Dispatch } from \"redux\";\r\nimport AddTrash from \"../../utils/readUtils/addTrash\";\r\n\r\nexport function handleBooks(books: BookModel[]) {\r\n  return { type: \"HANDLE_BOOKS\", payload: books };\r\n}\r\nexport function handleDeletedBooks(deletedBooks: BookModel[]) {\r\n  return { type: \"HANDLE_DELETED_BOOKS\", payload: deletedBooks };\r\n}\r\nexport function handleSearchResults(searchResults: number[]) {\r\n  return { type: \"HANDLE_SEARCH_BOOKS\", payload: searchResults };\r\n}\r\nexport function handleSearch(isSearch: boolean) {\r\n  return { type: \"HANDLE_SEARCH\", payload: isSearch };\r\n}\r\nexport function handleTipDialog(isTipDialog: boolean) {\r\n  return { type: \"HANDLE_TIP_DIALOG\", payload: isTipDialog };\r\n}\r\nexport function handleTip(tip: string) {\r\n  return { type: \"HANDLE_TIP\", payload: tip };\r\n}\r\nexport function handleSetting(isSettingOpen: boolean) {\r\n  return { type: \"HANDLE_SETTING\", payload: isSettingOpen };\r\n}\r\nexport function handleAbout(isAboutOpen: boolean) {\r\n  return { type: \"HANDLE_ABOUT\", payload: isAboutOpen };\r\n}\r\nexport function handleViewMode(mode: string) {\r\n  return { type: \"HANDLE_VIEW_MODE\", payload: mode };\r\n}\r\n\r\nexport function handleSortDisplay(isSortDisplay: boolean) {\r\n  return { type: \"HANDLE_SORT_DISPLAY\", payload: isSortDisplay };\r\n}\r\nexport function handleLoadingDialog(isShowLoading: boolean) {\r\n  return { type: \"HANDLE_SHOW_LOADING\", payload: isShowLoading };\r\n}\r\nexport function handleNewDialog(isShowNew: boolean) {\r\n  return { type: \"HANDLE_SHOW_NEW\", payload: isShowNew };\r\n}\r\nexport function handleSelectBook(isSelectBook: boolean) {\r\n  return { type: \"HANDLE_SELECT_BOOK\", payload: isSelectBook };\r\n}\r\nexport function handleSelectedBooks(selectedBooks: string[]) {\r\n  return { type: \"HANDLE_SELECTED_BOOKS\", payload: selectedBooks };\r\n}\r\nexport function handleNewWarning(isNewWarning: boolean) {\r\n  return { type: \"HANDLE_NEW_WARNING\", payload: isNewWarning };\r\n}\r\nexport function handleBookSort(isBookSort: boolean) {\r\n  return { type: \"HANDLE_BOOK_SORT\", payload: isBookSort };\r\n}\r\nexport function handleNoteSort(isNoteSort: boolean) {\r\n  return { type: \"HANDLE_NOTE_SORT\", payload: isNoteSort };\r\n}\r\nexport function handleBookSortCode(bookSortCode: {\r\n  sort: number;\r\n  order: number;\r\n}) {\r\n  return { type: \"HANDLE_SORT_CODE\", payload: bookSortCode };\r\n}\r\n\r\nexport function handleNoteSortCode(noteSortCode: {\r\n  sort: number;\r\n  order: number;\r\n}) {\r\n  return { type: \"HANDLE_NOTE_SORT_CODE\", payload: noteSortCode };\r\n}\r\n\r\nexport function handleFetchBooks(isTrash = false) {\r\n  return (dispatch: Dispatch) => {\r\n    localforage.getItem(\"books\", (err, value) => {\r\n      let bookArr: any = value;\r\n      let keyArr = AddTrash.getAllTrash();\r\n      if (isTrash) {\r\n        dispatch(handleDeletedBooks(handleKeyFilter(bookArr, keyArr)));\r\n      } else {\r\n        dispatch(handleBooks(handleKeyRemove(bookArr, keyArr)));\r\n      }\r\n    });\r\n  };\r\n}\r\nexport function handleFetchBookSortCode() {\r\n  return (dispatch: Dispatch) => {\r\n    let bookSortCode = SortUtil.getBookSortCode();\r\n    dispatch(handleBookSortCode(bookSortCode));\r\n  };\r\n}\r\nexport function handleFetchNoteSortCode() {\r\n  return (dispatch: Dispatch) => {\r\n    let noteSortCode = SortUtil.getNoteSortCode();\r\n    dispatch(handleNoteSortCode(noteSortCode));\r\n  };\r\n}\r\nexport function handleFetchList() {\r\n  return (dispatch: Dispatch) => {\r\n    let viewMode = StorageUtil.getReaderConfig(\"viewMode\") || \"card\";\r\n    dispatch(handleViewMode(viewMode));\r\n  };\r\n}\r\nconst handleKeyRemove = (items: any[], arr: string[]) => {\r\n  if (!items) return [];\r\n  let itemArr: any[] = [];\r\n  if (!arr[0]) {\r\n    return items;\r\n  }\r\n  for (let item of items) {\r\n    if (arr.indexOf(item.key) === -1) {\r\n      itemArr.push(item);\r\n    }\r\n  }\r\n\r\n  return itemArr;\r\n};\r\nconst handleKeyFilter = (items: any[], arr: string[]) => {\r\n  if (!items) {\r\n    return [];\r\n  }\r\n  let itemArr: any[] = [];\r\n  for (let item of items) {\r\n    if (arr.indexOf(item.key) > -1) {\r\n      itemArr.push(item);\r\n    }\r\n  }\r\n  return itemArr;\r\n};\r\n","import BookModel from \"../../model/Book\";\r\nexport function handleEditDialog(mode: boolean) {\r\n  return { type: \"HANDLE_EDIT_DIALOG\", payload: mode };\r\n}\r\nexport function handleDeleteDialog(mode: boolean) {\r\n  return { type: \"HANDLE_DELETE_DIALOG\", payload: mode };\r\n}\r\nexport function handleAddDialog(mode: boolean) {\r\n  return { type: \"HANDLE_ADD_DIALOG\", payload: mode };\r\n}\r\nexport function handleRenderFunc(renderFunc: () => void) {\r\n  return { type: \"HANDLE_RENDER_FUNC\", payload: renderFunc };\r\n}\r\nexport function handleActionDialog(mode: boolean) {\r\n  return { type: \"HANDLE_ACTION_DIALOG\", payload: mode };\r\n}\r\nexport function handleReadingState(state: boolean) {\r\n  return { type: \"HANDLE_READING_STATE\", payload: state };\r\n}\r\nexport function handleReadingBook(book: BookModel) {\r\n  return { type: \"HANDLE_READING_BOOK\", payload: book };\r\n}\r\nexport function handleDragItem(key: string) {\r\n  return { type: \"HANDLE_DRAG_ITEM\", payload: key };\r\n}\r\n","export function handleBackupDialog(mode: boolean) {\r\n  return { type: \"HANDLE_BACKUP\", payload: mode };\r\n}\r\nexport function handleTokenDialog(mode: boolean) {\r\n  return { type: \"HANDLE_TOKEN_DIALOG\", payload: mode };\r\n}\r\n","import RecordLocation from \"../../utils/readUtils/recordLocation\";\r\nimport BookModel from \"../../model/Book\";\r\nexport function handleLocations(locations: any) {\r\n  return { type: \"HANDLE_LOCATIONS\", payload: locations };\r\n}\r\nexport function handlePercentage(percentage: number) {\r\n  return { type: \"HANDLE_PERCENTAGE\", payload: percentage };\r\n}\r\nexport function handleFetchPercentage(book: BookModel) {\r\n  return (dispatch: (arg0: { type: string; payload: any }) => void) => {\r\n    let percentage = RecordLocation.getHtmlLocation(book.key).percentage;\r\n\r\n    dispatch(handlePercentage(percentage));\r\n  };\r\n}\r\n","import localforage from \"localforage\";\r\nimport NoteModel from \"../../model/Note\";\r\nimport BookmarkModel from \"../../model/Bookmark\";\r\nimport HtmlBookModel from \"../../model/HtmlBook\";\r\nimport AddTrash from \"../../utils/readUtils/addTrash\";\r\nexport function handleNotes(notes: NoteModel[]) {\r\n  return { type: \"HANDLE_NOTES\", payload: notes };\r\n}\r\nexport function handleOriginalText(originalText: string) {\r\n  return { type: \"HANDLE_ORIGINAL_TEXT\", payload: originalText };\r\n}\r\nexport function handleColor(color: number) {\r\n  return { type: \"HANDLE_COLOR\", payload: color };\r\n}\r\nexport function handleBookmarks(bookmarks: BookmarkModel[]) {\r\n  return { type: \"HANDLE_BOOKMARKS\", payload: bookmarks };\r\n}\r\nexport function handleDigests(digests: NoteModel[]) {\r\n  return { type: \"HANDLE_DIGESTS\", payload: digests };\r\n}\r\nexport function handleHtmlBook(htmlBook: HtmlBookModel) {\r\n  return { type: \"HANDLE_HTML_BOOK\", payload: htmlBook };\r\n}\r\nexport function handleCurrentChapter(currentChapter: string) {\r\n  return { type: \"HANDLE_CURRENT_CHAPTER\", payload: currentChapter };\r\n}\r\nexport function handleChapters(chapters: any) {\r\n  return { type: \"HANDLE_CHAPTERS\", payload: chapters };\r\n}\r\nexport function handleNoteKey(key: string) {\r\n  return { type: \"HANDLE_NOTE_KEY\", payload: key };\r\n}\r\nexport function handleFetchNotes() {\r\n  return (dispatch: (arg0: { type: string; payload: NoteModel[] }) => void) => {\r\n    localforage.getItem(\"notes\", (err, value) => {\r\n      let noteArr: any;\r\n      if (value === null || value === []) {\r\n        noteArr = [];\r\n      } else {\r\n        noteArr = value;\r\n      }\r\n      let keyArr = AddTrash.getAllTrash();\r\n      dispatch(handleNotes(handleKeyRemove(noteArr, keyArr)));\r\n      dispatch(\r\n        handleDigests(\r\n          handleKeyRemove(\r\n            noteArr.filter((item: NoteModel) => {\r\n              return item.notes === \"\";\r\n            }),\r\n            keyArr\r\n          )\r\n        )\r\n      );\r\n    });\r\n  };\r\n}\r\nexport function flatChapter(chapters: any) {\r\n  let newChapter: any = [];\r\n  for (let i = 0; i < chapters.length; i++) {\r\n    if (chapters[i].subitems[0]) {\r\n      newChapter.push(chapters[i]);\r\n      newChapter = newChapter.concat(flatChapter(chapters[i].subitems));\r\n    } else {\r\n      newChapter.push(chapters[i]);\r\n    }\r\n  }\r\n  return newChapter;\r\n}\r\n\r\nexport function handleFetchBookmarks() {\r\n  return (\r\n    dispatch: (arg0: { type: string; payload: BookmarkModel[] }) => void\r\n  ) => {\r\n    localforage.getItem(\"bookmarks\", (err, value) => {\r\n      let bookmarkArr: any;\r\n      if (value === null || value === []) {\r\n        bookmarkArr = [];\r\n      } else {\r\n        bookmarkArr = value;\r\n      }\r\n      let keyArr = AddTrash.getAllTrash();\r\n      dispatch(handleBookmarks(handleKeyRemove(bookmarkArr, keyArr)));\r\n    });\r\n  };\r\n}\r\nconst handleKeyRemove = (items: any[], arr: string[]) => {\r\n  let itemArr: any[] = [];\r\n  if (!arr[0]) {\r\n    return items;\r\n  }\r\n  for (let i = 0; i < items.length; i++) {\r\n    if (arr.indexOf(items[i].bookKey) === -1) {\r\n      itemArr.push(items[i]);\r\n    }\r\n  }\r\n  return itemArr;\r\n};\r\n","export function handleShelfIndex(shelfIndex: number) {\r\n  return { type: \"HANDLE_SHELF_INDEX\", payload: shelfIndex };\r\n}\r\nexport function handleCollapse(isCollapsed: boolean) {\r\n  return { type: \"HANDLE_COLLAPSE\", payload: isCollapsed };\r\n}\r\nexport function handleMode(mode: string) {\r\n  return { type: \"HANDLE_MODE\", payload: mode };\r\n}\r\n","export function handleOpenMenu(isOpenMenu: boolean) {\r\n  return { type: \"HANDLE_OPEN_MENU\", payload: isOpenMenu };\r\n}\r\nexport function handleMenuMode(menuMode: string) {\r\n  return { type: \"HANDLE_MENU_MODE\", payload: menuMode };\r\n}\r\nexport function handleOpenHighlight(isOpenHighlight: boolean) {\r\n  return { type: \"HANDLE_OPEN_HIGHLIGHT\", payload: isOpenHighlight };\r\n}\r\nexport function handleChangeDirection(isChangeDirection: boolean) {\r\n  return { type: \"HANDLE_CHANGE_DIRECTION\", payload: isChangeDirection };\r\n}\r\nexport function handleShowBookmark(isShowBookmark: boolean) {\r\n  return { type: \"HANDLE_SHOW_BOOKMARK\", payload: isShowBookmark };\r\n}\r\nexport function handleSelection(selection: string) {\r\n  return { type: \"HANDLE_SELECTION\", payload: selection };\r\n}\r\n","import BookModel from \"../../model/Book\";\r\nclass AddTrash {\r\n  static setTrash(bookKey: string) {\r\n    let bookArr =\r\n      localStorage.getItem(\"deletedBooks\") !== \"{}\" &&\r\n      localStorage.getItem(\"deletedBooks\")\r\n        ? JSON.parse(localStorage.getItem(\"deletedBooks\") || \"\")\r\n        : [];\r\n    const index = bookArr.indexOf(bookKey);\r\n    if (index > -1) {\r\n      bookArr.splice(index, 1);\r\n      bookArr.unshift(bookKey);\r\n    } else {\r\n      bookArr.unshift(bookKey);\r\n    }\r\n\r\n    localStorage.setItem(\"deletedBooks\", JSON.stringify(bookArr));\r\n  }\r\n  static setAllTrash(books: BookModel[]) {\r\n    let bookArr: string[] = [];\r\n    books.forEach((item) => {\r\n      bookArr.push(item.key);\r\n    });\r\n    localStorage.setItem(\"deletedBooks\", JSON.stringify(bookArr));\r\n  }\r\n  static clear(bookKey: string) {\r\n    let bookArr =\r\n      localStorage.getItem(\"deletedBooks\") !== \"{}\" &&\r\n      localStorage.getItem(\"deletedBooks\")\r\n        ? JSON.parse(localStorage.getItem(\"deletedBooks\") || \"\")\r\n        : [];\r\n    const index = bookArr.indexOf(bookKey);\r\n    if (index > -1) {\r\n      bookArr.splice(index, 1);\r\n    }\r\n    localStorage.setItem(\"deletedBooks\", JSON.stringify(bookArr));\r\n  }\r\n  static getAllTrash() {\r\n    let bookArr =\r\n      localStorage.getItem(\"deletedBooks\") !== \"{}\" &&\r\n      localStorage.getItem(\"deletedBooks\")\r\n        ? JSON.parse(localStorage.getItem(\"deletedBooks\") || \"\")\r\n        : [];\r\n    return bookArr || [];\r\n  }\r\n}\r\n\r\nexport default AddTrash;\r\n","import BookModel from \"../../model/Book\";\r\nimport NoteModel from \"../../model/Note\";\r\nimport ReadingTime from \"./readingTime\";\r\nimport RecordLocation from \"./recordLocation\";\r\nimport _ from \"underscore\";\r\nimport RecordRecent from \"./recordRecent\";\r\nconst getBookName = (books: BookModel[]) => {\r\n  return books.map((item) => item.name);\r\n};\r\nconst getAuthorName = (books: BookModel[]) => {\r\n  return books.map((item) => item.author);\r\n};\r\nconst getBookKey = (books: BookModel[]) => {\r\n  return books.map((item) => item.key);\r\n};\r\nconst getBookIndex = (nameArr: string[], oldNameArr: string[]) => {\r\n  let indexArr: number[] = [];\r\n  for (let i = 0; i < nameArr.length; i++) {\r\n    if (oldNameArr.indexOf(nameArr[i]) > -1) {\r\n      //如果索引数组已经包含该索引，就把它放在随后一位，取数组长度为索引\r\n      indexArr.push(\r\n        indexArr.indexOf(oldNameArr.indexOf(nameArr[i])) > -1\r\n          ? indexArr.length\r\n          : oldNameArr.indexOf(nameArr[i])\r\n      );\r\n    }\r\n  }\r\n  return indexArr.length < nameArr.length\r\n    ? indexArr.concat(\r\n        nameArr\r\n          .map((item, index) => index)\r\n          .filter((item) => indexArr.indexOf(item) === -1)\r\n      )\r\n    : indexArr;\r\n};\r\nconst getDurationArr = () => {\r\n  let durationObj = ReadingTime.getAllTime();\r\n  var sortable: any[] = [];\r\n  for (let obj in durationObj) {\r\n    sortable.push([obj, durationObj[obj]]);\r\n  }\r\n  sortable.sort(function (a, b) {\r\n    return a[1] - b[1];\r\n  });\r\n  return Object.keys(durationObj);\r\n};\r\nconst getPercentageArr = () => {\r\n  let locationObj = RecordLocation.getAllCfi();\r\n  var sortable: any = [];\r\n  for (let obj in locationObj) {\r\n    sortable.push([obj, locationObj[obj].percentage || 0]);\r\n  }\r\n  sortable.sort(function (a, b) {\r\n    return a[1] - b[1];\r\n  });\r\n  return sortable.map((item) => item[0]);\r\n};\r\nclass SortUtil {\r\n  static sortBooks(\r\n    books: BookModel[],\r\n    bookSortCode: { sort: number; order: number }\r\n  ) {\r\n    let oldRecentArr = books.map((item) => item.key);\r\n    let recentArr = RecordRecent.getAllRecent();\r\n    if (bookSortCode.sort === 0) {\r\n      if (bookSortCode.order === 1) {\r\n        return getBookIndex(recentArr, oldRecentArr);\r\n      } else {\r\n        return getBookIndex(recentArr, oldRecentArr).reverse();\r\n      }\r\n    }\r\n    if (bookSortCode.sort === 1) {\r\n      let oldNameArr = getBookName(books);\r\n      let nameArr = getBookName(books).sort();\r\n      if (bookSortCode.order === 1) {\r\n        return getBookIndex(nameArr, oldNameArr);\r\n      } else {\r\n        return getBookIndex(nameArr, oldNameArr).reverse();\r\n      }\r\n    }\r\n    if (bookSortCode.sort === 2) {\r\n      let nameArr: number[] = [];\r\n      for (let i = 0; i < books.length; i++) {\r\n        nameArr.push(i);\r\n      }\r\n      if (bookSortCode.order === 1) {\r\n        return nameArr;\r\n      } else {\r\n        return nameArr.reverse();\r\n      }\r\n    }\r\n    if (bookSortCode.sort === 3) {\r\n      let durationKeys = getDurationArr();\r\n\r\n      let bookKeys = getBookKey(books);\r\n      if (bookSortCode.order === 1) {\r\n        return getBookIndex(_.union(durationKeys, bookKeys), bookKeys);\r\n      } else {\r\n        return getBookIndex(\r\n          _.union(durationKeys, bookKeys),\r\n          bookKeys\r\n        ).reverse();\r\n      }\r\n    }\r\n    if (bookSortCode.sort === 4) {\r\n      let oldAuthorArr = getAuthorName(books);\r\n      let authorArr = getAuthorName(books).sort();\r\n      if (bookSortCode.order === 1) {\r\n        return getBookIndex(authorArr, oldAuthorArr);\r\n      } else {\r\n        return getBookIndex(authorArr, oldAuthorArr).reverse();\r\n      }\r\n    }\r\n    if (bookSortCode.sort === 5) {\r\n      let percentagenKeys = getPercentageArr();\r\n      let bookKeys = getBookKey(books);\r\n      if (bookSortCode.order === 1) {\r\n        return getBookIndex(percentagenKeys, bookKeys);\r\n      } else {\r\n        return getBookIndex(percentagenKeys, bookKeys).reverse();\r\n      }\r\n    }\r\n  }\r\n  static sortNotes(\r\n    notes: NoteModel[],\r\n    noteSortCode: { sort: number; order: number },\r\n    books: BookModel[] = []\r\n  ) {\r\n    if (noteSortCode.sort === 2) {\r\n      //使书摘从晚到早排序\r\n      let noteArr = _.clone(notes).reverse();\r\n      let dateArr = _.uniq(\r\n        notes.map(\r\n          (item) =>\r\n            \"\" + item.date.year + \"-\" + item.date.month + \"-\" + item.date.day\r\n        )\r\n      );\r\n      if (noteSortCode.order === 2) {\r\n        dateArr.sort();\r\n      } else {\r\n        dateArr.sort().reverse();\r\n      }\r\n      //得到以日期为键，书摘为值的对象\r\n      let noteObj: { [key: string]: any } = {};\r\n      dateArr.forEach((date) => {\r\n        noteObj[date] = [];\r\n      });\r\n      noteArr.forEach((note) => {\r\n        dateArr.forEach((date) => {\r\n          if (\r\n            date ===\r\n            \"\" + note.date.year + \"-\" + note.date.month + \"-\" + note.date.day\r\n          ) {\r\n            noteObj[date].push(note);\r\n          }\r\n        });\r\n      });\r\n      return noteObj || {};\r\n    }\r\n    if (noteSortCode.sort === 1) {\r\n      //使书摘从晚到早排序\r\n      let noteArr = _.clone(notes).reverse();\r\n      let nameArr = _.uniq(\r\n        notes.map(\r\n          (item) =>\r\n            books[\r\n              _.findLastIndex(books, {\r\n                key: item.bookKey,\r\n              })\r\n            ].name\r\n        )\r\n      );\r\n      if (noteSortCode.order === 2) {\r\n        nameArr.sort();\r\n      } else {\r\n        nameArr.sort().reverse();\r\n      }\r\n      //得到以日期为键，书摘为值的对象\r\n      let noteObj: { [key: string]: any } = {};\r\n      nameArr.forEach((name) => {\r\n        noteObj[name] = [];\r\n      });\r\n      noteArr.forEach((note) => {\r\n        nameArr.forEach((name) => {\r\n          if (\r\n            name ===\r\n            books[\r\n              _.findLastIndex(books, {\r\n                key: note.bookKey,\r\n              })\r\n            ].name\r\n          ) {\r\n            noteObj[name].push(note);\r\n          }\r\n        });\r\n      });\r\n      return noteObj || {};\r\n    }\r\n  }\r\n  static setBookSortCode(sortCode: number, orderCode: number) {\r\n    let json =\r\n      localStorage.getItem(\"bookSortCode\") ||\r\n      JSON.stringify({ sort: 0, order: 1 });\r\n    let obj = json ? JSON.parse(json) : { sort: 0, order: 1 };\r\n    obj.sort = sortCode;\r\n    obj.order = orderCode;\r\n    localStorage.setItem(\"bookSortCode\", JSON.stringify(obj));\r\n  }\r\n\r\n  static getBookSortCode() {\r\n    let json =\r\n      localStorage.getItem(\"bookSortCode\") ||\r\n      JSON.stringify({ sort: 0, order: 1 });\r\n    let obj = JSON.parse(json) || { sort: 0, order: 1 };\r\n    return obj || null;\r\n  }\r\n  static setNoteSortCode(sort: number, order: number) {\r\n    let json =\r\n      localStorage.getItem(\"noteSortCode\") ||\r\n      JSON.stringify({ sort: 2, order: 1 });\r\n    let obj = json ? JSON.parse(json) : { sort: 2, order: 1 };\r\n    obj.sort = sort;\r\n    obj.order = order;\r\n    localStorage.setItem(\"noteSortCode\", JSON.stringify(obj));\r\n  }\r\n\r\n  static getNoteSortCode() {\r\n    let json =\r\n      localStorage.getItem(\"noteSortCode\") ||\r\n      JSON.stringify({ sort: 2, order: 1 });\r\n    let obj = JSON.parse(json) || { sort: 2, order: 1 };\r\n    return obj || null;\r\n  }\r\n}\r\n\r\nexport default SortUtil;\r\n","import { isElectron } from \"react-device-detect\";\r\nimport StorageUtil from \"./storageUtil\";\r\n\r\nexport const openExternalUrl = (url: string) => {\r\n  isElectron\r\n    ? StorageUtil.getReaderConfig(\"isUseBuiltIn\") === \"yes\"\r\n      ? window.open(url)\r\n      : window.require(\"electron\").shell.openExternal(url)\r\n    : window.open(url);\r\n};\r\n","import BookModel from \"../../model/Book\";\r\nimport localforage from \"localforage\";\r\nimport BookUtil from \"../fileUtils/bookUtil\";\r\nimport NoteModel from \"../../model/Note\";\r\nimport BookmarkModel from \"../../model/Bookmark\";\r\nimport { isElectron } from \"react-device-detect\";\r\n\r\nlet JSZip = (window as any).JSZip;\r\nlet configArr = [\r\n  \"notes\",\r\n  \"books\",\r\n  \"bookmarks\",\r\n  \"readerConfig\",\r\n  \"noteTags\",\r\n  \"themeColors\",\r\n  \"bookSortCode\",\r\n  \"noteSortCode\",\r\n  \"readingTime\",\r\n  \"recentBooks\",\r\n  \"favoriteBooks\",\r\n  \"favoriteBooks\",\r\n  \"shelfList\",\r\n  \"pdfjs.history\",\r\n  \"recordLocation\",\r\n];\r\nexport function getParamsFromUrl() {\r\n  var hashParams: any = {};\r\n  var e,\r\n    r = /([^&;=]+)=?([^&;]*)/g,\r\n    q =\r\n      window.location.hash.substring(2) ||\r\n      window.location.search.substring(1).split(\"#\")[0];\r\n\r\n  while ((e = r.exec(q))) {\r\n    hashParams[e[1]] = decodeURIComponent(e[2]);\r\n  }\r\n  return hashParams;\r\n}\r\n//移动文件到指定路径\r\nexport const moveData = (\r\n  blob,\r\n  driveIndex,\r\n  books: BookModel[] = [],\r\n  handleFinish: () => void = () => {}\r\n) => {\r\n  let file = new File([blob], \"config.zip\", {\r\n    lastModified: new Date().getTime(),\r\n    type: blob.type,\r\n  });\r\n  const fs = window.require(\"fs\");\r\n  const path = window.require(\"path\");\r\n  const AdmZip = window.require(\"adm-zip\");\r\n\r\n  const { ipcRenderer } = window.require(\"electron\");\r\n  const dirPath = ipcRenderer.sendSync(\"user-data\", \"ping\");\r\n  const dataPath = localStorage.getItem(\"storageLocation\")\r\n    ? localStorage.getItem(\"storageLocation\")\r\n    : window\r\n        .require(\"electron\")\r\n        .ipcRenderer.sendSync(\"storage-location\", \"ping\");\r\n  var reader = new FileReader();\r\n  reader.readAsArrayBuffer(file);\r\n  reader.onload = async (event) => {\r\n    if (!event.target) return;\r\n    fs.writeFileSync(\r\n      path.join(dirPath, file.name),\r\n      Buffer.from(event.target.result as any)\r\n    );\r\n    var zip = new AdmZip(path.join(dirPath, file.name));\r\n    zip.extractAllTo(/*target path*/ dataPath, /*overwrite*/ true);\r\n    const fs_extra = window.require(\"fs-extra\");\r\n    fs_extra.copy(\r\n      path.join(dirPath, file.name),\r\n      path.join(dataPath, file.name),\r\n      function (err) {\r\n        if (err) return;\r\n      }\r\n    );\r\n    if (driveIndex === 4) {\r\n      let deleteBooks = books.map((item) => {\r\n        return localforage.removeItem(item.key);\r\n      });\r\n      await Promise.all(deleteBooks);\r\n    }\r\n    if (driveIndex === 5) {\r\n      handleFinish();\r\n    }\r\n  };\r\n};\r\n//改变数据存储路径\r\nexport const changePath = (oldPath: string, newPath: string) => {\r\n  return new Promise<number>((resolve, reject) => {\r\n    const fs = window.require(\"fs-extra\");\r\n    try {\r\n      fs.readdir(newPath, (err, files: string[]) => {\r\n        let isConfiged: boolean = false;\r\n        files.forEach((file: string) => {\r\n          if (file === \"config.zip\") {\r\n            isConfiged = true;\r\n          }\r\n        });\r\n        if (isConfiged) {\r\n          localStorage.setItem(\"storageLocation\", newPath);\r\n          resolve(1);\r\n        } else {\r\n          fs.copy(oldPath, newPath, function (err) {\r\n            if (err) return;\r\n            fs.emptyDirSync(oldPath);\r\n            resolve(2);\r\n          });\r\n        }\r\n      });\r\n    } catch (error) {\r\n      console.log(error);\r\n      resolve(0);\r\n    }\r\n  });\r\n};\r\nexport const syncData = (blob: Blob, books: BookModel[] = [], isSync: true) => {\r\n  return new Promise<boolean>((resolve, reject) => {\r\n    let file = new File([blob], \"config.zip\", {\r\n      lastModified: new Date().getTime(),\r\n      type: blob.type,\r\n    });\r\n    const fs = window.require(\"fs\");\r\n    const path = window.require(\"path\");\r\n    const AdmZip = window.require(\"adm-zip\");\r\n    const dataPath = localStorage.getItem(\"storageLocation\")\r\n      ? localStorage.getItem(\"storageLocation\")\r\n      : window\r\n          .require(\"electron\")\r\n          .ipcRenderer.sendSync(\"storage-location\", \"ping\");\r\n    var reader = new FileReader();\r\n    reader.readAsArrayBuffer(file);\r\n    reader.onload = async (event) => {\r\n      if (!event.target) return;\r\n      fs.writeFileSync(\r\n        path.join(dataPath, file.name),\r\n        Buffer.from(event.target.result as any)\r\n      );\r\n      var zip = new AdmZip(path.join(dataPath, file.name));\r\n      zip.extractAllTo(/*target path*/ dataPath, /*overwrite*/ true);\r\n\r\n      if (!isSync) {\r\n        let deleteBooks = books.map((item) => {\r\n          return localforage.removeItem(item.key);\r\n        });\r\n        await Promise.all(deleteBooks);\r\n        resolve(true);\r\n      } else {\r\n        resolve(true);\r\n      }\r\n    };\r\n  });\r\n};\r\n\r\nexport const zipBook = (zip: any, books: BookModel[]) => {\r\n  return new Promise<boolean>(async (resolve, reject) => {\r\n    let bookZip = zip.folder(\"book\");\r\n    let data: any = [];\r\n    books &&\r\n      books.forEach((item) => {\r\n        data.push(\r\n          !isElectron\r\n            ? localforage.getItem(item.key)\r\n            : BookUtil.fetchBook(item.key, false, item.path)\r\n        );\r\n      });\r\n    try {\r\n      let results = await Promise.all(data);\r\n      for (let i = 0; i < books.length; i++) {\r\n        results[i] && bookZip.file(`${books[i].key}`, results[i]);\r\n      }\r\n      resolve(true);\r\n    } catch (error) {\r\n      resolve(false);\r\n    }\r\n  });\r\n};\r\n\r\nexport const unzipConfig = (file: File) => {\r\n  return new Promise<boolean>((resolve, reject) => {\r\n    let zip = new JSZip();\r\n    let count = 0;\r\n    configArr.forEach((item) => {\r\n      zip\r\n        .loadAsync(file)\r\n        .then((content: any) => {\r\n          return content.files[\r\n            content.files[`${item}.json`]\r\n              ? `${item}.json`\r\n              : `config/${item}.json`\r\n          ].async(\"text\");\r\n        })\r\n        .then(async (text: any) => {\r\n          if (text) {\r\n            if (item === \"notes\" || item === \"books\" || item === \"bookmarks\") {\r\n              localforage.setItem(item, JSON.parse(text));\r\n            } else {\r\n              localStorage.setItem(item, text);\r\n            }\r\n          }\r\n          count++;\r\n          if (count === configArr.length) {\r\n            resolve(true);\r\n          }\r\n        })\r\n        .catch((err: any) => {\r\n          reject(false);\r\n          console.log(err, \"Error happen\");\r\n        });\r\n    });\r\n  });\r\n};\r\n\r\nexport const unzipBook = (file: File) => {\r\n  return new Promise<boolean>((resolve, reject) => {\r\n    localforage.getItem(\"books\").then((value: any) => {\r\n      let zip = new JSZip();\r\n      let count = 0;\r\n      value &&\r\n        value.length > 0 &&\r\n        value.forEach((item: any) => {\r\n          zip\r\n            .loadAsync(file)\r\n            .then((content: any) => {\r\n              if (content.files[`book/${item.key}`]) {\r\n                return content.files[`book/${item.key}`].async(\"arraybuffer\");\r\n              } else if (content.files[`${item.key}`]) {\r\n                return content.files[`${item.key}`].async(\"arraybuffer\");\r\n              }\r\n              if (\r\n                content.files[`book/${item.name}.pdf`] &&\r\n                item.description === \"pdf\"\r\n              ) {\r\n                //兼容之前的版本\r\n                return content.files[`book/${item.name}.pdf`].async(\r\n                  \"arraybuffer\"\r\n                ); // a promise of \"Hello World\\n\"\r\n              } else if (content.files[`book/${item.name}.epub`]) {\r\n                return content.files[`book/${item.name}.epub`].async(\r\n                  \"arraybuffer\"\r\n                ); // a promise of \"Hello World\\n\"\r\n              }\r\n            })\r\n            .then(async (book: ArrayBuffer) => {\r\n              await BookUtil.addBook(item.key, book);\r\n              count++;\r\n              if (count === value.length) {\r\n                resolve(true);\r\n              }\r\n            })\r\n            .catch((err: any) => {\r\n              resolve(false);\r\n            });\r\n        });\r\n    });\r\n  });\r\n};\r\n\r\nexport const zipConfig = (\r\n  zip: any,\r\n  books: BookModel[],\r\n  notes: NoteModel[],\r\n  bookmarks: BookmarkModel[]\r\n) => {\r\n  return new Promise<boolean>((resolve, reject) => {\r\n    try {\r\n      let configZip = zip.folder(\"config\");\r\n      configZip\r\n        .file(\"notes.json\", JSON.stringify(notes))\r\n        .file(\"books.json\", JSON.stringify(books))\r\n        .file(\"bookmarks.json\", JSON.stringify(bookmarks))\r\n        .file(\"readerConfig.json\", localStorage.getItem(\"readerConfig\") || \"\")\r\n        .file(\"themeColors.json\", localStorage.getItem(\"themeColors\") || \"\")\r\n        .file(\r\n          \"bookSortCode.json\",\r\n          localStorage.getItem(\"bookSortCode\") ||\r\n            JSON.stringify({ sort: 0, order: 2 })\r\n        )\r\n        .file(\r\n          \"noteSortCode.json\",\r\n          localStorage.getItem(\"noteSortCode\") ||\r\n            JSON.stringify({ sort: 2, order: 2 })\r\n        )\r\n        .file(\"readingTime.json\", localStorage.getItem(\"readingTime\") || \"\")\r\n        .file(\"recentBooks.json\", localStorage.getItem(\"recentBooks\") || [])\r\n        .file(\"deletedBooks.json\", localStorage.getItem(\"deletedBooks\") || [])\r\n        .file(\"favoriteBooks.json\", localStorage.getItem(\"favoriteBooks\") || [])\r\n        .file(\"shelfList.json\", localStorage.getItem(\"shelfList\") || [])\r\n        .file(\"noteTags.json\", localStorage.getItem(\"noteTags\") || [])\r\n        .file(\"pdfjs.history.json\", localStorage.getItem(\"pdfjs.history\") || [])\r\n        .file(\r\n          \"recordLocation.json\",\r\n          localStorage.getItem(\"recordLocation\") || \"\"\r\n        );\r\n      resolve(true);\r\n    } catch (error) {\r\n      resolve(false);\r\n    }\r\n  });\r\n};\r\n","import i18n from \"i18next\";\r\nimport { initReactI18next } from \"react-i18next\";\r\nimport translationEN from \"./assets/locales/en/translation.json\";\r\nimport translationCN from \"./assets/locales/cn/translation.json\";\r\nimport translationTW from \"./assets/locales/tw/translation.json\";\r\nimport translationJP from \"./assets/locales/jp/translation.json\";\r\nimport translationRU from \"./assets/locales/ru/translation.json\";\r\nimport translationFR from \"./assets/locales/fr/translation.json\";\r\nimport translationES from \"./assets/locales/es/translation.json\";\r\nimport translationFA from \"./assets/locales/fa/translation.json\";\r\nimport translationPTBR from \"./assets/locales/pt-BR/translation.json\";\r\n\r\n// the translations\r\nconst resources = {\r\n  en: {\r\n    translation: translationEN,\r\n  },\r\n  zh: {\r\n    translation: translationCN,\r\n  },\r\n  cht: {\r\n    translation: translationTW,\r\n  },\r\n  jp: {\r\n    translation: translationJP,\r\n  },\r\n  ru: {\r\n    translation: translationRU,\r\n  },\r\n  es: {\r\n    translation: translationES,\r\n  },\r\n  fr: {\r\n    translation: translationFR,\r\n  },\r\n  fa: {\r\n    translation: translationFA,\r\n  },\r\n  ptBR: {\r\n    translation: translationPTBR,\r\n  },\r\n};\r\n\r\ni18n\r\n  .use(initReactI18next) // passes i18n down to react-i18next\r\n  .init({\r\n    resources,\r\n    lng: \"en\",\r\n    fallbackLng: \"en\",\r\n    keySeparator: false, // we do not use keys in form messages.welcome\r\n    interpolation: {\r\n      escapeValue: false, // react already safes from xss\r\n    },\r\n  });\r\n\r\nexport default i18n;\r\n","const initState = {\r\n  isOpenEditDialog: false,\r\n  isOpenDeleteDialog: false,\r\n  isOpenAddDialog: false,\r\n  isOpenActionDialog: false,\r\n  isReading: false,\r\n  dragItem: \"\",\r\n  currentBook: {},\r\n  renderFunc: () => {},\r\n};\r\nexport function book(\r\n  state = initState,\r\n  action: { type: string; payload: any }\r\n) {\r\n  switch (action.type) {\r\n    case \"HANDLE_EDIT_DIALOG\":\r\n      return {\r\n        ...state,\r\n        isOpenEditDialog: action.payload,\r\n      };\r\n    case \"HANDLE_DELETE_DIALOG\":\r\n      return {\r\n        ...state,\r\n        isOpenDeleteDialog: action.payload,\r\n      };\r\n    case \"HANDLE_RENDER_FUNC\":\r\n      return {\r\n        ...state,\r\n        renderFunc: action.payload,\r\n      };\r\n    case \"HANDLE_ADD_DIALOG\":\r\n      return {\r\n        ...state,\r\n        isOpenAddDialog: action.payload,\r\n      };\r\n    case \"HANDLE_ACTION_DIALOG\":\r\n      return {\r\n        ...state,\r\n        isOpenActionDialog: action.payload,\r\n      };\r\n    case \"HANDLE_READING_STATE\":\r\n      return {\r\n        ...state,\r\n        isReading: action.payload,\r\n      };\r\n    case \"HANDLE_READING_BOOK\":\r\n      return {\r\n        ...state,\r\n        currentBook: action.payload,\r\n      };\r\n    case \"HANDLE_DRAG_ITEM\":\r\n      return {\r\n        ...state,\r\n        dragItem: action.payload,\r\n      };\r\n    case \"HANDLE_REDIRECT\":\r\n      return {\r\n        ...state,\r\n        isRedirect: true,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","const initState = {\r\n  books: null,\r\n  deletedBooks: [],\r\n  searchResults: [],\r\n  isSearch: false,\r\n  isAboutOpen: false,\r\n  isBookSort: localStorage.getItem(\"bookSortCode\") ? true : false,\r\n  isNoteSort: false,\r\n  isSettingOpen: false,\r\n  viewMode: \"card\",\r\n  isSortDisplay: false,\r\n  isShowLoading: false,\r\n  isNewWarning: false,\r\n  isTipDialog: false,\r\n  isShowNew: false,\r\n  bookSortCode: { sort: 0, order: 1 },\r\n  noteSortCode: { sort: 2, order: 1 },\r\n  isSelectBook: false,\r\n  message: \"Add Successfully\",\r\n  tip: \"\",\r\n  selectedBooks: [],\r\n};\r\nexport function manager(\r\n  state = initState,\r\n  action: { type: string; payload: any }\r\n) {\r\n  switch (action.type) {\r\n    case \"HANDLE_BOOKS\":\r\n      return {\r\n        ...state,\r\n        books: action.payload,\r\n      };\r\n    case \"HANDLE_DELETED_BOOKS\":\r\n      return {\r\n        ...state,\r\n        deletedBooks: action.payload,\r\n      };\r\n    case \"HANDLE_SEARCH_BOOKS\":\r\n      return {\r\n        ...state,\r\n        searchResults: action.payload,\r\n      };\r\n    case \"HANDLE_SELECT_BOOK\":\r\n      return {\r\n        ...state,\r\n        isSelectBook: action.payload,\r\n      };\r\n    case \"HANDLE_SELECTED_BOOKS\":\r\n      return {\r\n        ...state,\r\n        selectedBooks: action.payload,\r\n      };\r\n    case \"HANDLE_TIP_DIALOG\":\r\n      return {\r\n        ...state,\r\n        isTipDialog: action.payload,\r\n      };\r\n    case \"HANDLE_TIP\":\r\n      return {\r\n        ...state,\r\n        tip: action.payload,\r\n      };\r\n    case \"HANDLE_SEARCH\":\r\n      return {\r\n        ...state,\r\n        isSearch: action.payload,\r\n      };\r\n\r\n    case \"HANDLE_SETTING\":\r\n      return {\r\n        ...state,\r\n        isSettingOpen: action.payload,\r\n      };\r\n    case \"HANDLE_ABOUT\":\r\n      return {\r\n        ...state,\r\n        isAboutOpen: action.payload,\r\n      };\r\n    case \"HANDLE_BOOK_SORT\":\r\n      return {\r\n        ...state,\r\n        isBookSort: action.payload,\r\n      };\r\n    case \"HANDLE_NOTE_SORT\":\r\n      return {\r\n        ...state,\r\n        isNoteSort: action.payload,\r\n      };\r\n\r\n    case \"HANDLE_VIEW_MODE\":\r\n      return {\r\n        ...state,\r\n        viewMode: action.payload,\r\n      };\r\n    case \"HANDLE_SORT_DISPLAY\":\r\n      return {\r\n        ...state,\r\n        isSortDisplay: action.payload,\r\n      };\r\n    case \"HANDLE_SHOW_LOADING\":\r\n      return {\r\n        ...state,\r\n        isShowLoading: action.payload,\r\n      };\r\n    case \"HANDLE_SHOW_NEW\":\r\n      return {\r\n        ...state,\r\n        isShowNew: action.payload,\r\n      };\r\n    case \"HANDLE_NEW_WARNING\":\r\n      return {\r\n        ...state,\r\n        isNewWarning: action.payload,\r\n      };\r\n\r\n    case \"HANDLE_SORT_CODE\":\r\n      return {\r\n        ...state,\r\n        bookSortCode: {\r\n          sort: action.payload.sort,\r\n          order: action.payload.order,\r\n        },\r\n      };\r\n    case \"HANDLE_NOTE_SORT_CODE\":\r\n      return {\r\n        ...state,\r\n        noteSortCode: {\r\n          sort: action.payload.sort,\r\n          order: action.payload.order,\r\n        },\r\n      };\r\n    case \"HANDLE_NOTES\":\r\n      return {\r\n        ...state,\r\n        notes: action.payload,\r\n      };\r\n    case \"HANDLE_BOOKMARKS\":\r\n      return {\r\n        ...state,\r\n        bookmarks: action.payload,\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","const initState = {\r\n  percentage: null,\r\n  locations: null,\r\n};\r\nexport function progressPanel(\r\n  state = initState,\r\n  action: { type: string; payload: any }\r\n) {\r\n  switch (action.type) {\r\n    case \"HANDLE_PERCENTAGE\":\r\n      return {\r\n        ...state,\r\n        percentage: action.payload,\r\n      };\r\n\r\n    case \"HANDLE_SECTION\":\r\n      return {\r\n        ...state,\r\n        section: action.payload,\r\n      };\r\n    case \"HANDLE_LOCATIONS\":\r\n      return {\r\n        ...state,\r\n        locations: action.payload,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","import StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\nconst initState = {\r\n  bookmarks: [],\r\n  notes: [],\r\n  digests: [],\r\n  chapters: null,\r\n  currentChapter: \"\",\r\n\r\n  color: parseInt(StorageUtil.getReaderConfig(\"highlightIndex\"))\r\n    ? parseInt(StorageUtil.getReaderConfig(\"highlightIndex\"))\r\n    : StorageUtil.getReaderConfig(\"appSkin\") === \"night\" ||\r\n      (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\r\n        StorageUtil.getReaderConfig(\"isOSNight\") === \"yes\")\r\n    ? 3\r\n    : 0,\r\n  noteKey: \"\",\r\n  originalText: \"\",\r\n  htmlBook: null,\r\n  readerMode: StorageUtil.getReaderConfig(\"readerMode\") || \"double\",\r\n};\r\nexport function reader(\r\n  state = initState,\r\n  action: { type: string; payload: any }\r\n) {\r\n  switch (action.type) {\r\n    case \"HANDLE_BOOKMARKS\":\r\n      return {\r\n        ...state,\r\n        bookmarks: action.payload,\r\n      };\r\n    case \"HANDLE_NOTES\":\r\n      return {\r\n        ...state,\r\n        notes: action.payload,\r\n      };\r\n    case \"HANDLE_CURRENT_CHAPTER\":\r\n      return {\r\n        ...state,\r\n        currentChapter: action.payload,\r\n      };\r\n    case \"HANDLE_ORIGINAL_TEXT\":\r\n      return {\r\n        ...state,\r\n        originalText: action.payload,\r\n      };\r\n    case \"HANDLE_HTML_BOOK\":\r\n      return {\r\n        ...state,\r\n        htmlBook: action.payload,\r\n      };\r\n    case \"HANDLE_COLOR\":\r\n      return {\r\n        ...state,\r\n        color: action.payload,\r\n      };\r\n\r\n    case \"HANDLE_NOTE_KEY\":\r\n      return {\r\n        ...state,\r\n        noteKey: action.payload,\r\n      };\r\n    case \"HANDLE_DIGESTS\":\r\n      return {\r\n        ...state,\r\n        digests: action.payload,\r\n      };\r\n    case \"HANDLE_SECTION\":\r\n      return {\r\n        ...state,\r\n        section: action.payload,\r\n      };\r\n    case \"HANDLE_CHAPTERS\":\r\n      return {\r\n        ...state,\r\n        chapters: action.payload,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","const initState = {\r\n  selection: null,\r\n  isOpenMenu: false,\r\n  menuMode: \"menu\",\r\n  isChangeDirection: false,\r\n  isShowBookmark: false,\r\n};\r\nexport function viewArea(\r\n  state = initState,\r\n  action: { type: string; payload: any }\r\n) {\r\n  switch (action.type) {\r\n    case \"HANDLE_OPEN_MENU\":\r\n      return {\r\n        ...state,\r\n        isOpenMenu: action.payload,\r\n      };\r\n    case \"HANDLE_OPEN_HIGHLIGHT\":\r\n      return {\r\n        ...state,\r\n        isOpenHighlight: action.payload,\r\n      };\r\n\r\n    case \"HANDLE_SHOW_BOOKMARK\":\r\n      return {\r\n        ...state,\r\n        isShowBookmark: action.payload,\r\n      };\r\n    case \"HANDLE_SELECTION\":\r\n      return {\r\n        ...state,\r\n        selection: action.payload,\r\n      };\r\n    case \"HANDLE_DIALOG_LOCATION\":\r\n      return {\r\n        ...state,\r\n        dialogLocation: action.payload,\r\n      };\r\n    case \"HANDLE_MENU_MODE\":\r\n      return {\r\n        ...state,\r\n        menuMode: action.payload,\r\n      };\r\n    case \"HANDLE_CHANGE_DIRECTION\":\r\n      return {\r\n        ...state,\r\n        isChangeDirection: action.payload,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","import StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\nconst initState = {\r\n  mode: \"home\",\r\n  shelfIndex: -1,\r\n  isCollapsed: StorageUtil.getReaderConfig(\"isCollapsed\") === \"yes\",\r\n};\r\nexport function sidebar(\r\n  state = initState,\r\n  action: { type: string; payload: any }\r\n) {\r\n  switch (action.type) {\r\n    case \"HANDLE_MODE\":\r\n      return {\r\n        ...state,\r\n        mode: action.payload,\r\n      };\r\n    case \"HANDLE_SHELF_INDEX\":\r\n      return {\r\n        ...state,\r\n        shelfIndex: action.payload,\r\n      };\r\n    case \"HANDLE_COLLAPSE\":\r\n      return {\r\n        ...state,\r\n        isCollapsed: action.payload,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","const initState = {\r\n  isBackup: false,\r\n  isOpenTokenDialog: false,\r\n};\r\nexport function backupPage(\r\n  state = initState,\r\n  action: { type: string; payload: boolean }\r\n) {\r\n  switch (action.type) {\r\n    case \"HANDLE_BACKUP\":\r\n      return {\r\n        ...state,\r\n        isBackup: action.payload,\r\n      };\r\n    case \"HANDLE_TOKEN_DIALOG\":\r\n      return {\r\n        ...state,\r\n        isOpenTokenDialog: action.payload,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","import { createStore, applyMiddleware, compose, combineReducers } from \"redux\";\r\nimport thunk from \"redux-thunk\";\r\nimport { book } from \"./reducers/book\";\r\nimport { manager } from \"./reducers/manager\";\r\nimport { progressPanel } from \"./reducers/progressPanel\";\r\nimport { reader } from \"./reducers/reader\";\r\nimport { viewArea } from \"./reducers/viewArea\";\r\nimport { sidebar } from \"./reducers/sidebar\";\r\nimport { backupPage } from \"./reducers/backupPage\";\r\nimport BookModel from \"../model/Book\";\r\nimport NoteModel from \"../model/Note\";\r\nimport BookmarkModel from \"../model/Bookmark\";\r\nimport HtmlBookModel from \"../model/HtmlBook\";\r\nconst rootReducer = combineReducers({\r\n  book,\r\n  manager,\r\n  reader,\r\n  progressPanel,\r\n  viewArea,\r\n  sidebar,\r\n  backupPage,\r\n});\r\nconst store = createStore(\r\n  rootReducer,\r\n  compose(\r\n    applyMiddleware(thunk),\r\n    (window as any).devToolsExtension\r\n      ? (window as any).devToolsExtension()\r\n      : (f: any) => f\r\n  )\r\n);\r\nexport default store;\r\nexport type stateType = {\r\n  manager: {\r\n    books: BookModel[];\r\n    deletedBooks: BookModel[];\r\n    searchResults: number[];\r\n    isSearch: boolean;\r\n    isBookSort: boolean;\r\n    isSettingOpen: boolean;\r\n    viewMode: string;\r\n    isSortDisplay: boolean;\r\n    isAboutOpen: boolean;\r\n    isShowLoading: boolean;\r\n    isShowNew: boolean;\r\n    isNewWarning: boolean;\r\n    isSelectBook: boolean;\r\n    selectedBooks: string[];\r\n    isTipDialog: boolean;\r\n    bookSortCode: { sort: number; order: number };\r\n    noteSortCode: { sort: number; order: number };\r\n    tip: string;\r\n  };\r\n  book: {\r\n    isOpenEditDialog: boolean;\r\n    isOpenDeleteDialog: boolean;\r\n    isOpenAddDialog: boolean;\r\n    isOpenActionDialog: boolean;\r\n    isReading: boolean;\r\n    dragItem: string;\r\n    currentBook: BookModel;\r\n    renderFunc: () => void;\r\n  };\r\n  backupPage: {\r\n    isBackup: boolean;\r\n    isOpenTokenDialog: boolean;\r\n  };\r\n  progressPanel: {\r\n    percentage: number;\r\n    locations: any[];\r\n  };\r\n  reader: {\r\n    bookmarks: BookmarkModel[];\r\n    notes: NoteModel[];\r\n    digests: NoteModel[];\r\n    color: number;\r\n    chapters: any[];\r\n    noteKey: string;\r\n    currentChapter: string;\r\n    originalText: string;\r\n    htmlBook: HtmlBookModel;\r\n  };\r\n  sidebar: {\r\n    mode: string;\r\n    shelfIndex: number;\r\n    isCollapsed: boolean;\r\n  };\r\n  viewArea: {\r\n    selection: string;\r\n    menuMode: string;\r\n    isOpenMenu: boolean;\r\n    isChangeDirection: boolean;\r\n    isShowBookmark: boolean;\r\n  };\r\n};\r\n","export const sideMenu = [\r\n  {\r\n    name: \"Books\",\r\n    icon: \"home\",\r\n    mode: \"home\",\r\n  },\r\n  {\r\n    name: \"Favorites\",\r\n    icon: \"love\",\r\n    mode: \"favorite\",\r\n  },\r\n\r\n  {\r\n    name: \"Notes\",\r\n    icon: \"idea\",\r\n    mode: \"note\",\r\n  },\r\n  {\r\n    name: \"Highlights\",\r\n    icon: \"digest\",\r\n    mode: \"digest\",\r\n  },\r\n  {\r\n    name: \"Deleted Books\",\r\n    icon: \"trash\",\r\n    mode: \"trash\",\r\n  },\r\n];\r\n","import React from \"react\";\r\nimport \"./sidebar.css\";\r\nimport { sideMenu } from \"../../constants/sideMenu\";\r\nimport { SidebarProps, SidebarState } from \"./interface\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\nimport { Tooltip } from \"react-tippy\";\r\nimport { openExternalUrl } from \"../../utils/serviceUtils/urlUtil\";\r\n\r\nclass Sidebar extends React.Component<SidebarProps, SidebarState> {\r\n  constructor(props: SidebarProps) {\r\n    super(props);\r\n    this.state = {\r\n      index: 0,\r\n      hoverIndex: -1,\r\n      isCollapsed:\r\n        StorageUtil.getReaderConfig(\"isCollapsed\") === \"yes\" || false,\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    this.props.handleMode(\r\n      document.URL.split(\"/\").reverse()[0] === \"empty\"\r\n        ? \"home\"\r\n        : document.URL.split(\"/\").reverse()[0]\r\n    );\r\n  }\r\n  handleSidebar = (mode: string, index: number) => {\r\n    this.setState({ index: index });\r\n    this.props.handleSelectBook(false);\r\n    this.props.history.push(`/manager/${mode}`);\r\n    this.props.handleMode(mode);\r\n    this.props.handleShelfIndex(-1);\r\n    this.props.handleSearch(false);\r\n    this.props.handleSortDisplay(false);\r\n  };\r\n  handleHover = (index: number) => {\r\n    this.setState({ hoverIndex: index });\r\n  };\r\n  handleCollapse = (isCollapsed: boolean) => {\r\n    this.setState({ isCollapsed });\r\n    this.props.handleCollapse(isCollapsed);\r\n    StorageUtil.setReaderConfig(\"isCollapsed\", isCollapsed ? \"yes\" : \"no\");\r\n  };\r\n  handleJump = (url: string) => {\r\n    openExternalUrl(url);\r\n  };\r\n  render() {\r\n    const renderSideMenu = () => {\r\n      return sideMenu.map((item, index) => {\r\n        return (\r\n          <li\r\n            key={item.name}\r\n            className={\r\n              this.state.index === index\r\n                ? \"active side-menu-item\"\r\n                : \"side-menu-item\"\r\n            }\r\n            id={`sidebar-${item.icon}`}\r\n            onClick={() => {\r\n              this.handleSidebar(item.mode, index);\r\n            }}\r\n            onMouseEnter={() => {\r\n              this.handleHover(index);\r\n            }}\r\n            onMouseLeave={() => {\r\n              this.handleHover(-1);\r\n            }}\r\n            style={this.props.isCollapsed ? { width: 40, marginLeft: 15 } : {}}\r\n          >\r\n            {this.state.index === index ? (\r\n              <div className=\"side-menu-selector-container\"></div>\r\n            ) : null}\r\n            {this.state.hoverIndex === index ? (\r\n              <div className=\"side-menu-hover-container\"></div>\r\n            ) : null}\r\n            <div\r\n              className={\r\n                this.state.index === index\r\n                  ? \"side-menu-selector active-selector\"\r\n                  : \"side-menu-selector \"\r\n              }\r\n            >\r\n              <Tooltip\r\n                title={this.props.t(item.name)}\r\n                position=\"top\"\r\n                trigger=\"mouseenter\"\r\n              >\r\n                <div\r\n                  className=\"side-menu-icon\"\r\n                  style={this.props.isCollapsed ? {} : { marginLeft: \"38px\" }}\r\n                >\r\n                  <span\r\n                    className={\r\n                      this.state.index === index\r\n                        ? `icon-${item.icon}  active-icon`\r\n                        : `icon-${item.icon}`\r\n                    }\r\n                    style={\r\n                      this.props.isCollapsed ? { marginLeft: \"-25px\" } : {}\r\n                    }\r\n                  ></span>\r\n                </div>\r\n              </Tooltip>\r\n              <span style={this.props.isCollapsed ? { display: \"none\" } : {}}>\r\n                {this.props.t(item.name)}\r\n              </span>\r\n            </div>\r\n          </li>\r\n        );\r\n      });\r\n    };\r\n    return (\r\n      <div className=\"sidebar\">\r\n        <div\r\n          className=\"sidebar-list-icon\"\r\n          onClick={() => {\r\n            this.handleCollapse(!this.state.isCollapsed);\r\n          }}\r\n        >\r\n          <Tooltip\r\n            title={this.props.t(\r\n              this.props.isCollapsed ? \"Show sidebar\" : \"Collapse sidebar\"\r\n            )}\r\n            position=\"top\"\r\n            trigger=\"mouseenter\"\r\n            distance={25}\r\n          >\r\n            <span className=\"icon-menu sidebar-list\"></span>\r\n          </Tooltip>\r\n        </div>\r\n\r\n        <img\r\n          src={\r\n            StorageUtil.getReaderConfig(\"appSkin\") === \"night\" ||\r\n            (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\r\n              StorageUtil.getReaderConfig(\"isOSNight\") === \"yes\")\r\n              ? \"./assets/label_light.png\"\r\n              : \"./assets/label.png\"\r\n          }\r\n          alt=\"\"\r\n          onClick={() => {\r\n            this.handleJump(\"https://koodo.960960.xyz\");\r\n          }}\r\n          className=\"logo\"\r\n        />\r\n        <div className=\"side-menu-container-parent\">\r\n          <ul className=\"side-menu-container\">{renderSideMenu()}</ul>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(Sidebar);\r\n","import {\r\n  handleMode,\r\n  handleSearch,\r\n  handleSortDisplay,\r\n  handleCollapse,\r\n  handleSelectBook,\r\n  handleShelfIndex,\r\n} from \"../../store/actions\";\r\nimport { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport Sidebar from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return { mode: state.sidebar.mode, isCollapsed: state.sidebar.isCollapsed };\r\n};\r\nconst actionCreator = {\r\n  handleMode,\r\n  handleSearch,\r\n  handleSortDisplay,\r\n  handleCollapse,\r\n  handleSelectBook,\r\n  handleShelfIndex,\r\n};\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(Sidebar as any));\r\n","import BookModel from \"../../model/Book\";\r\nimport NoteModel from \"../../model/Note\";\r\nclass SearchUtil {\r\n  static MergeArray(arr1: number[], arr2: number[]) {\r\n    var _arr: number[] = [];\r\n    for (let item of arr1) {\r\n      _arr.push(item);\r\n    }\r\n    for (let item of arr2) {\r\n      var flag = true;\r\n      for (let subitem of arr1) {\r\n        if (item === subitem) {\r\n          flag = false;\r\n          break;\r\n        }\r\n      }\r\n      if (flag) {\r\n        _arr.push(item);\r\n      }\r\n    }\r\n    return _arr;\r\n  }\r\n  static fuzzyQuery(list: string[], keyWord: string) {\r\n    var arr: number[] = [];\r\n    for (var i = 0; i < list.length; i++) {\r\n      if (list[i].indexOf(keyWord) > -1) {\r\n        arr.push(i);\r\n      }\r\n    }\r\n    return arr;\r\n  }\r\n  static MouseSearch(books: BookModel[]) {\r\n    let keyword = (\r\n      document.querySelector(\".header-search-box\") as HTMLInputElement\r\n    ).value.toLowerCase();\r\n    let bookNameArr: string[] = [];\r\n    let AuthorNameArr: string[] = [];\r\n    if (!books) return [];\r\n    books.forEach((item) => {\r\n      bookNameArr.push(item.name.toLowerCase());\r\n      AuthorNameArr.push(item.author.toLowerCase());\r\n    });\r\n    let bookResults = this.fuzzyQuery(bookNameArr, keyword);\r\n    let authorResults = this.fuzzyQuery(AuthorNameArr, keyword);\r\n\r\n    return this.MergeArray(bookResults, authorResults);\r\n  }\r\n  static KeySearch(event: any, books: BookModel[]) {\r\n    if (event && event.keyCode === 13) {\r\n      let bookNameArr: string[] = [];\r\n      let AuthorNameArr: string[] = [];\r\n      if (!books) return [];\r\n\r\n      books.forEach((item) => {\r\n        bookNameArr.push(item.name.toLowerCase());\r\n        AuthorNameArr.push(item.author.toLowerCase());\r\n      });\r\n      let bookResults = this.fuzzyQuery(\r\n        bookNameArr,\r\n        event.target.value.toLowerCase()\r\n      );\r\n      let authorResults = this.fuzzyQuery(\r\n        AuthorNameArr,\r\n        event.target.value.toLowerCase()\r\n      );\r\n\r\n      return this.MergeArray(bookResults, authorResults);\r\n    }\r\n  }\r\n  static MouseNoteSearch(notes: NoteModel[]) {\r\n    let keyword = (\r\n      document.querySelector(\".header-search-box\") as HTMLInputElement\r\n    ).value.toLowerCase();\r\n    let noteArr: string[] = [];\r\n    let textArr: string[] = [];\r\n    notes.forEach((item: NoteModel) => {\r\n      noteArr.push(item.notes.toLowerCase());\r\n      textArr.push(item.text.toLowerCase());\r\n    });\r\n    let noteResults = this.fuzzyQuery(noteArr, keyword);\r\n    let textResults = this.fuzzyQuery(textArr, keyword);\r\n    return this.MergeArray(noteResults, textResults);\r\n  }\r\n  static KeyNoteSearch(event: any, notes: NoteModel[]) {\r\n    if (event && event.keyCode === 13) {\r\n      let noteArr: string[] = [];\r\n      let textArr: string[] = [];\r\n      notes.forEach((item: NoteModel) => {\r\n        noteArr.push(item.notes.toLowerCase());\r\n        textArr.push(item.text.toLowerCase());\r\n      });\r\n      let noteResults = this.fuzzyQuery(\r\n        noteArr,\r\n        event.target.value.toLowerCase()\r\n      );\r\n      let textResults = this.fuzzyQuery(\r\n        textArr,\r\n        event.target.value.toLowerCase()\r\n      );\r\n      return this.MergeArray(noteResults, textResults);\r\n    }\r\n  }\r\n}\r\nexport default SearchUtil;\r\n","//搜索框\r\nimport React from \"react\";\r\nimport \"./searchBox.css\";\r\nimport SearchUtil from \"../../utils/serviceUtils/searchUtil\";\r\nimport { SearchBoxProps } from \"./interface\";\r\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\n\r\nclass SearchBox extends React.Component<SearchBoxProps> {\r\n  componentDidMount() {\r\n    if (this.props.isNavSearch) {\r\n      let searchBox: any = document.querySelector(\".header-search-box\");\r\n      searchBox && searchBox.focus();\r\n    }\r\n  }\r\n  handleMouse = () => {\r\n    let value = (this.refs.searchBox as any).value;\r\n    if (this.props.isNavSearch) {\r\n      value && this.search(value);\r\n    }\r\n    if (this.props.mode === \"nav\") {\r\n      this.props.handleSearchState(true);\r\n    }\r\n    let results =\r\n      this.props.tabMode === \"note\"\r\n        ? SearchUtil.MouseNoteSearch(\r\n            this.props.notes.filter((item) => item.notes !== \"\")\r\n          )\r\n        : this.props.tabMode === \"digest\"\r\n        ? SearchUtil.MouseNoteSearch(this.props.digests)\r\n        : SearchUtil.MouseSearch(this.props.books);\r\n    if (results) {\r\n      this.props.handleSearchResults(results);\r\n      this.props.handleSearch(true);\r\n    }\r\n  };\r\n  handleKey = (event: any) => {\r\n    if (event.keyCode !== 13) {\r\n      return;\r\n    }\r\n    let value = (this.refs.searchBox as any).value.toLowerCase();\r\n    if (this.props.isNavSearch || this.props.isReading) {\r\n      value && this.search(value);\r\n    }\r\n    let results =\r\n      this.props.tabMode === \"note\"\r\n        ? SearchUtil.KeyNoteSearch(\r\n            event,\r\n            this.props.notes.filter((item) => item.notes !== \"\")\r\n          )\r\n        : this.props.tabMode === \"digest\"\r\n        ? SearchUtil.KeyNoteSearch(event, this.props.digests)\r\n        : SearchUtil.KeySearch(event, this.props.books);\r\n    if (results) {\r\n      this.props.handleSearchResults(results);\r\n      this.props.handleSearch(true);\r\n    }\r\n  };\r\n  search = async (q: string) => {\r\n    let searchList = await this.props.htmlBook.rendition.doSearch(q);\r\n\r\n    this.props.handleSearchList(\r\n      searchList.map((item: any) => {\r\n        item.excerpt = item.excerpt.replace(\r\n          q,\r\n          `<span class=\"content-search-text\">${q}</span>`\r\n        );\r\n        return item;\r\n      })\r\n    );\r\n  };\r\n\r\n  handleCancel = () => {\r\n    if (this.props.isNavSearch) {\r\n      this.props.handleSearchList(null);\r\n    }\r\n    this.props.handleSearch(false);\r\n    (document.querySelector(\".header-search-box\") as HTMLInputElement).value =\r\n      \"\";\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div style={{ position: \"relative\" }}>\r\n        <input\r\n          type=\"text\"\r\n          ref=\"searchBox\"\r\n          className=\"header-search-box\"\r\n          onKeyDown={(event) => {\r\n            this.handleKey(event);\r\n          }}\r\n          onFocus={() => {\r\n            this.props.mode === \"nav\" && this.props.handleSearchState(true);\r\n          }}\r\n          placeholder={\r\n            this.props.isNavSearch || this.props.mode === \"nav\"\r\n              ? this.props.t(\"Search in the book\")\r\n              : this.props.tabMode === \"note\"\r\n              ? this.props.t(\"Search my notes\")\r\n              : this.props.tabMode === \"digest\"\r\n              ? this.props.t(\"Search my highlights\")\r\n              : this.props.t(\"Search my library\")\r\n          }\r\n          style={\r\n            this.props.mode === \"nav\"\r\n              ? { width: this.props.width, height: this.props.height }\r\n              : { paddingRight: \"50px\" }\r\n          }\r\n          onCompositionStart={() => {\r\n            if (StorageUtil.getReaderConfig(\"isNavLocked\") === \"yes\") {\r\n              return;\r\n            } else {\r\n              StorageUtil.setReaderConfig(\"isTempLocked\", \"yes\");\r\n              StorageUtil.setReaderConfig(\"isNavLocked\", \"yes\");\r\n            }\r\n          }}\r\n          onCompositionEnd={() => {\r\n            if (StorageUtil.getReaderConfig(\"isTempLocked\") === \"yes\") {\r\n              StorageUtil.setReaderConfig(\"isNavLocked\", \"\");\r\n              StorageUtil.setReaderConfig(\"isTempLocked\", \"\");\r\n            }\r\n          }}\r\n        />\r\n        {this.props.isSearch ? (\r\n          <span\r\n            className=\"header-search-text\"\r\n            onClick={() => {\r\n              this.handleCancel();\r\n            }}\r\n            style={\r\n              this.props.mode === \"nav\" ? { right: \"-9px\", top: \"14px\" } : {}\r\n            }\r\n          >\r\n            <span className=\"icon-close\"></span>\r\n          </span>\r\n        ) : (\r\n          <span\r\n            className=\"icon-search header-search-icon\"\r\n            onClick={() => {\r\n              this.handleMouse();\r\n            }}\r\n            style={this.props.mode === \"nav\" ? { right: \"5px\" } : {}}\r\n          ></span>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default SearchBox;\r\n","import { connect } from \"react-redux\";\r\nimport { handleSearchResults, handleSearch } from \"../../store/actions\";\r\nimport { stateType } from \"../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport SearchBox from \"./component\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    notes: state.reader.notes,\r\n    htmlBook: state.reader.htmlBook,\r\n    digests: state.reader.digests,\r\n    isSearch: state.manager.isSearch,\r\n    isReading: state.book.isReading,\r\n    currentBook: state.book.currentBook,\r\n    tabMode: state.sidebar.mode,\r\n    shelfIndex: state.sidebar.shelfIndex,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleSearchResults,\r\n  handleSearch,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(SearchBox as any));\r\n","import SparkMD5 from \"spark-md5\";\r\n\r\ndeclare var window: any;\r\nvar pdfjsLib = window[\"pdfjs-dist/build/pdf\"];\r\nexport const fetchMD5 = (file: any) => {\r\n  return new Promise<string>((resolve, reject) => {\r\n    try {\r\n      if (file.name.indexOf(\".pdf\") > -1) {\r\n        let fileReader = new FileReader();\r\n        fileReader.readAsArrayBuffer(file);\r\n        fileReader.onload = (ev) => {\r\n          pdfjsLib\r\n            .getDocument({ data: (ev.target as any).result })\r\n            .promise.then((pdfDoc: any) => {\r\n              resolve(pdfDoc._pdfInfo.fingerprint);\r\n            })\r\n            .catch((err: any) => {\r\n              resolve(file.name + \"-\" + file.size);\r\n            });\r\n        };\r\n      } else {\r\n        var blobSlice =\r\n            (File as any).prototype.slice ||\r\n            (File as any).prototype.mozSlice ||\r\n            (File as any).prototype.webkitSlice,\r\n          chunkSize = 2097152, // 以每片2MB大小来逐次读取\r\n          chunks = Math.ceil(file.size / chunkSize),\r\n          currentChunk = 0,\r\n          spark = new SparkMD5(), //创建SparkMD5的实例\r\n          fileReader = new FileReader();\r\n        fileReader.onload = async (e) => {\r\n          if (!e.target) {\r\n            reject(\"\");\r\n\r\n            throw new Error();\r\n          }\r\n          spark.appendBinary(e.target.result as any); // append array buffer\r\n          currentChunk += 1;\r\n          if (currentChunk < chunks) {\r\n            loadNext();\r\n          } else {\r\n            resolve(spark.end());\r\n          }\r\n        };\r\n\r\n        const loadNext = () => {\r\n          var start = currentChunk * chunkSize,\r\n            end =\r\n              start + chunkSize >= file.size ? file.size : start + chunkSize;\r\n\r\n          fileReader.readAsBinaryString(blobSlice.call(file, start, end));\r\n        };\r\n\r\n        loadNext();\r\n      }\r\n    } catch (error) {\r\n      reject(\"\");\r\n    }\r\n  });\r\n};\r\n","export const fetchMD5FromPath = (filePath: string) => {\r\n  return new Promise<string>((resolve, reject) => {\r\n    var crypto = window.require(\"crypto\");\r\n    var fs = window.require(\"fs\");\r\n\r\n    var md5sum = crypto.createHash(\"md5\");\r\n    var s = fs.ReadStream(filePath);\r\n    s.on(\"data\", function (d) {\r\n      md5sum.update(d);\r\n    });\r\n\r\n    s.on(\"end\", () => {\r\n      resolve(md5sum.digest(\"hex\"));\r\n    });\r\n    s.on(\"error\", () => {\r\n      reject(\"\");\r\n    });\r\n  });\r\n};\r\nexport const fetchFileFromPath = (filePath: string) => {\r\n  return new Promise<File>((resolve, reject) => {\r\n    const fs = window.require(\"fs\");\r\n\r\n    fs.readFile(filePath, (err, data) => {\r\n      if (err) {\r\n        console.error(err);\r\n        return;\r\n      }\r\n      const file = new File(\r\n        [data],\r\n        window.navigator.platform.indexOf(\"Win\") > -1\r\n          ? filePath.split(\"\\\\\").reverse()[0]\r\n          : filePath.split(\"/\").reverse()[0],\r\n        {\r\n          lastModified: new Date().getTime(),\r\n        }\r\n      );\r\n      resolve(file);\r\n    });\r\n  });\r\n};\r\n","import React from \"react\";\r\nimport \"./importLocal.css\";\r\nimport BookModel from \"../../model/Book\";\r\nimport localforage from \"localforage\";\r\nimport { fetchMD5 } from \"../../utils/fileUtils/md5Util\";\r\nimport { Trans } from \"react-i18next\";\r\nimport Dropzone from \"react-dropzone\";\r\nimport { Tooltip } from \"react-tippy\";\r\nimport { ImportLocalProps, ImportLocalState } from \"./interface\";\r\nimport RecordRecent from \"../../utils/readUtils/recordRecent\";\r\nimport { isElectron } from \"react-device-detect\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport BookUtil from \"../../utils/fileUtils/bookUtil\";\r\nimport { fetchFileFromPath } from \"../../utils/fileUtils/fileUtil\";\r\nimport toast from \"react-hot-toast\";\r\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\ndeclare var window: any;\r\nlet clickFilePath = \"\";\r\n\r\nclass ImportLocal extends React.Component<ImportLocalProps, ImportLocalState> {\r\n  constructor(props: ImportLocalProps) {\r\n    super(props);\r\n    this.state = {\r\n      isOpenFile: false,\r\n      width: document.body.clientWidth,\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    if (isElectron) {\r\n      const { ipcRenderer } = window.require(\"electron\");\r\n      if (!localStorage.getItem(\"storageLocation\")) {\r\n        localStorage.setItem(\r\n          \"storageLocation\",\r\n          ipcRenderer.sendSync(\"storage-location\", \"ping\")\r\n        );\r\n      }\r\n\r\n      const filePath = ipcRenderer.sendSync(\"get-file-data\");\r\n      if (filePath && filePath !== \".\") {\r\n        this.handleFilePath(filePath);\r\n      }\r\n      window.addEventListener(\r\n        \"focus\",\r\n        (event) => {\r\n          const _filePath = ipcRenderer.sendSync(\"get-file-data\");\r\n          if (_filePath && _filePath !== \".\") {\r\n            this.handleFilePath(_filePath);\r\n          }\r\n        },\r\n        false\r\n      );\r\n    }\r\n    window.addEventListener(\"resize\", () => {\r\n      this.setState({ width: document.body.clientWidth });\r\n    });\r\n  }\r\n  handleFilePath = async (filePath: string) => {\r\n    clickFilePath = filePath;\r\n    let md5 = await fetchMD5(await fetchFileFromPath(filePath));\r\n    if ([...(this.props.books || []), ...this.props.deletedBooks].length > 0) {\r\n      let isRepeat = false;\r\n      let repeatBook: BookModel | null = null;\r\n      [...(this.props.books || []), ...this.props.deletedBooks].forEach(\r\n        (item) => {\r\n          if (item.md5 === md5) {\r\n            isRepeat = true;\r\n            repeatBook = item;\r\n          }\r\n        }\r\n      );\r\n      if (isRepeat && repeatBook) {\r\n        this.handleJump(repeatBook);\r\n        return;\r\n      }\r\n    }\r\n    const fileTemp = await fetchFileFromPath(filePath);\r\n\r\n    this.setState({ isOpenFile: true }, async () => {\r\n      await this.getMd5WithBrowser(fileTemp);\r\n    });\r\n  };\r\n  handleJump = (book: BookModel) => {\r\n    if (StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\") {\r\n      this.props.history.push(BookUtil.getBookUrl(book));\r\n      this.props.handleReadingBook(book);\r\n    } else {\r\n      localStorage.setItem(\"tempBook\", JSON.stringify(book));\r\n      BookUtil.RedirectBook(book);\r\n      this.props.history.push(\"/manager/home\");\r\n    }\r\n  };\r\n  handleAddBook = (book: BookModel, buffer: ArrayBuffer) => {\r\n    return new Promise<void>((resolve, reject) => {\r\n      if (this.state.isOpenFile) {\r\n        StorageUtil.getReaderConfig(\"isImportPath\") !== \"yes\" &&\r\n          StorageUtil.getReaderConfig(\"isPreventAdd\") !== \"yes\" &&\r\n          BookUtil.addBook(book.key, buffer);\r\n        if (StorageUtil.getReaderConfig(\"isPreventAdd\") === \"yes\") {\r\n          this.handleJump(book);\r\n          if (\r\n            StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\" &&\r\n            this.state.isOpenFile\r\n          ) {\r\n            this.setState({ isOpenFile: false });\r\n          }\r\n\r\n          resolve();\r\n          return;\r\n        }\r\n      } else {\r\n        StorageUtil.getReaderConfig(\"isImportPath\") !== \"yes\" &&\r\n          BookUtil.addBook(book.key, buffer);\r\n      }\r\n\r\n      let bookArr = [...(this.props.books || []), ...this.props.deletedBooks];\r\n      if (bookArr == null) {\r\n        bookArr = [];\r\n      }\r\n      bookArr.push(book);\r\n      this.props.handleReadingBook(book);\r\n      RecordRecent.setRecent(book.key);\r\n      localforage\r\n        .setItem(\"books\", bookArr)\r\n        .then(() => {\r\n          this.props.handleFetchBooks();\r\n\r\n          toast.success(this.props.t(\"Add Successfully\"));\r\n          setTimeout(() => {\r\n            this.state.isOpenFile && this.handleJump(book);\r\n            if (\r\n              StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\" &&\r\n              this.state.isOpenFile\r\n            ) {\r\n              this.setState({ isOpenFile: false });\r\n              return;\r\n            }\r\n            this.setState({ isOpenFile: false });\r\n            this.props.history.push(\"/manager/home\");\r\n          }, 100);\r\n          resolve();\r\n        })\r\n        .catch(() => {\r\n          reject();\r\n        });\r\n    });\r\n  };\r\n\r\n  //获取书籍md5\r\n  getMd5WithBrowser = async (file: any) => {\r\n    return new Promise<void>(async (resolve, reject) => {\r\n      const md5 = await fetchMD5(file);\r\n      if (!md5) {\r\n        toast.error(this.props.t(\"Import Failed\"));\r\n        reject();\r\n      } else {\r\n        await this.handleBook(file, md5);\r\n        resolve();\r\n      }\r\n    });\r\n  };\r\n\r\n  handleBook = (file: any, md5: string) => {\r\n    let extension = file.name.split(\".\").reverse()[0];\r\n    let bookName = file.name.substr(0, file.name.length - extension.length - 1);\r\n    let result: BookModel | Boolean;\r\n    return new Promise<void>((resolve, reject) => {\r\n      //md5重复不导入\r\n      let isRepeat = false;\r\n      if (\r\n        [...(this.props.books || []), ...this.props.deletedBooks].length > 0\r\n      ) {\r\n        [...(this.props.books || []), ...this.props.deletedBooks].forEach(\r\n          (item) => {\r\n            if (item.md5 === md5 && item.size === file.size) {\r\n              isRepeat = true;\r\n              toast.error(this.props.t(\"Duplicate Book\"));\r\n              resolve();\r\n            }\r\n          }\r\n        );\r\n      }\r\n      //解析图书，获取图书数据\r\n      if (!isRepeat) {\r\n        let reader = new FileReader();\r\n        reader.readAsArrayBuffer(file);\r\n\r\n        reader.onload = async (e) => {\r\n          if (!e.target) {\r\n            toast.error(this.props.t(\"Import Failed\"));\r\n            reject();\r\n            throw new Error();\r\n          }\r\n\r\n          let reader = new FileReader();\r\n          reader.onload = async (event) => {\r\n            const file_content = (event.target as any).result;\r\n            result = await BookUtil.generateBook(\r\n              bookName,\r\n              extension,\r\n              md5,\r\n              file.size,\r\n              file.path || clickFilePath,\r\n              file_content\r\n            );\r\n            clickFilePath = \"\";\r\n            if (!result) {\r\n              toast.error(\r\n                this.props.t(\r\n                  \"You may see this error when the book you're importing is not supported by Koodo Reader, try converting it with Calibre\"\r\n                )\r\n              );\r\n              reject();\r\n              return;\r\n            }\r\n            await this.handleAddBook(\r\n              result as BookModel,\r\n              file_content as ArrayBuffer\r\n            );\r\n\r\n            resolve();\r\n          };\r\n          reader.readAsArrayBuffer(file);\r\n        };\r\n      }\r\n    });\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <Dropzone\r\n        onDrop={async (acceptedFiles) => {\r\n          this.props.handleDrag(false);\r\n          for (let item of acceptedFiles) {\r\n            await this.getMd5WithBrowser(item);\r\n          }\r\n        }}\r\n        accept={[\r\n          \".epub\",\r\n          \".pdf\",\r\n          \".txt\",\r\n          \".mobi\",\r\n          \".azw3\",\r\n          \".djvu\",\r\n          \".htm\",\r\n          \".html\",\r\n          \".xml\",\r\n          \".xhtml\",\r\n          \".docx\",\r\n          \".rtf\",\r\n          \".md\",\r\n          \".fb2\",\r\n          \".cbz\",\r\n          \".cbt\",\r\n          \".cbr\",\r\n        ]}\r\n        multiple={true}\r\n      >\r\n        {({ getRootProps, getInputProps }) => (\r\n          <div\r\n            className=\"import-from-local\"\r\n            {...getRootProps()}\r\n            style={\r\n              this.props.isCollapsed && document.body.clientWidth < 950\r\n                ? { width: \"42px\" }\r\n                : {}\r\n            }\r\n          >\r\n            <div className=\"animation-mask-local\"></div>\r\n            {this.props.isCollapsed && this.state.width < 950 ? (\r\n              <Tooltip\r\n                title={this.props.t(\"Import\")}\r\n                position=\"top\"\r\n                style={{ height: \"20px\" }}\r\n                trigger=\"mouseenter\"\r\n              >\r\n                <span\r\n                  className=\"icon-folder\"\r\n                  style={{ fontSize: \"15px\", fontWeight: 500 }}\r\n                ></span>\r\n              </Tooltip>\r\n            ) : (\r\n              <span>\r\n                <Trans>Import</Trans>\r\n              </span>\r\n            )}\r\n\r\n            <input\r\n              type=\"file\"\r\n              id=\"import-book-box\"\r\n              className=\"import-book-box\"\r\n              name=\"file\"\r\n              {...getInputProps()}\r\n            />\r\n          </div>\r\n        )}\r\n      </Dropzone>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(ImportLocal);\r\n","import \"./importLocal.css\";\r\nimport { connect } from \"react-redux\";\r\nimport { handleFetchBooks, handleLoadingDialog } from \"../../store/actions\";\r\nimport { handleReadingBook } from \"../../store/actions\";\r\nimport { stateType } from \"../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport ImportLocal from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    notes: state.reader.notes,\r\n    bookmarks: state.reader.bookmarks,\r\n    isCollapsed: state.sidebar.isCollapsed,\r\n    deletedBooks: state.manager.deletedBooks,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleFetchBooks,\r\n  handleReadingBook,\r\n  handleLoadingDialog,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(ImportLocal as any));\r\n","import React from \"react\";\r\nimport \"./updateInfo.css\";\r\nimport { UpdateInfoProps, UpdateInfoState } from \"./interface\";\r\nimport { version } from \"../../../../package.json\";\r\nimport { Trans } from \"react-i18next\";\r\nimport axios from \"axios\";\r\nimport Lottie from \"react-lottie\";\r\nimport animationNew from \"../../../assets/lotties/new.json\";\r\nimport animationSuccess from \"../../../assets/lotties/success.json\";\r\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\r\nimport { openExternalUrl } from \"../../../utils/serviceUtils/urlUtil\";\r\nconst newOptions = {\r\n  loop: false,\r\n  autoplay: true,\r\n  animationData: animationNew,\r\n  rendererSettings: {\r\n    preserveAspectRatio: \"xMidYMid slice\",\r\n  },\r\n};\r\nconst successOptions = {\r\n  loop: false,\r\n  autoplay: true,\r\n  animationData: animationSuccess,\r\n  rendererSettings: {\r\n    preserveAspectRatio: \"xMidYMid slice\",\r\n  },\r\n};\r\n\r\nclass UpdateInfo extends React.Component<UpdateInfoProps, UpdateInfoState> {\r\n  constructor(props: UpdateInfoProps) {\r\n    super(props);\r\n    this.state = {\r\n      updateLog: \"\",\r\n      isUpdated: false,\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    !this.props.currentBook.key &&\r\n      axios\r\n        .get(`https://koodo.960960.xyz/api/update?name=${navigator.language}`)\r\n        .then((res) => {\r\n          const newVersion = res.data.log.version;\r\n          console.log(\r\n            res,\r\n            version,\r\n            newVersion,\r\n            version.localeCompare(newVersion)\r\n          );\r\n\r\n          setTimeout(() => {\r\n            if (version.localeCompare(newVersion) < 0) {\r\n              if (StorageUtil.getReaderConfig(\"isDisableUpdate\") !== \"yes\") {\r\n                this.setState({ updateLog: res.data.log });\r\n                this.props.handleNewDialog(true);\r\n              } else {\r\n                this.props.handleNewWarning(true);\r\n              }\r\n            } else if (\r\n              StorageUtil.getReaderConfig(\"version\") !== newVersion &&\r\n              StorageUtil.getReaderConfig(\"isFirst\")\r\n            ) {\r\n              this.setState({ isUpdated: true });\r\n              this.props.handleNewDialog(true);\r\n              StorageUtil.setReaderConfig(\"version\", newVersion);\r\n            }\r\n            StorageUtil.setReaderConfig(\r\n              \"appInfo\",\r\n              version.localeCompare(newVersion) < 0\r\n                ? \"new\"\r\n                : version.localeCompare(newVersion) === 0\r\n                ? \"stable\"\r\n                : \"dev\"\r\n            );\r\n          }, 500);\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n  }\r\n  renderList = (arr: any[]) => {\r\n    return arr.map((item, index) => {\r\n      return (\r\n        <li className=\"update-dialog-list\" key={index}>\r\n          <span>{index + 1 + \". \"}</span>\r\n          <span>{item}</span>\r\n        </li>\r\n      );\r\n    });\r\n  };\r\n\r\n  handleClose = () => {\r\n    this.setState({ updateLog: \"\", isUpdated: false });\r\n    this.props.handleNewDialog(false);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        {(this.state.updateLog || this.state.isUpdated) &&\r\n          this.props.isShowNew && (\r\n            <div\r\n              className=\"new-version\"\r\n              style={\r\n                this.state.isUpdated\r\n                  ? { height: \"240px\", top: \"calc(50vh - 120px)\" }\r\n                  : {}\r\n              }\r\n            >\r\n              <div className=\"new-version-title\">\r\n                {this.state.isUpdated ? (\r\n                  <Trans>Update Complete</Trans>\r\n                ) : (\r\n                  <>\r\n                    <Trans>Update to</Trans>\r\n                    {\" \" + this.state.updateLog.version}\r\n                  </>\r\n                )}\r\n              </div>\r\n              <div\r\n                className=\"setting-close-container\"\r\n                onClick={() => {\r\n                  this.handleClose();\r\n                }}\r\n              >\r\n                <span className=\"icon-close setting-close\"></span>\r\n              </div>\r\n              {this.state.isUpdated && (\r\n                <div className=\"update-info-text\">\r\n                  <Trans>You successfully update to</Trans>\r\n                  {\" \" + version}\r\n                </div>\r\n              )}\r\n              <div className=\"update-dialog-info\" style={{ height: 420 }}>\r\n                <div className=\"new-version-animation\">\r\n                  {this.state.isUpdated ? (\r\n                    <Lottie\r\n                      options={successOptions}\r\n                      height={80}\r\n                      width={80}\r\n                      style={{ marginTop: \"10px\", marginBottom: \"10px\" }}\r\n                    />\r\n                  ) : (\r\n                    <Lottie options={newOptions} height={220} width={220} />\r\n                  )}\r\n                </div>\r\n                <div\r\n                  className=\"new-version-open\"\r\n                  onClick={() => {\r\n                    openExternalUrl(\r\n                      this.state.isUpdated\r\n                        ? \"https://koodo.960960.xyz/en/log\"\r\n                        : \"https://koodo.960960.xyz/en\"\r\n                    );\r\n                  }}\r\n                  style={this.state.isUpdated ? { marginTop: \"10px\" } : {}}\r\n                >\r\n                  {this.state.isUpdated ? (\r\n                    <>\r\n                      <Trans>Changelog</Trans>\r\n                    </>\r\n                  ) : (\r\n                    <Trans>Download</Trans>\r\n                  )}\r\n                </div>\r\n                {this.state.updateLog && (\r\n                  <>\r\n                    <p className=\"update-dialog-new-title\">\r\n                      <Trans>What's New</Trans>\r\n                    </p>\r\n                    <ul className=\"update-dialog-new-container\">\r\n                      {this.renderList(this.state.updateLog.new)}\r\n                    </ul>\r\n                    <p className=\"update-dialog-fix-title\">\r\n                      <Trans>What's been fixed</Trans>\r\n                    </p>\r\n                    <ul className=\"update-dialog-fix-container\">\r\n                      {this.renderList(this.state.updateLog.fix)}\r\n                    </ul>\r\n                  </>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default UpdateInfo;\r\n","import { connect } from \"react-redux\";\r\nimport { handleNewDialog, handleNewWarning } from \"../../../store/actions\";\r\nimport UpdateInfo from \"./component\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport { stateType } from \"../../../store\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentBook: state.book.currentBook,\r\n    books: state.manager.books,\r\n    isShowNew: state.manager.isShowNew,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleNewDialog,\r\n  handleNewWarning,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(UpdateInfo as any));\r\n","import { unzipBook, unzipConfig } from \"./common\";\r\n\r\nexport const restore = (file: File, isSync = false) => {\r\n  return new Promise<boolean>(async (resolve, reject) => {\r\n    let result = await unzipConfig(file);\r\n    if (result) {\r\n      if (isSync) {\r\n        resolve(true);\r\n      } else {\r\n        let res = await unzipBook(file);\r\n        if (res) {\r\n          resolve(true);\r\n        } else {\r\n          resolve(false);\r\n        }\r\n      }\r\n    } else {\r\n      resolve(false);\r\n    }\r\n  });\r\n};\r\n","import BookModel from \"../../model/Book\";\r\nimport NoteModel from \"../../model/Note\";\r\nimport BookmarkModel from \"../../model/Bookmark\";\r\nimport { zipBook, zipConfig } from \"./common\";\r\n\r\nlet JSZip = (window as any).JSZip;\r\n\r\nexport const backup = (\r\n  bookArr: BookModel[],\r\n  notes: NoteModel[],\r\n  bookmarks: BookmarkModel[],\r\n  isSync: boolean\r\n) => {\r\n  return new Promise<Blob | boolean>(async (resolve, reject) => {\r\n    let zip = new JSZip();\r\n    let books = bookArr;\r\n    //0表示备份到本地，1表示备份到dropbox,2表示备份到onedrive,3表示备份到webdav，4表示把indexeddb中的数据转移到uploads文件夹中，5表示同步数据到本地\r\n    let result = await zipConfig(zip, books, notes, bookmarks);\r\n    if (!result) resolve(false);\r\n    if (!isSync) {\r\n      await zipBook(zip, books);\r\n    }\r\n    zip\r\n      .generateAsync({ type: \"blob\" })\r\n      .then((blob: any) => {\r\n        resolve(blob);\r\n      })\r\n      .catch((err: any) => {\r\n        console.log(err);\r\n        resolve(false);\r\n      });\r\n  });\r\n};\r\n","import React from \"react\";\r\nimport \"./header.css\";\r\nimport SearchBox from \"../../components/searchBox\";\r\nimport ImportLocal from \"../../components/importLocal\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { HeaderProps, HeaderState } from \"./interface\";\r\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\nimport UpdateInfo from \"../../components/dialogs/updateDialog\";\r\nimport { restore } from \"../../utils/syncUtils/restoreUtil\";\r\nimport { backup } from \"../../utils/syncUtils/backupUtil\";\r\nimport { Tooltip } from \"react-tippy\";\r\nimport { isElectron } from \"react-device-detect\";\r\nimport { syncData } from \"../../utils/syncUtils/common\";\r\nimport toast from \"react-hot-toast\";\r\nclass Header extends React.Component<HeaderProps, HeaderState> {\r\n  constructor(props: HeaderProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      isOnlyLocal: false,\r\n      language: StorageUtil.getReaderConfig(\"lang\"),\r\n      isNewVersion: false,\r\n      width: document.body.clientWidth,\r\n      isdataChange: false,\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    if (isElectron) {\r\n      const fs = window.require(\"fs\");\r\n      const path = window.require(\"path\");\r\n      const { ipcRenderer } = window.require(\"electron\");\r\n      const dirPath = ipcRenderer.sendSync(\"user-data\", \"ping\");\r\n      if (!fs.existsSync(dirPath)) {\r\n        fs.mkdirSync(dirPath);\r\n        fs.mkdirSync(path.join(dirPath, \"data\"));\r\n        fs.mkdirSync(path.join(dirPath, \"data\", \"book\"));\r\n        console.log(\"文件夹创建成功\");\r\n      } else {\r\n        console.log(\"文件夹已存在\");\r\n      }\r\n\r\n      if (\r\n        StorageUtil.getReaderConfig(\"storageLocation\") &&\r\n        !localStorage.getItem(\"storageLocation\")\r\n      ) {\r\n        localStorage.setItem(\r\n          \"storageLocation\",\r\n          StorageUtil.getReaderConfig(\"storageLocation\")\r\n        );\r\n      }\r\n\r\n      //Check for data update\r\n      let storageLocation = localStorage.getItem(\"storageLocation\")\r\n        ? localStorage.getItem(\"storageLocation\")\r\n        : window\r\n            .require(\"electron\")\r\n            .ipcRenderer.sendSync(\"storage-location\", \"ping\");\r\n      let sourcePath = path.join(\r\n        storageLocation,\r\n        \"config\",\r\n        \"readerConfig.json\"\r\n      );\r\n      //Detect data modification\r\n      fs.readFile(sourcePath, \"utf8\", (err, data) => {\r\n        if (err) {\r\n          console.error(err);\r\n          return;\r\n        }\r\n        const readerConfig = JSON.parse(data);\r\n        if (\r\n          localStorage.getItem(\"lastSyncTime\") &&\r\n          parseInt(readerConfig.lastSyncTime) >\r\n            parseInt(localStorage.getItem(\"lastSyncTime\")!)\r\n        ) {\r\n          this.setState({ isdataChange: true });\r\n        }\r\n      });\r\n    }\r\n\r\n    window.addEventListener(\"resize\", () => {\r\n      this.setState({ width: document.body.clientWidth });\r\n    });\r\n    window.addEventListener(\"focus\", () => {\r\n      this.props.handleFetchBooks();\r\n      this.props.handleFetchNotes();\r\n      this.props.handleFetchBookmarks();\r\n    });\r\n  }\r\n\r\n  syncFromLocation = async () => {\r\n    const fs = window.require(\"fs\");\r\n    const path = window.require(\"path\");\r\n    const { zip } = window.require(\"zip-a-folder\");\r\n    let storageLocation = localStorage.getItem(\"storageLocation\")\r\n      ? localStorage.getItem(\"storageLocation\")\r\n      : window\r\n          .require(\"electron\")\r\n          .ipcRenderer.sendSync(\"storage-location\", \"ping\");\r\n    let sourcePath = path.join(storageLocation, \"config\");\r\n    let outPath = path.join(storageLocation, \"config.zip\");\r\n    await zip(sourcePath, outPath);\r\n\r\n    var data = fs.readFileSync(outPath);\r\n\r\n    let blobTemp = new Blob([data], { type: \"application/epub+zip\" });\r\n    let fileTemp = new File([blobTemp], \"config.zip\", {\r\n      lastModified: new Date().getTime(),\r\n      type: blobTemp.type,\r\n    });\r\n    let result = await restore(fileTemp, true);\r\n    if (result) {\r\n      this.setState({ isdataChange: false });\r\n      //Check for data update\r\n      let storageLocation = localStorage.getItem(\"storageLocation\")\r\n        ? localStorage.getItem(\"storageLocation\")\r\n        : window\r\n            .require(\"electron\")\r\n            .ipcRenderer.sendSync(\"storage-location\", \"ping\");\r\n      let sourcePath = path.join(\r\n        storageLocation,\r\n        \"config\",\r\n        \"readerConfig.json\"\r\n      );\r\n\r\n      fs.readFile(sourcePath, \"utf8\", (err, data) => {\r\n        if (err) {\r\n          console.error(err);\r\n          return;\r\n        }\r\n        const readerConfig = JSON.parse(data);\r\n        if (localStorage.getItem(\"lastSyncTime\") && readerConfig.lastSyncTime) {\r\n          localStorage.setItem(\"lastSyncTime\", readerConfig.lastSyncTime);\r\n        }\r\n      });\r\n    }\r\n    if (!result) {\r\n      toast.error(this.props.t(\"Sync Failed\"));\r\n    } else {\r\n      toast.success(this.props.t(\"Sync Successfully\"));\r\n    }\r\n  };\r\n  handleSync = () => {\r\n    if (StorageUtil.getReaderConfig(\"isFirst\") !== \"no\") {\r\n      this.props.handleTipDialog(true);\r\n      this.props.handleTip(\r\n        \"You need to manually change the storage location to the same sync folder on different computers. When you click the sync button, Koodo Reader will automatically upload or download the data from this folder according the timestamp.\"\r\n      );\r\n      StorageUtil.setReaderConfig(\"isFirst\", \"no\");\r\n      return;\r\n    }\r\n    const fs = window.require(\"fs\");\r\n    const path = window.require(\"path\");\r\n    let storageLocation = localStorage.getItem(\"storageLocation\")\r\n      ? localStorage.getItem(\"storageLocation\")\r\n      : window\r\n          .require(\"electron\")\r\n          .ipcRenderer.sendSync(\"storage-location\", \"ping\");\r\n    let sourcePath = path.join(storageLocation, \"config\", \"readerConfig.json\");\r\n    fs.readFile(sourcePath, \"utf8\", async (err, data) => {\r\n      if (err || !data) {\r\n        this.syncToLocation();\r\n      }\r\n      const readerConfig = JSON.parse(data);\r\n\r\n      if (\r\n        readerConfig &&\r\n        localStorage.getItem(\"lastSyncTime\") &&\r\n        parseInt(readerConfig.lastSyncTime) >\r\n          parseInt(localStorage.getItem(\"lastSyncTime\")!)\r\n      ) {\r\n        this.syncFromLocation();\r\n      } else {\r\n        //否则就把Koodo中数据同步到同步文件夹\r\n        this.syncToLocation();\r\n      }\r\n    });\r\n  };\r\n  syncToLocation = async () => {\r\n    let timestamp = new Date().getTime().toString();\r\n    StorageUtil.setReaderConfig(\"lastSyncTime\", timestamp);\r\n    localStorage.setItem(\"lastSyncTime\", timestamp);\r\n    let result = await backup(\r\n      this.props.books,\r\n      this.props.notes,\r\n      this.props.bookmarks,\r\n      true\r\n    );\r\n    if (!result) {\r\n      toast.error(this.props.t(\"Sync Failed\"));\r\n    } else {\r\n      syncData(result as Blob, this.props.books, true);\r\n      toast.success(this.props.t(\"Sync Successfully\"));\r\n    }\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"header\">\r\n        <div className=\"header-search-container\">\r\n          <SearchBox />\r\n        </div>\r\n\r\n        <>\r\n          <div\r\n            className=\"setting-icon-container\"\r\n            onClick={() => {\r\n              this.props.handleSortDisplay(!this.props.isSortDisplay);\r\n            }}\r\n            onMouseLeave={() => {\r\n              this.props.handleSortDisplay(false);\r\n            }}\r\n            style={{ left: \"490px\", top: \"18px\" }}\r\n          >\r\n            <Tooltip\r\n              title={this.props.t(\"Sort by\")}\r\n              position=\"top\"\r\n              trigger=\"mouseenter\"\r\n              distance={20}\r\n            >\r\n              <span className=\"icon-sort-desc header-sort-icon\"></span>\r\n            </Tooltip>\r\n          </div>\r\n          <div\r\n            className=\"setting-icon-container\"\r\n            onClick={() => {\r\n              this.props.handleAbout(!this.props.isAboutOpen);\r\n            }}\r\n            onMouseLeave={() => {\r\n              this.props.handleAbout(false);\r\n            }}\r\n          >\r\n            <Tooltip\r\n              title={this.props.t(\"Setting\")}\r\n              position=\"top\"\r\n              trigger=\"mouseenter\"\r\n            >\r\n              <span\r\n                className=\"icon-setting setting-icon\"\r\n                style={\r\n                  this.props.isNewWarning ? { color: \"rgb(35, 170, 242)\" } : {}\r\n                }\r\n              ></span>\r\n            </Tooltip>\r\n          </div>\r\n          {isElectron && (\r\n            <div\r\n              className=\"setting-icon-container\"\r\n              onClick={() => {\r\n                // this.syncFromLocation();\r\n                this.handleSync();\r\n              }}\r\n              style={{ left: \"635px\" }}\r\n            >\r\n              <Tooltip\r\n                title={this.props.t(\r\n                  this.state.isdataChange\r\n                    ? \"Data change detected, whether to update?\"\r\n                    : \"Sync\"\r\n                )}\r\n                position=\"top\"\r\n                trigger=\"mouseenter\"\r\n              >\r\n                <span\r\n                  className=\"icon-sync setting-icon\"\r\n                  style={\r\n                    this.state.isdataChange\r\n                      ? { color: \"rgb(35, 170, 242)\" }\r\n                      : {}\r\n                  }\r\n                ></span>\r\n              </Tooltip>\r\n            </div>\r\n          )}\r\n        </>\r\n\r\n        <div\r\n          className=\"import-from-cloud\"\r\n          onClick={() => {\r\n            this.props.handleBackupDialog(true);\r\n          }}\r\n          style={\r\n            this.props.isCollapsed && document.body.clientWidth < 950\r\n              ? { width: \"42px\" }\r\n              : {}\r\n          }\r\n        >\r\n          <div className=\"animation-mask\"></div>\r\n          {this.props.isCollapsed && this.state.width < 950 ? (\r\n            <Tooltip\r\n              title={this.props.t(\"Backup\")}\r\n              position=\"top\"\r\n              trigger=\"mouseenter\"\r\n            >\r\n              <span\r\n                className=\"icon-share\"\r\n                style={{ fontSize: \"15px\", fontWeight: 600 }}\r\n              ></span>\r\n            </Tooltip>\r\n          ) : (\r\n            <Trans>Backup</Trans>\r\n          )}\r\n        </div>\r\n        <ImportLocal\r\n          {...{\r\n            handleDrag: this.props.handleDrag,\r\n          }}\r\n        />\r\n        {isElectron && <UpdateInfo />}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Header;\r\n","import { connect } from \"react-redux\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport {\r\n  handleSortDisplay,\r\n  handleSetting,\r\n  handleAbout,\r\n  handleTipDialog,\r\n  handleTip,\r\n  handleBackupDialog,\r\n  handleFetchBooks,\r\n  handleFetchNotes,\r\n  handleFetchBookmarks,\r\n} from \"../../store/actions\";\r\nimport { stateType } from \"../../store\";\r\nimport Header from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    isSearch: state.manager.isSearch,\r\n    isAboutOpen: state.manager.isAboutOpen,\r\n    bookmarks: state.reader.bookmarks,\r\n    books: state.manager.books,\r\n    isNewWarning: state.manager.isNewWarning,\r\n    notes: state.reader.notes,\r\n    isCollapsed: state.sidebar.isCollapsed,\r\n\r\n    isSortDisplay: state.manager.isSortDisplay,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleSortDisplay,\r\n  handleBackupDialog,\r\n  handleSetting,\r\n  handleAbout,\r\n  handleTipDialog,\r\n  handleTip,\r\n  handleFetchBooks,\r\n  handleFetchNotes,\r\n  handleFetchBookmarks,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(Header as any));\r\n","import BookModel from \"../../model/Book\";\r\nimport NoteModel from \"../../model/Note\";\r\nimport BookmarkModel from \"../../model/Bookmark\";\r\nclass DeleteUtil {\r\n  static deleteBook(books: BookModel[], bookKey: string) {\r\n    books = books.filter((item) => item.key !== bookKey);\r\n    return books;\r\n  }\r\n  static deleteBookmarks(bookmarks: BookmarkModel[], bookKey: string) {\r\n    bookmarks = bookmarks.filter((item) => item.bookKey !== bookKey);\r\n    return bookmarks;\r\n  }\r\n  static deleteNotes(notes: NoteModel[], bookKey: string) {\r\n    notes = notes.filter((item) => item.bookKey !== bookKey);\r\n    return notes;\r\n  }\r\n}\r\n\r\nexport default DeleteUtil;\r\n","const defaultShelf = {\r\n  New: null,\r\n  Study: [],\r\n  Work: [],\r\n  Entertainment: [],\r\n};\r\nclass ShelfUtil {\r\n  static setShelf(shelfTitle: string, bookKey: string) {\r\n    let json = localStorage.getItem(\"shelfList\");\r\n    let obj = JSON.parse(json!) || defaultShelf;\r\n    if (obj[shelfTitle] === undefined) {\r\n      obj[shelfTitle] = [];\r\n    }\r\n    if (obj[shelfTitle].indexOf(bookKey) === -1) {\r\n      obj[shelfTitle].unshift(bookKey);\r\n    }\r\n    localStorage.setItem(\"shelfList\", JSON.stringify(obj));\r\n  }\r\n\r\n  static getShelf() {\r\n    let json = localStorage.getItem(\"shelfList\");\r\n    let obj = JSON.parse(json!) || defaultShelf;\r\n    return obj;\r\n  }\r\n  static clearShelf(shelfIndex: number, bookKey: string) {\r\n    let json = localStorage.getItem(\"shelfList\");\r\n    let obj = JSON.parse(json!) || defaultShelf;\r\n    let shelfTitle = Object.keys(obj);\r\n    let currentShelfTitle = shelfTitle[shelfIndex];\r\n    let index = obj[currentShelfTitle].indexOf(bookKey);\r\n    obj[currentShelfTitle].splice(index, 1);\r\n    localStorage.setItem(\"shelfList\", JSON.stringify(obj));\r\n  }\r\n  static deletefromAllShelf(bookKey: string) {\r\n    let json = localStorage.getItem(\"shelfList\");\r\n    let obj = JSON.parse(json!) || defaultShelf;\r\n    let shelfTitle = Object.keys(obj);\r\n    shelfTitle.splice(0, 1);\r\n    shelfTitle.forEach((item) => {\r\n      let index = obj[item].indexOf(bookKey);\r\n      if (index > -1) {\r\n        obj[item].splice(index, 1);\r\n      }\r\n    });\r\n    localStorage.setItem(\"shelfList\", JSON.stringify(obj));\r\n  }\r\n  static removeShelf(shelfTitle: string) {\r\n    let json = localStorage.getItem(\"shelfList\");\r\n    let obj = JSON.parse(json!) || defaultShelf;\r\n    delete obj[shelfTitle];\r\n    localStorage.setItem(\"shelfList\", JSON.stringify(obj));\r\n  }\r\n  static getBookPosition(bookKey: string) {\r\n    let json = localStorage.getItem(\"shelfList\");\r\n    let obj = JSON.parse(json!) || defaultShelf;\r\n    let shelfList: string[] = [];\r\n    for (let item in obj) {\r\n      if (obj[item] && obj[item].indexOf(bookKey) > -1) {\r\n        shelfList.push(item);\r\n      }\r\n    }\r\n    return shelfList;\r\n  }\r\n}\r\n\r\nexport default ShelfUtil;\r\n","import BookModel from \"../../model/Book\";\r\nclass AddFavorite {\r\n  static setFavorite(bookKey: string) {\r\n    let bookArr =\r\n      localStorage.getItem(\"favoriteBooks\") !== \"{}\" &&\r\n      localStorage.getItem(\"favoriteBooks\")\r\n        ? JSON.parse(localStorage.getItem(\"favoriteBooks\") || \"\")\r\n        : [];\r\n    const index = bookArr.indexOf(bookKey);\r\n    if (index > -1) {\r\n      bookArr.splice(index, 1);\r\n      bookArr.unshift(bookKey);\r\n    } else {\r\n      bookArr.unshift(bookKey);\r\n    }\r\n\r\n    localStorage.setItem(\"favoriteBooks\", JSON.stringify(bookArr));\r\n  }\r\n  static setAllFavorite(books: BookModel[]) {\r\n    let bookArr: string[] = [];\r\n    books.forEach((item) => {\r\n      bookArr.push(item.key);\r\n    });\r\n    localStorage.setItem(\"favoriteBooks\", JSON.stringify(bookArr));\r\n  }\r\n  static clear(bookKey: string) {\r\n    let bookArr =\r\n      localStorage.getItem(\"favoriteBooks\") !== \"{}\" &&\r\n      localStorage.getItem(\"favoriteBooks\")\r\n        ? JSON.parse(localStorage.getItem(\"favoriteBooks\") || \"\")\r\n        : [];\r\n    const index = bookArr.indexOf(bookKey);\r\n    if (index > -1) {\r\n      bookArr.splice(index, 1);\r\n    }\r\n    localStorage.setItem(\"favoriteBooks\", JSON.stringify(bookArr));\r\n  }\r\n  static getAllFavorite() {\r\n    let bookArr =\r\n      localStorage.getItem(\"favoriteBooks\") !== \"{}\" &&\r\n      localStorage.getItem(\"favoriteBooks\")\r\n        ? JSON.parse(localStorage.getItem(\"favoriteBooks\") || \"\")\r\n        : [];\r\n    return bookArr || [];\r\n  }\r\n}\r\n\r\nexport default AddFavorite;\r\n","import React from \"react\";\r\nimport \"./deleteDialog.css\";\r\nimport DeleteUtil from \"../../../utils/readUtils/deleteUtil\";\r\nimport localforage from \"localforage\";\r\nimport ShelfUtil from \"../../../utils/readUtils/shelfUtil\";\r\nimport RecordRecent from \"../../../utils/readUtils/recordRecent\";\r\nimport RecordLocation from \"../../../utils/readUtils/recordLocation\";\r\nimport AddFavorite from \"../../../utils/readUtils/addFavorite\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { DeleteDialogProps } from \"./interface\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport AddTrash from \"../../../utils/readUtils/addTrash\";\r\nimport BookUtil from \"../../../utils/fileUtils/bookUtil\";\r\nimport toast from \"react-hot-toast\";\r\nclass DeleteDialog extends React.Component<DeleteDialogProps> {\r\n  handleCancel = () => {\r\n    this.props.handleDeleteDialog(false);\r\n  };\r\n  handleDeleteOther = (key: string) => {\r\n    return new Promise<void>(async (resolve, reject) => {\r\n      if (this.props.bookmarks[0]) {\r\n        let bookmarkArr = DeleteUtil.deleteBookmarks(this.props.bookmarks, key);\r\n        if (bookmarkArr.length === 0) {\r\n          await localforage.removeItem(\"bookmarks\");\r\n        } else {\r\n          await localforage.setItem(\"bookmarks\", bookmarkArr);\r\n        }\r\n      }\r\n      if (this.props.notes) {\r\n        let noteArr = DeleteUtil.deleteNotes(this.props.notes, key);\r\n        if (noteArr.length === 0) {\r\n          await localforage.removeItem(\"notes\");\r\n          resolve();\r\n        } else {\r\n          await localforage.setItem(\"notes\", noteArr);\r\n          resolve();\r\n        }\r\n      }\r\n    });\r\n  };\r\n  handleComfirm = async () => {\r\n    //从列表删除和从图书库删除判断\r\n    if (this.props.mode === \"shelf\") {\r\n      if (this.props.isSelectBook) {\r\n        this.props.selectedBooks.forEach((item) => {\r\n          ShelfUtil.clearShelf(this.props.shelfIndex, item);\r\n        });\r\n        this.props.handleSelectedBooks([]);\r\n        this.props.handleFetchBooks(false);\r\n        this.props.handleSelectBook(!this.props.isSelectBook);\r\n        this.props.handleDeleteDialog(false);\r\n        toast.success(this.props.t(\"Delete Successfully\"));\r\n        return;\r\n      }\r\n      ShelfUtil.clearShelf(this.props.shelfIndex, this.props.currentBook.key);\r\n    } else if (this.props.mode === \"trash\") {\r\n      let keyArr = AddTrash.getAllTrash();\r\n      for (let i = 0; i < keyArr.length; i++) {\r\n        await this.deleteBook(keyArr[i]);\r\n      }\r\n\r\n      if (this.props.books.length === 1) {\r\n        this.props.history.push(\"/manager/empty\");\r\n      }\r\n      this.props.handleFetchBooks(false);\r\n      this.props.handleFetchBooks(true);\r\n      this.props.handleFetchBookmarks();\r\n      this.props.handleFetchNotes();\r\n    } else if (this.props.isSelectBook) {\r\n      this.props.selectedBooks.forEach((item) => {\r\n        AddTrash.setTrash(item);\r\n        //从喜爱的图书中删除\r\n        AddFavorite.clear(item);\r\n      });\r\n      this.props.handleSelectedBooks([]);\r\n      this.props.handleFetchBooks(false);\r\n      this.props.handleSelectBook(!this.props.isSelectBook);\r\n    } else {\r\n      AddTrash.setTrash(this.props.currentBook.key);\r\n      //从喜爱的图书中删除\r\n      AddFavorite.clear(this.props.currentBook.key);\r\n      this.props.handleFetchBooks(false);\r\n    }\r\n\r\n    this.props.handleDeleteDialog(false);\r\n    toast.success(this.props.t(\"Delete Successfully\"));\r\n  };\r\n  deleteBook = (key: string) => {\r\n    return new Promise<void>((resolve, reject) => {\r\n      this.props.books &&\r\n        localforage\r\n          .setItem(\"books\", DeleteUtil.deleteBook(this.props.books, key))\r\n          .then(async () => {\r\n            await BookUtil.deleteBook(key);\r\n            //从喜爱的图书中删除\r\n            AddFavorite.clear(key);\r\n            //从回收的图书中删除\r\n            AddTrash.clear(key);\r\n            //从书架删除\r\n            ShelfUtil.deletefromAllShelf(key);\r\n            //从阅读记录删除\r\n            RecordRecent.clear(key);\r\n            //删除阅读历史\r\n            RecordLocation.clear(key);\r\n            //删除书签，笔记，书摘，高亮\r\n            await this.handleDeleteOther(key);\r\n            resolve();\r\n          })\r\n          .catch(() => {\r\n            reject();\r\n          });\r\n    });\r\n  };\r\n  render() {\r\n    return (\r\n      <div className=\"delete-dialog-container\">\r\n        {this.props.mode === \"shelf\" ? (\r\n          <div className=\"delete-dialog-title\">\r\n            <Trans>Delete from Shelf</Trans>\r\n          </div>\r\n        ) : this.props.mode === \"trash\" ? (\r\n          <div className=\"delete-dialog-title\">\r\n            <Trans>Delete All Books</Trans>\r\n          </div>\r\n        ) : (\r\n          <div className=\"delete-dialog-title\">\r\n            <Trans>Delete This Book</Trans>\r\n          </div>\r\n        )}\r\n        {this.props.mode === \"trash\" ? null : (\r\n          <div className=\"delete-dialog-book\">\r\n            <div className=\"delete-dialog-book-title\">\r\n              {this.props.isSelectBook ? (\r\n                <Trans\r\n                  i18nKey=\"Total books\"\r\n                  count={this.props.selectedBooks.length}\r\n                >\r\n                  {\"Total \" + this.props.selectedBooks.length + \" books\"}\r\n                </Trans>\r\n              ) : (\r\n                this.props.currentBook.name\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {this.props.mode === \"shelf\" ? (\r\n          <div className=\"delete-dialog-other-option\">\r\n            <Trans>This action won't delete the original book</Trans>\r\n          </div>\r\n        ) : this.props.mode === \"trash\" ? (\r\n          <div className=\"delete-dialog-other-option\" style={{ top: \"80px\" }}>\r\n            <Trans>\r\n              This action will remove all the books in recycle bin,together with\r\n              their notes, bookmarks and digests\r\n            </Trans>\r\n          </div>\r\n        ) : (\r\n          <div className=\"delete-dialog-other-option\">\r\n            <Trans>\r\n              {\r\n                \"This action will move this book and its the notes, bookmarks and highlights of this book to the recycle bin\"\r\n              }\r\n            </Trans>\r\n          </div>\r\n        )}\r\n        <div\r\n          className=\"delete-dialog-cancel\"\r\n          onClick={() => {\r\n            this.handleCancel();\r\n          }}\r\n        >\r\n          <Trans>Cancel</Trans>\r\n        </div>\r\n        <div\r\n          className=\"delete-dialog-comfirm\"\r\n          onClick={() => {\r\n            this.handleComfirm();\r\n          }}\r\n        >\r\n          <Trans>Delete</Trans>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(DeleteDialog);\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleFetchBooks,\r\n  handleDeleteDialog,\r\n  handleActionDialog,\r\n  handleFetchBookmarks,\r\n  handleFetchNotes,\r\n  handleSelectedBooks,\r\n  handleSelectBook,\r\n} from \"../../../store/actions\";\r\nimport { stateType } from \"../../../store\";\r\nimport DeleteDialog from \"./component\";\r\nimport { withTranslation } from \"react-i18next\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    selectedBooks: state.manager.selectedBooks,\r\n    isSelectBook: state.manager.isSelectBook,\r\n    isOpenDeleteDialog: state.book.isOpenDeleteDialog,\r\n    currentBook: state.book.currentBook,\r\n    bookmarks: state.reader.bookmarks,\r\n    notes: state.reader.notes,\r\n    digests: state.reader.digests,\r\n    mode: state.sidebar.mode,\r\n    shelfIndex: state.sidebar.shelfIndex,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleFetchBooks,\r\n  handleDeleteDialog,\r\n  handleFetchBookmarks,\r\n  handleFetchNotes,\r\n  handleActionDialog,\r\n  handleSelectedBooks,\r\n  handleSelectBook,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(DeleteDialog));\r\n","import React from \"react\";\r\nimport \"./editDialog.css\";\r\nimport localforage from \"localforage\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { EditDialogProps, EditDialogState } from \"./interface\";\r\nimport toast from \"react-hot-toast\";\r\nclass EditDialog extends React.Component<EditDialogProps, EditDialogState> {\r\n  constructor(props: EditDialogProps) {\r\n    super(props);\r\n    this.state = { isCheck: false };\r\n  }\r\n  componentDidMount() {\r\n    const nameBox: HTMLInputElement = document.querySelector(\r\n      \".edit-dialog-book-name-box\"\r\n    ) as HTMLInputElement;\r\n    const authorBox: HTMLInputElement = document.querySelector(\r\n      \".edit-dialog-book-author-box\"\r\n    ) as HTMLInputElement;\r\n    nameBox.value = this.props.currentBook.name;\r\n    authorBox.value = this.props.currentBook.author;\r\n  }\r\n\r\n  handleCancel = () => {\r\n    this.props.handleEditDialog(false);\r\n  };\r\n  handleComfirm = () => {\r\n    const nameBox: HTMLInputElement = document.querySelector(\r\n      \".edit-dialog-book-name-box\"\r\n    ) as HTMLInputElement;\r\n    let name = nameBox.value;\r\n    const authorBox: HTMLInputElement = document.querySelector(\r\n      \".edit-dialog-book-author-box\"\r\n    ) as HTMLInputElement;\r\n    let author = authorBox.value;\r\n    let { books } = this.props;\r\n    books.forEach((item) => {\r\n      if (item.key === this.props.currentBook.key) {\r\n        item.name = name;\r\n        item.author = author;\r\n        return false;\r\n      }\r\n    });\r\n    localforage.setItem(\"books\", books).then(() => {\r\n      this.props.handleEditDialog(false);\r\n      this.props.handleFetchBooks();\r\n    });\r\n    toast.success(this.props.t(\"Edit Successfully\"));\r\n    this.props.handleActionDialog(false);\r\n  };\r\n  render() {\r\n    return (\r\n      <div className=\"edit-dialog-container\">\r\n        <div className=\"edit-dialog-title\">\r\n          <Trans>Edit Book</Trans>\r\n        </div>\r\n        <div className=\"edit-dialog-book-name-container\">\r\n          <div className=\"edit-dialog-book-name-text\">\r\n            <Trans>Book Name</Trans>\r\n          </div>\r\n          <input className=\"edit-dialog-book-name-box\" />\r\n        </div>\r\n        <div className=\"edit-dialog-book-author-container\">\r\n          <div className=\"edit-dialog-book-author-text\">\r\n            <Trans>Author</Trans>\r\n          </div>\r\n          <input className=\"edit-dialog-book-author-box\" />\r\n        </div>\r\n        <div\r\n          className=\"edit-dialog-cancel\"\r\n          onClick={() => {\r\n            this.handleCancel();\r\n          }}\r\n        >\r\n          <Trans>Cancel</Trans>\r\n        </div>\r\n        <div\r\n          className=\"edit-dialog-comfirm\"\r\n          onClick={() => {\r\n            this.handleComfirm();\r\n          }}\r\n        >\r\n          <Trans>Confirm</Trans>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default EditDialog;\r\n","import { connect } from \"react-redux\";\r\nimport \"./editDialog.css\";\r\nimport { handleFetchBooks } from \"../../../store/actions\";\r\nimport { handleEditDialog, handleActionDialog } from \"../../../store/actions\";\r\nimport { stateType } from \"../../../store\";\r\nimport EditDialog from \"./component\";\r\nimport { withTranslation } from \"react-i18next\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    isOpenDeleteDialog: state.book.isOpenDeleteDialog,\r\n    currentBook: state.book.currentBook,\r\n    bookmarks: state.reader.bookmarks,\r\n    notes: state.reader.notes,\r\n    digests: state.reader.digests,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleFetchBooks,\r\n  handleEditDialog,\r\n  handleActionDialog,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(EditDialog));\r\n","import React, { Component } from \"react\";\r\nimport ShelfUtil from \"../../../utils/readUtils/shelfUtil\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { AddDialogProps, AddDialogState } from \"./interface\";\r\nimport \"./addDialog.css\";\r\nimport toast from \"react-hot-toast\";\r\n\r\nclass AddDialog extends Component<AddDialogProps, AddDialogState> {\r\n  constructor(props: AddDialogProps) {\r\n    super(props);\r\n    this.state = { isNew: true, shelfTitle: \"\" };\r\n  }\r\n\r\n  handleCancel = () => {\r\n    this.props.handleAddDialog(false);\r\n  };\r\n  handleComfirm = () => {\r\n    const inputElement: HTMLInputElement = document.querySelector(\r\n      \".add-dialog-new-shelf-box\"\r\n    ) as HTMLInputElement;\r\n    if (!isNaN(parseInt(inputElement.value))) {\r\n      toast(this.props.t(\"Shelf title can't be pure number\"));\r\n      return;\r\n    }\r\n    let shelfTitle: string = this.state.shelfTitle;\r\n    let shelfList = ShelfUtil.getShelf();\r\n    let shelfTitles = Object.keys(ShelfUtil.getShelf());\r\n    let shelfIndex = this.state.isNew\r\n      ? shelfTitles.length\r\n      : shelfTitles.indexOf(inputElement.value);\r\n    if (this.state.isNew) {\r\n      shelfTitle = inputElement.value;\r\n      if (shelfList.hasOwnProperty(shelfTitle)) {\r\n        toast(this.props.t(\"Duplicate Shelf\"));\r\n        return;\r\n      }\r\n    }\r\n    //未填书架名提醒\r\n    if (!shelfTitle) {\r\n      toast(this.props.t(\"Shelf Title is Empty\"));\r\n      return;\r\n    }\r\n    //判断书架中是否已有该图书\r\n    if (\r\n      shelfList[`${shelfTitle}`] &&\r\n      shelfList[`${shelfTitle}`].indexOf(this.props.currentBook.key) > -1\r\n    ) {\r\n      toast(this.props.t(\"Duplicate Book\"));\r\n      return;\r\n    }\r\n    if (this.props.isSelectBook) {\r\n      this.props.selectedBooks.forEach((item) => {\r\n        ShelfUtil.setShelf(shelfTitle, item);\r\n      });\r\n      this.props.handleSelectBook(!this.props.isSelectBook);\r\n      if (this.props.isSelectBook) {\r\n        this.props.handleSelectedBooks([]);\r\n      }\r\n    } else {\r\n      ShelfUtil.setShelf(shelfTitle, this.props.currentBook.key);\r\n    }\r\n\r\n    this.props.handleAddDialog(false);\r\n    toast.success(this.props.t(\"Add Successfully\"));\r\n    this.props.handleActionDialog(false);\r\n    this.props.handleMode(\"shelf\");\r\n    this.props.handleShelfIndex(shelfIndex);\r\n  };\r\n  //如果是添加到已存在的书架就diable新建图书的input框\r\n  handleChange = (shelfTitle: string) => {\r\n    if (shelfTitle === \"New\") {\r\n      this.setState({ isNew: true });\r\n    } else {\r\n      this.setState({ shelfTitle });\r\n      this.setState({ isNew: false });\r\n    }\r\n  };\r\n  render() {\r\n    const renderShelfList = () => {\r\n      let shelfList = ShelfUtil.getShelf();\r\n      let shelfTitle = Object.keys(shelfList);\r\n      return shelfTitle.map((item) => {\r\n        return (\r\n          <option\r\n            value={item}\r\n            key={item}\r\n            className=\"add-dialog-shelf-list-option\"\r\n          >\r\n            {this.props.t(item)}\r\n          </option>\r\n        );\r\n      });\r\n    };\r\n    return (\r\n      <div className=\"add-dialog-container\">\r\n        <div className=\"add-dialog-title\">\r\n          <Trans>Add to Shelf</Trans>\r\n        </div>\r\n        <div className=\"add-dialog-shelf-list-container\">\r\n          <div className=\"add-dialog-shelf-list-text\">\r\n            <Trans>Select</Trans>\r\n          </div>\r\n          <select\r\n            className=\"add-dialog-shelf-list-box\"\r\n            onChange={(event: React.ChangeEvent<HTMLSelectElement>) => {\r\n              this.handleChange(event.target.value);\r\n            }}\r\n          >\r\n            {renderShelfList()}\r\n          </select>\r\n        </div>\r\n        <div className=\"add-dialog-new-shelf-container\">\r\n          <div className=\"add-dialog-new-shelf-text\">\r\n            <Trans>New Shelf</Trans>\r\n          </div>\r\n          <input\r\n            className=\"add-dialog-new-shelf-box\"\r\n            disabled={!this.state.isNew}\r\n          />\r\n        </div>\r\n        <div\r\n          className=\"add-dialog-cancel\"\r\n          onClick={() => {\r\n            this.handleCancel();\r\n          }}\r\n        >\r\n          <Trans>Cancel</Trans>\r\n        </div>\r\n        <div\r\n          className=\"add-dialog-comfirm\"\r\n          onClick={() => {\r\n            this.handleComfirm();\r\n          }}\r\n        >\r\n          <Trans>Confirm</Trans>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default AddDialog;\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleAddDialog,\r\n  handleActionDialog,\r\n  handleMode,\r\n  handleShelfIndex,handleSelectBook,\r\n  handleSelectedBooks,\r\n} from \"../../../store/actions\";\r\nimport { stateType } from \"../../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport AddDialog from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    selectedBooks: state.manager.selectedBooks,\r\n    isSelectBook: state.manager.isSelectBook,\r\n    isOpenDeleteDialog: state.book.isOpenDeleteDialog,\r\n    currentBook: state.book.currentBook,\r\n    bookmarks: state.reader.bookmarks,\r\n    notes: state.reader.notes,\r\n    digests: state.reader.digests,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleAddDialog,\r\n  handleActionDialog,handleSelectBook,\r\n  handleMode,\r\n  handleShelfIndex,\r\n  handleSelectedBooks,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(AddDialog as any));\r\n","//排序弹窗\r\nimport React from \"react\";\r\nimport \"./sortDialog.css\";\r\nimport SortUtil from \"../../../utils/readUtils/sortUtil\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { SortDialogProps, SortDialogState } from \"./interface\";\r\n\r\nclass SortDialog extends React.Component<SortDialogProps, SortDialogState> {\r\n  constructor(props: SortDialogProps) {\r\n    super(props);\r\n    this.state = {\r\n      isNote: this.props.mode === \"note\" || this.props.mode === \"digest\",\r\n    };\r\n  }\r\n\r\n  handleSort = (code: number) => {\r\n    if (this.state.isNote) {\r\n      let noteSortCode = this.props.noteSortCode;\r\n      noteSortCode.sort = code;\r\n      this.props.handleNoteSortCode(noteSortCode);\r\n      this.props.handleNoteSort(true);\r\n      SortUtil.setNoteSortCode(code, this.props.noteSortCode.order);\r\n    } else {\r\n      let bookSortCode = this.props.bookSortCode;\r\n      bookSortCode.sort = code;\r\n      this.props.handleBookSortCode(bookSortCode);\r\n      this.props.handleBookSort(true);\r\n      SortUtil.setBookSortCode(code, this.props.bookSortCode.order);\r\n    }\r\n  };\r\n  handleOrder = (code: number) => {\r\n    if (this.state.isNote) {\r\n      let noteSortCode = this.props.noteSortCode;\r\n      noteSortCode.order = code;\r\n      this.props.handleNoteSort(true);\r\n      SortUtil.setNoteSortCode(this.props.noteSortCode.sort, code);\r\n      this.props.handleNoteSortCode(noteSortCode);\r\n    } else {\r\n      let bookSortCode = this.props.bookSortCode;\r\n      bookSortCode.order = code;\r\n      this.props.handleBookSort(true);\r\n      SortUtil.setBookSortCode(this.props.bookSortCode.sort, code);\r\n      this.props.handleBookSortCode(bookSortCode);\r\n    }\r\n  };\r\n\r\n  render() {\r\n    let sortCode = this.state.isNote\r\n      ? this.props.noteSortCode\r\n      : this.props.bookSortCode;\r\n    return (\r\n      <div\r\n        className=\"sort-dialog-container\"\r\n        onMouseLeave={() => {\r\n          this.props.handleSortDisplay(false);\r\n        }}\r\n        onMouseEnter={() => {\r\n          this.props.handleSortDisplay(true);\r\n        }}\r\n        style={this.state.isNote ? { height: \"150px\" } : {}}\r\n      >\r\n        {this.state.isNote ? (\r\n          <ul className=\"sort-by-category\">\r\n            {[\"Sort by Name\", \"Sort by Date\"].map((item, index) => {\r\n              return (\r\n                <li\r\n                  className=\"sort-by-category-list\"\r\n                  onClick={() => {\r\n                    this.handleSort(index + 1);\r\n                  }}\r\n                  style={sortCode.sort === index + 1 ? {} : { opacity: 0.34 }}\r\n                >\r\n                  <Trans>{item}</Trans>\r\n                  {sortCode.sort === index + 1 && (\r\n                    <span\r\n                      className=\"icon-check\"\r\n                      style={{ fontWeight: \"bold\" }}\r\n                    ></span>\r\n                  )}\r\n                </li>\r\n              );\r\n            })}\r\n          </ul>\r\n        ) : (\r\n          <ul className=\"sort-by-category\">\r\n            {[\r\n              \"Sort by Recent\",\r\n              \"Sort by Name\",\r\n              \"Sort by Date\",\r\n              \"Sort by Duration\",\r\n              \"Sort by Author\",\r\n              \"Sort by Percentage\",\r\n            ].map((item, index) => {\r\n              return (\r\n                <li\r\n                  className=\"sort-by-category-list\"\r\n                  onClick={() => {\r\n                    this.handleSort(index);\r\n                  }}\r\n                  style={sortCode.sort === index ? {} : { opacity: 0.34 }}\r\n                  key={index}\r\n                >\r\n                  <Trans>{item}</Trans>\r\n                  {sortCode.sort === index && (\r\n                    <span\r\n                      className=\"icon-check\"\r\n                      style={{ fontWeight: \"bold\" }}\r\n                    ></span>\r\n                  )}\r\n                </li>\r\n              );\r\n            })}\r\n          </ul>\r\n        )}\r\n        <div className=\"sort-dialog-seperator\"></div>\r\n        <ul className=\"sort-by-order\">\r\n          <li\r\n            className=\"sort-by-order-list\"\r\n            onClick={() => {\r\n              this.handleOrder(1);\r\n            }}\r\n            style={sortCode.order === 1 ? {} : { opacity: 0.34 }}\r\n          >\r\n            <Trans>Ascend</Trans>\r\n            {sortCode.order === 1 && (\r\n              <span\r\n                className=\"icon-check\"\r\n                style={{ fontWeight: \"bold\" }}\r\n              ></span>\r\n            )}\r\n          </li>\r\n          <li\r\n            className=\"sort-by-order-list\"\r\n            onClick={() => {\r\n              this.handleOrder(2);\r\n            }}\r\n            style={sortCode.order === 2 ? {} : { opacity: 0.34 }}\r\n          >\r\n            <Trans>Descend</Trans>\r\n            {sortCode.order === 2 && (\r\n              <span\r\n                className=\"icon-check\"\r\n                style={{ fontWeight: \"bold\" }}\r\n              ></span>\r\n            )}\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default SortDialog;\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleBookSortCode,\r\n  handleNoteSortCode,\r\n  handleSortDisplay,\r\n  handleBookSort,\r\n  handleNoteSort,\r\n} from \"../../../store/actions\";\r\nimport { stateType } from \"../../../store\";\r\nimport SortDialog from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    bookSortCode: state.manager.bookSortCode,\r\n    noteSortCode: state.manager.noteSortCode,\r\n    mode: state.sidebar.mode,\r\n    isSortDisplay: state.manager.isSortDisplay,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleBookSortCode,\r\n  handleSortDisplay,\r\n  handleNoteSortCode,\r\n  handleBookSort,\r\n  handleNoteSort,\r\n};\r\nexport default connect(mapStateToProps, actionCreator)(SortDialog);\r\n","import React from \"react\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { AboutDialogProps, AboutDialogState } from \"./interface\";\r\nimport { isElectron } from \"react-device-detect\";\r\nimport { openExternalUrl } from \"../../../utils/serviceUtils/urlUtil\";\r\n\r\nclass AboutDialog extends React.Component<AboutDialogProps, AboutDialogState> {\r\n  constructor(props: AboutDialogProps) {\r\n    super(props);\r\n    this.state = {};\r\n  }\r\n  handleJump = (url: string) => {\r\n    openExternalUrl(url);\r\n    this.props.handleAbout(false);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div\r\n        className=\"sort-dialog-container\"\r\n        onMouseLeave={() => {\r\n          this.props.handleAbout(false);\r\n        }}\r\n        onMouseEnter={() => {\r\n          this.props.handleAbout(true);\r\n        }}\r\n        style={\r\n          this.props.isNewWarning\r\n            ? { left: \"510px\", width: \"150px\" }\r\n            : {\r\n                left: \"510px\",\r\n\r\n                width: \"150px\",\r\n              }\r\n        }\r\n      >\r\n        <ul className=\"sort-by-category\">\r\n          <li\r\n            className=\"sort-by-category-list\"\r\n            onClick={() => {\r\n              this.props.handleSetting(true);\r\n              this.props.handleAbout(false);\r\n            }}\r\n          >\r\n            <Trans>Setting</Trans>\r\n          </li>\r\n\r\n          <li\r\n            className=\"sort-by-category-list\"\r\n            onClick={() => {\r\n              if (navigator.language.indexOf(\"zh\") > -1) {\r\n                this.handleJump(\r\n                  \"https://troyeguo.notion.site/Koodo-Reader-0c9c7ccdc5104a54825dfc72f1c84bea\"\r\n                );\r\n              } else {\r\n                this.handleJump(\r\n                  \"https://troyeguo.notion.site/Koodo-Reader-Document-9c767af3d66c459db996bdd08a34c34b\"\r\n                );\r\n              }\r\n            }}\r\n          >\r\n            <Trans>Help</Trans>\r\n          </li>\r\n          <li\r\n            className=\"sort-by-category-list\"\r\n            onClick={() => {\r\n              this.handleJump(`https://koodo.960960.xyz/en/support`);\r\n            }}\r\n          >\r\n            <Trans>Feedback</Trans>\r\n          </li>\r\n          <li\r\n            className=\"sort-by-category-list\"\r\n            onClick={() => {\r\n              if (navigator.language.indexOf(\"zh\") > -1) {\r\n                this.handleJump(\r\n                  \"https://www.notion.so/troyeguo/215baeda57804fd29dbb0e91d1e6a021?v=360c00183d944b598668f34c255edfd7\"\r\n                );\r\n              } else {\r\n                this.handleJump(\r\n                  \"https://www.notion.so/troyeguo/d1c19a132932465bae1d89dd963c92ea?v=ca8aa69cf25849c18c92b92ba868663b\"\r\n                );\r\n              }\r\n            }}\r\n          >\r\n            <Trans>Roadmap</Trans>\r\n          </li>\r\n          <li\r\n            className=\"sort-by-category-list\"\r\n            onClick={() => {\r\n              this.handleJump(\"https://koodo.960960.xyz\");\r\n            }}\r\n          >\r\n            <Trans>Our Website</Trans>\r\n          </li>\r\n          <li\r\n            className=\"sort-by-category-list\"\r\n            onClick={() => {\r\n              this.handleJump(\r\n                \"https://poeditor.com/join/project?hash=fk4qbQTlsk\"\r\n              );\r\n            }}\r\n          >\r\n            <Trans>Translation</Trans>\r\n          </li>\r\n          <li\r\n            className=\"sort-by-category-list\"\r\n            onClick={() => {\r\n              this.handleJump(\"https://github.com/troyeguo/koodo-reader\");\r\n            }}\r\n          >\r\n            <Trans>Github Repo</Trans>\r\n          </li>\r\n          {isElectron && (\r\n            <li\r\n              className=\"sort-by-category-list\"\r\n              onClick={() => {\r\n                window\r\n                  .require(\"electron\")\r\n                  .ipcRenderer.invoke(\"open-console\", \"ping\");\r\n              }}\r\n            >\r\n              <Trans>Open Console</Trans>\r\n            </li>\r\n          )}\r\n          {this.props.isNewWarning && (\r\n            <li\r\n              className=\"sort-by-category-list\"\r\n              onClick={() => {\r\n                this.handleJump(\"https://koodo.960960.xyz/en\");\r\n              }}\r\n              style={{ color: \"rgb(35, 170, 242)\" }}\r\n            >\r\n              <Trans>New Version</Trans>\r\n            </li>\r\n          )}\r\n        </ul>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default AboutDialog;\r\n","import { connect } from \"react-redux\";\r\nimport { handleSetting, handleAbout } from \"../../../store/actions\";\r\nimport { stateType } from \"../../../store\";\r\nimport AboutDialog from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    isSettingOpen: state.manager.isSettingOpen,\r\n    isAboutOpen: state.manager.isAboutOpen,\r\n    isNewWarning: state.manager.isNewWarning,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleSetting,\r\n  handleAbout,\r\n};\r\nexport default connect(mapStateToProps, actionCreator)(AboutDialog);\r\n","export const config = {\r\n  callback_url:\r\n    process.env.NODE_ENV === \"production\"\r\n      ? \"https://reader.960960.xyz\"\r\n      : \"http://localhost:3000\",\r\n  token_url:\r\n    process.env.NODE_ENV === \"production\"\r\n      ? \"http://localhost:3366\"\r\n      : \"http://localhost:3366\",\r\n  dropbox_client_id: \"vnc67byrssocvy1\",\r\n  googledrive_client_id:\r\n    \"99440516227-ifr1ann33f2j610i3ri17ej0i51c7m6e.apps.googleusercontent.com\",\r\n  onedrive_client_id: \"ac96f9bf-94f2-49c0-8418-999b919bc236\",\r\n};\r\nexport const driveList = [\r\n  {\r\n    id: 1,\r\n    name: \"Local\",\r\n    icon: \"local\",\r\n    url: \"\",\r\n  },\r\n  {\r\n    id: 2,\r\n    name: \"Dropbox\",\r\n    icon: \"dropbox\",\r\n    url: `https://www.dropbox.com/oauth2/authorize?response_type=token&client_id=${config.dropbox_client_id}&redirect_uri=${config.callback_url}`,\r\n  },\r\n\r\n  {\r\n    id: 3,\r\n    name: \"Google Drive\",\r\n    icon: \"googledrive\",\r\n    url: \"\",\r\n  },\r\n  // {\r\n  //   id: 4,\r\n  //   name: \"OneDrive\",\r\n  //   icon: \"onedrive\",\r\n  //   url: `https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=${config.onedrive_client_id}&scope=files.readwrite offline_access&response_type=code&redirect_uri=${config.callback_url}`,\r\n  // },\r\n  {\r\n    id: 5,\r\n    name: \"WebDav\",\r\n    icon: \"webdav\",\r\n    url: \"\",\r\n  },\r\n];\r\n","import { restore } from \"./restoreUtil\";\r\nimport StorageUtil from \"../serviceUtils/storageUtil\";\r\n\r\nvar Dropbox = (window as any).Dropbox;\r\n\r\nclass DropboxUtil {\r\n  static UploadFile(blob: any) {\r\n    return new Promise<boolean>((resolve, reject) => {\r\n      var ACCESS_TOKEN = StorageUtil.getReaderConfig(\"dropbox_token\") || \"\";\r\n      var dbx = new Dropbox.Dropbox({ accessToken: ACCESS_TOKEN });\r\n      const file = new File([blob], \"data.zip\");\r\n      let date = new Date().getTime();\r\n      dbx\r\n        .filesUpload({\r\n          path: `/${date}/data.zip`,\r\n          contents: file,\r\n        })\r\n        .then(function (response: any) {\r\n          console.log(response, \"上传成功\");\r\n          resolve(true);\r\n        })\r\n        .catch(function (error: any) {\r\n          console.error(error, \"上传失败\");\r\n          resolve(false);\r\n        });\r\n    });\r\n  }\r\n  static DownloadFile() {\r\n    return new Promise<boolean>((resolve, reject) => {\r\n      var ACCESS_TOKEN = StorageUtil.getReaderConfig(\"dropbox_token\") || \"\";\r\n      var dbx = new Dropbox.Dropbox({ accessToken: ACCESS_TOKEN });\r\n      dbx\r\n        .filesListFolder({ path: \"\" })\r\n        .then(function (response) {\r\n          let folderArr: string[] = [];\r\n          response.result.entries.forEach((item) => {\r\n            if (!isNaN(parseInt(item.name))) folderArr.push(item.name);\r\n          });\r\n          let folder = folderArr.sort().reverse()[0];\r\n          dbx\r\n            .filesDownload({\r\n              path: `/${folder}/data.zip`,\r\n            })\r\n            .then(async (data: any) => {\r\n              let file = data.result.fileBlob;\r\n              file.lastModifiedDate = new Date();\r\n              file.name = \"data.zip\";\r\n              let result = await restore(file);\r\n              if (result) {\r\n                resolve(true);\r\n              } else {\r\n                resolve(false);\r\n              }\r\n            })\r\n            .catch(function (error: any) {\r\n              console.error(error);\r\n              resolve(false);\r\n            });\r\n        })\r\n        .catch(function (error) {\r\n          console.error(error);\r\n        });\r\n    });\r\n  }\r\n}\r\n\r\nexport default DropboxUtil;\r\n","import { restore } from \"./restoreUtil\";\r\nimport StorageUtil from \"../serviceUtils/storageUtil\";\r\n\r\nclass WebdavUtil {\r\n  static UploadFile = async (file: any) => {\r\n    return new Promise<boolean>(async (resolve, reject) => {\r\n      const { createClient } = window.require(\"webdav\");\r\n      let { url, username, password } = JSON.parse(\r\n        StorageUtil.getReaderConfig(\"webdav_token\") || \"\"\r\n      );\r\n      const client = createClient(url, {\r\n        username,\r\n        password,\r\n      });\r\n      var wfs = window.require(\"webdav-fs\")(url, {\r\n        username: username,\r\n        password: password,\r\n      });\r\n      if ((await client.exists(\"/KoodoReader\")) === false) {\r\n        await client.createDirectory(\"/KoodoReader\");\r\n      }\r\n      wfs.writeFile(\"/KoodoReader/data.zip\", file, \"binary\", function (err) {\r\n        console.log(err);\r\n        if (err) resolve(false);\r\n        let year = new Date().getFullYear(),\r\n          month = new Date().getMonth() + 1,\r\n          day = new Date().getDate();\r\n        client\r\n          .copyFile(\r\n            \"/KoodoReader/data.zip\",\r\n            \"/KoodoReader/\" +\r\n              `${year}-${month <= 9 ? \"0\" + month : month}-${\r\n                day <= 9 ? \"0\" + day : day\r\n              }.zip`\r\n          )\r\n          .then(() => {\r\n            resolve(true);\r\n          })\r\n          .catch(() => {\r\n            resolve(false);\r\n          });\r\n      });\r\n    });\r\n  };\r\n  static DownloadFile = async () => {\r\n    return new Promise<boolean>(async (resolve, reject) => {\r\n      const fs = window.require(\"fs\");\r\n      const path = window.require(\"path\");\r\n      const { createClient } = window.require(\"webdav\");\r\n      const { ipcRenderer } = window.require(\"electron\");\r\n      const dirPath = ipcRenderer.sendSync(\"user-data\", \"ping\");\r\n      const request = window.require(\"request\");\r\n      let { url, username, password } = JSON.parse(\r\n        StorageUtil.getReaderConfig(\"webdav_token\") || \"\"\r\n      );\r\n      const client = createClient(url, {\r\n        username,\r\n        password,\r\n      });\r\n      if ((await client.exists(\"/KoodoReader/data.zip\")) === false) {\r\n        resolve(false);\r\n      }\r\n      const downloadLink: string = client.getFileDownloadLink(\r\n        \"/KoodoReader/data.zip\"\r\n      );\r\n      let stream = fs.createWriteStream(path.join(dirPath, `data.zip`));\r\n      request(downloadLink)\r\n        .pipe(stream)\r\n        .on(\"close\", async (err) => {\r\n          if (err) {\r\n            console.log(err);\r\n            resolve(false);\r\n          } else {\r\n            var data = fs.readFileSync(path.join(dirPath, `data.zip`));\r\n            let blobTemp: any = new Blob([data], { type: \"application/zip\" });\r\n            let fileTemp = new File([blobTemp], \"data.zip\", {\r\n              lastModified: new Date().getTime(),\r\n              type: blobTemp.type,\r\n            });\r\n            let result = await restore(fileTemp);\r\n            if (!result) resolve(false);\r\n            try {\r\n              const fs_extra = window.require(\"fs-extra\");\r\n              fs_extra.remove(path.join(dirPath, `data.zip`), (error: any) => {\r\n                if (error) resolve(false);\r\n                resolve(true);\r\n              });\r\n            } catch (e) {\r\n              console.log(\"error removing \", path.join(dirPath, `data.zip`));\r\n              resolve(false);\r\n            }\r\n          }\r\n        });\r\n    });\r\n  };\r\n}\r\n\r\nexport default WebdavUtil;\r\n","import React, { Component } from \"react\";\r\nimport \"./tokenDialog.css\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { TokenDialogProps, TokenDialogState } from \"./interface\";\r\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\r\nimport toast from \"react-hot-toast\";\r\nimport { openExternalUrl } from \"../../../utils/serviceUtils/urlUtil\";\r\nclass TokenDialog extends Component<TokenDialogProps, TokenDialogState> {\r\n  constructor(props: TokenDialogProps) {\r\n    super(props);\r\n    this.state = { isNew: false };\r\n  }\r\n\r\n  handleCancel = () => {\r\n    this.props.handleTokenDialog(false);\r\n  };\r\n  handleTokenComfirm = () => {\r\n    let token: string = (\r\n      document.querySelector(\".token-dialog-token-box\") as HTMLTextAreaElement\r\n    ).value;\r\n    StorageUtil.setReaderConfig(`${this.props.driveName}_token`, token);\r\n    this.props.handleTokenDialog(false);\r\n    toast.success(this.props.t(\"Add Successfully\"));\r\n  };\r\n  handleDavComfirm = () => {\r\n    let url: string = (\r\n      document.querySelector(\".token-dialog-url-box\") as HTMLTextAreaElement\r\n    ).value;\r\n    let username: string = (\r\n      document.querySelector(\r\n        \".token-dialog-username-box\"\r\n      ) as HTMLTextAreaElement\r\n    ).value;\r\n    let password: string = (\r\n      document.querySelector(\r\n        \".token-dialog-password-box\"\r\n      ) as HTMLTextAreaElement\r\n    ).value;\r\n    StorageUtil.setReaderConfig(\r\n      `${this.props.driveName}_token`,\r\n      JSON.stringify({ url, username, password })\r\n    );\r\n    this.props.handleTokenDialog(false);\r\n    toast.success(this.props.t(\"Add Successfully\"));\r\n  };\r\n  handleJump = (url: string) => {\r\n    openExternalUrl(url);\r\n  };\r\n  render() {\r\n    return (\r\n      <div className=\"token-dialog-container\">\r\n        <div className=\"token-dialog-box\">\r\n          <div className=\"token-dialog-title\">\r\n            <Trans>Authorize</Trans>\r\n            &nbsp;\r\n            {this.props.driveName}&nbsp;\r\n            <Trans>Token</Trans>\r\n          </div>\r\n          {this.props.driveName === \"webdav\" ? (\r\n            <>\r\n              <div\r\n                className=\"token-dialog-info-text\"\r\n                style={\r\n                  StorageUtil.getReaderConfig(\"lang\") === \"en\"\r\n                    ? { fontSize: \"14px\" }\r\n                    : {}\r\n                }\r\n              >\r\n                <Trans>Webdav Info</Trans>\r\n              </div>\r\n              <input\r\n                type=\"text\"\r\n                name=\"username\"\r\n                placeholder={this.props.t(\"Server Address\")}\r\n                id=\"token-dialog-url-box\"\r\n                className=\"token-dialog-url-box\"\r\n              />\r\n              <input\r\n                type=\"text\"\r\n                name=\"username\"\r\n                placeholder={this.props.t(\"Username\")}\r\n                id=\"token-dialog-username-box\"\r\n                className=\"token-dialog-username-box\"\r\n              />\r\n              <input\r\n                type=\"text\"\r\n                name=\"username\"\r\n                placeholder={this.props.t(\"Password\")}\r\n                id=\"token-dialog-password-box\"\r\n                className=\"token-dialog-password-box\"\r\n              />\r\n            </>\r\n          ) : (\r\n            <>\r\n              <div\r\n                className=\"token-dialog-info-text\"\r\n                style={\r\n                  StorageUtil.getReaderConfig(\"lang\") === \"en\"\r\n                    ? { fontSize: \"14px\" }\r\n                    : {}\r\n                }\r\n              >\r\n                <Trans>\r\n                  Please authorize your account, and fill the following box with\r\n                  the token\r\n                </Trans>\r\n              </div>\r\n              <div\r\n                className=\"token-dialog-link-text\"\r\n                onClick={() => {\r\n                  this.handleJump(this.props.url);\r\n                }}\r\n              >\r\n                <Trans>Authorize</Trans>\r\n              </div>\r\n              <textarea className=\"token-dialog-token-box\" />\r\n            </>\r\n          )}\r\n\r\n          <div\r\n            className=\"token-dialog-cancel\"\r\n            onClick={() => {\r\n              this.handleCancel();\r\n            }}\r\n          >\r\n            <Trans>Cancel</Trans>\r\n          </div>\r\n          <div\r\n            className=\"token-dialog-comfirm\"\r\n            onClick={() => {\r\n              if (this.props.driveName === \"webdav\") {\r\n                this.handleDavComfirm();\r\n              } else {\r\n                this.handleTokenComfirm();\r\n              }\r\n            }}\r\n          >\r\n            <Trans>Confirm</Trans>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default TokenDialog;\r\n","import { connect } from \"react-redux\";\r\nimport { handleTokenDialog } from \"../../../store/actions\";\r\nimport { stateType } from \"../../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport TokenDialog from \"./component\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    isOpenDeleteDialog: state.book.isOpenDeleteDialog,\r\n    currentBook: state.book.currentBook,\r\n    bookmarks: state.reader.bookmarks,\r\n    notes: state.reader.notes,\r\n    digests: state.reader.digests,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleTokenDialog,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(TokenDialog as any));\r\n","import React from \"react\";\r\nimport \"./backupDialog.css\";\r\nimport { driveList } from \"../../../constants/driveList\";\r\nimport { backup } from \"../../../utils/syncUtils/backupUtil\";\r\nimport { restore } from \"../../../utils/syncUtils/restoreUtil\";\r\nimport { Trans } from \"react-i18next\";\r\nimport DropboxUtil from \"../../../utils/syncUtils/dropbox\";\r\nimport WebdavUtil from \"../../../utils/syncUtils/webdav\";\r\nimport { BackupDialogProps, BackupDialogState } from \"./interface\";\r\nimport TokenDialog from \"../tokenDialog\";\r\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\r\nimport Lottie from \"react-lottie\";\r\nimport animationSuccess from \"../../../assets/lotties/success.json\";\r\nimport FileSaver from \"file-saver\";\r\nimport toast from \"react-hot-toast\";\r\nimport { isElectron } from \"react-device-detect\";\r\nconst successOptions = {\r\n  loop: false,\r\n  autoplay: true,\r\n  animationData: animationSuccess,\r\n  rendererSettings: {\r\n    preserveAspectRatio: \"xMidYMid slice\",\r\n  },\r\n};\r\nclass BackupDialog extends React.Component<\r\n  BackupDialogProps,\r\n  BackupDialogState\r\n> {\r\n  constructor(props: BackupDialogProps) {\r\n    super(props);\r\n    this.state = {\r\n      currentStep: 0,\r\n      isBackup: \"\",\r\n      currentDrive: 0,\r\n    };\r\n  }\r\n  handleClose = () => {\r\n    this.props.handleBackupDialog(false);\r\n  };\r\n\r\n  handleFinish = () => {\r\n    this.setState({ currentStep: 2 });\r\n    this.props.handleLoadingDialog(false);\r\n    this.showMessage(\"Excute Successfully\");\r\n    this.props.handleFetchBooks();\r\n  };\r\n  handleRestoreToLocal = async (event: any) => {\r\n    event.preventDefault();\r\n    this.props.handleLoadingDialog(true);\r\n    let result = await restore(event.target.files[0]);\r\n    if (result) {\r\n      this.handleFinish();\r\n    }\r\n  };\r\n  showMessage = (message: string) => {\r\n    toast(this.props.t(message));\r\n  };\r\n  handleDrive = (index: number) => {\r\n    let year = new Date().getFullYear(),\r\n      month = new Date().getMonth() + 1,\r\n      day = new Date().getDate();\r\n    this.setState({ currentDrive: index }, async () => {\r\n      switch (index) {\r\n        case 0:\r\n          let blob: Blob | boolean = await backup(\r\n            this.props.books,\r\n            this.props.notes,\r\n            this.props.bookmarks,\r\n            false\r\n          );\r\n          if (!blob) {\r\n            this.showMessage(\"Backup Failed\");\r\n          }\r\n          FileSaver.saveAs(\r\n            blob as Blob,\r\n            `${year}-${month <= 9 ? \"0\" + month : month}-${\r\n              day <= 9 ? \"0\" + day : day\r\n            }.zip`\r\n          );\r\n          this.handleFinish();\r\n          break;\r\n        case 1:\r\n          if (!StorageUtil.getReaderConfig(\"dropbox_token\")) {\r\n            this.props.handleTokenDialog(true);\r\n            break;\r\n          }\r\n\r\n          if (this.state.isBackup === \"yes\") {\r\n            this.showMessage(\"Uploading, please wait\");\r\n            this.props.handleLoadingDialog(true);\r\n\r\n            let blob: Blob | boolean = await backup(\r\n              this.props.books,\r\n              this.props.notes,\r\n              this.props.bookmarks,\r\n              false\r\n            );\r\n            if (!blob) {\r\n              this.showMessage(\"Backup Failed\");\r\n              this.props.handleLoadingDialog(false);\r\n            }\r\n            let result = await DropboxUtil.UploadFile(blob);\r\n            if (result) {\r\n              this.handleFinish();\r\n            } else {\r\n              this.showMessage(\"Upload failed, check your connection\");\r\n            }\r\n          } else {\r\n            this.props.handleLoadingDialog(true);\r\n            this.showMessage(\"Downloading, please wait\");\r\n            let result = await DropboxUtil.DownloadFile();\r\n            if (result) {\r\n              this.handleFinish();\r\n            } else {\r\n              this.showMessage(\"Download failed,network problem or no backup\");\r\n              this.props.handleLoadingDialog(false);\r\n            }\r\n          }\r\n\r\n          break;\r\n        case 2:\r\n          this.showMessage(\"Coming Soon\");\r\n          break;\r\n\r\n        case 3:\r\n          if (!StorageUtil.getReaderConfig(\"webdav_token\")) {\r\n            this.props.handleTokenDialog(true);\r\n            break;\r\n          }\r\n          if (this.state.isBackup === \"yes\") {\r\n            this.showMessage(\"Uploading, please wait\");\r\n            this.props.handleLoadingDialog(true);\r\n\r\n            let blob: any = await backup(\r\n              this.props.books,\r\n              this.props.notes,\r\n              this.props.bookmarks,\r\n              false\r\n            );\r\n            if (!blob) {\r\n              this.showMessage(\"Backup Failed\");\r\n              this.props.handleLoadingDialog(false);\r\n            }\r\n\r\n            let result = await WebdavUtil.UploadFile(\r\n              new File([blob], \"data.zip\", {\r\n                lastModified: new Date().getTime(),\r\n                type: blob.type,\r\n              })\r\n            );\r\n            if (result) {\r\n              this.handleFinish();\r\n            } else {\r\n              this.showMessage(\"Upload failed, check your connection\");\r\n              this.props.handleLoadingDialog(false);\r\n            }\r\n          } else {\r\n            this.showMessage(\"Downloading, please wait\");\r\n            this.props.handleLoadingDialog(true);\r\n\r\n            let result = await WebdavUtil.DownloadFile();\r\n            if (!result) {\r\n              this.showMessage(\"Download failed,network problem or no backup\");\r\n            } else {\r\n              this.handleFinish();\r\n            }\r\n          }\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    });\r\n  };\r\n  render() {\r\n    const renderDrivePage = () => {\r\n      return driveList.map((item, index) => {\r\n        return (\r\n          <li\r\n            key={item.id}\r\n            className=\"backup-page-list-item\"\r\n            onClick={() => {\r\n              //webdav is avavilible on desktop\r\n              if (index === 3 && !isElectron) {\r\n                toast(\r\n                  this.props.t(\r\n                    \"Koodo Reader's web version are limited by the browser, for more powerful features, please download the desktop version.\"\r\n                  )\r\n                );\r\n                return;\r\n              }\r\n              this.handleDrive(index);\r\n            }}\r\n            style={index !== 2 ? { opacity: 1 } : {}}\r\n          >\r\n            <div className=\"backup-page-list-item-container\">\r\n              <span\r\n                className={`icon-${item.icon} backup-page-list-icon`}\r\n              ></span>\r\n              {StorageUtil.getReaderConfig(\"dropbox_token\") && index === 1 ? (\r\n                <div\r\n                  className=\"backup-page-list-title\"\r\n                  onClick={() => {\r\n                    StorageUtil.setReaderConfig(\"dropbox_token\", \"\");\r\n                    this.showMessage(\"Unauthorize Successfully\");\r\n                  }}\r\n                  style={{ color: \"rgb(0, 120, 212)\" }}\r\n                >\r\n                  <Trans>Unauthorize</Trans>\r\n                </div>\r\n              ) : StorageUtil.getReaderConfig(\"webdav_token\") && index === 3 ? (\r\n                <div\r\n                  className=\"backup-page-list-title\"\r\n                  onClick={() => {\r\n                    StorageUtil.setReaderConfig(\"webdav_token\", \"\");\r\n                    this.showMessage(\"Unauthorize Successfully\");\r\n                  }}\r\n                  style={{ color: \"rgb(0, 120, 212)\" }}\r\n                >\r\n                  <Trans>Unauthorize</Trans>\r\n                </div>\r\n              ) : (\r\n                <div className=\"backup-page-list-title\">\r\n                  <Trans>{item.name}</Trans>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </li>\r\n        );\r\n      });\r\n    };\r\n\r\n    const dialogProps = {\r\n      driveName: driveList[this.state.currentDrive!].icon,\r\n      url: driveList[this.state.currentDrive!].url,\r\n    };\r\n\r\n    return (\r\n      <div className=\"backup-page-container\">\r\n        {this.props.isOpenTokenDialog ? <TokenDialog {...dialogProps} /> : null}\r\n        {this.state.currentStep === 0 ? (\r\n          <div className=\"backup-page-title\">\r\n            <Trans>Choose your operation</Trans>\r\n          </div>\r\n        ) : this.state.currentStep === 1 && this.state.isBackup === \"yes\" ? (\r\n          <div className=\"backup-page-title\">\r\n            <Trans>Where to keep your data?</Trans>\r\n          </div>\r\n        ) : this.state.currentStep === 1 && this.state.isBackup === \"no\" ? (\r\n          <div className=\"backup-page-title\">\r\n            <Trans>Where is your data?</Trans>\r\n          </div>\r\n        ) : null}\r\n        {this.state.currentStep === 0 ? (\r\n          <div className=\"backup-page-option\">\r\n            <div\r\n              className={\r\n                this.state.isBackup === \"yes\"\r\n                  ? \"backup-page-backup active\"\r\n                  : \"backup-page-backup\"\r\n              }\r\n              onClick={() => {\r\n                this.setState({ isBackup: \"yes\" });\r\n              }}\r\n            >\r\n              <span className=\"icon-backup\"></span>\r\n              <div style={{ lineHeight: 1.25 }}>\r\n                <Trans>Backup</Trans>\r\n              </div>\r\n            </div>\r\n\r\n            <div\r\n              className={\r\n                this.state.isBackup === \"no\"\r\n                  ? \"backup-page-backup active\"\r\n                  : \"backup-page-backup\"\r\n              }\r\n              onClick={() => {\r\n                this.setState({ isBackup: \"no\" });\r\n              }}\r\n            >\r\n              <span className=\"icon-restore\"></span>\r\n              <div>\r\n                <Trans>Restore</Trans>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ) : this.state.currentStep === 1 ? (\r\n          <div className=\"backup-page-drive-container\">\r\n            <div>{renderDrivePage()}</div>\r\n            {this.state.isBackup === \"no\" ? (\r\n              <input\r\n                type=\"file\"\r\n                id=\"restore-file\"\r\n                accept=\"application/zip\"\r\n                className=\"restore-file\"\r\n                name=\"file\"\r\n                multiple={false}\r\n                onChange={(event) => {\r\n                  this.handleRestoreToLocal(event);\r\n                }}\r\n              />\r\n            ) : null}\r\n          </div>\r\n        ) : (\r\n          <div className=\"backup-page-finish-container\">\r\n            <div className=\"backup-page-finish\">\r\n              <Lottie options={successOptions} height={80} width={80} />\r\n              <div className=\"backup-page-finish-text\">\r\n                <Trans>\r\n                  {this.state.isBackup === \"yes\"\r\n                    ? \"Backup Successfully\"\r\n                    : \"Restore Successfully\"}\r\n                </Trans>\r\n              </div>\r\n              {this.state.isBackup ? null : (\r\n                <div style={{ opacity: 0.6 }}>\r\n                  <Trans>Try refresh or restart</Trans>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n        {this.state.isBackup === \"yes\" && this.state.currentStep === 0 ? (\r\n          <div className=\"backup-page-backup-selector\"></div>\r\n        ) : null}\r\n        {this.state.isBackup === \"no\" && this.state.currentStep === 0 ? (\r\n          <div\r\n            className=\"backup-page-backup-selector\"\r\n            style={{ marginLeft: \"252px\" }}\r\n          ></div>\r\n        ) : null}\r\n        <div\r\n          className=\"backup-page-close-icon\"\r\n          onClick={() => {\r\n            this.handleClose();\r\n          }}\r\n        >\r\n          <span className=\"icon-close backup-close-icon\"></span>\r\n        </div>\r\n\r\n        {this.state.currentStep === 1 ? (\r\n          <div\r\n            className=\"backup-page-next\"\r\n            onClick={() => {\r\n              this.setState({ currentStep: 0 });\r\n            }}\r\n          >\r\n            <Trans>Last Step</Trans>\r\n          </div>\r\n        ) : this.state.currentStep === 0 ? (\r\n          <div\r\n            className=\"backup-page-next\"\r\n            onClick={() => {\r\n              this.setState({ currentStep: 1 });\r\n            }}\r\n            style={this.state.isBackup ? {} : { display: \"none\" }}\r\n          >\r\n            <Trans>Next Step</Trans>\r\n          </div>\r\n        ) : null}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default BackupDialog;\r\n","import {\r\n  handleBackupDialog,\r\n  handleTokenDialog,\r\n  handleLoadingDialog,\r\n  handleTipDialog,\r\n  handleFetchBooks,\r\n} from \"../../../store/actions\";\r\nimport { connect } from \"react-redux\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport { stateType } from \"../../../store\";\r\nimport BackupDialog from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    bookmarks: state.reader.bookmarks,\r\n    notes: state.reader.notes,\r\n    digests: state.reader.digests,\r\n    isOpenTokenDialog: state.backupPage.isOpenTokenDialog,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleBackupDialog,\r\n  handleTokenDialog,\r\n  handleLoadingDialog,\r\n  handleTipDialog,\r\n  handleFetchBooks,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(BackupDialog));\r\n","export const dropdownList = [\r\n  {\r\n    id: 1,\r\n    title: \"Font Family\",\r\n    value: \"fontFamily\",\r\n    option: [\r\n      \"Built-in font\",\r\n      \"Helvetica\",\r\n      \"Times New Roman\",\r\n      \"Microsoft YaHei\",\r\n      \"SimSun\",\r\n      \"SimHei\",\r\n      \"Arial\",\r\n    ],\r\n  },\r\n  {\r\n    id: 2,\r\n    title: \"Line Height\",\r\n    value: \"lineHeight\",\r\n    option: [\"1\", \"1.25\", \"1.5\", \"1.75\", \"2\"],\r\n  },\r\n  {\r\n    id: 3,\r\n    title: \"Text Align\",\r\n    value: \"textAlign\",\r\n    option: [\"Left\", \"Justify\", \"Right\"],\r\n  },\r\n  {\r\n    id: 4,\r\n    title: \"Chinese Conversion\",\r\n    value: \"convertChinese\",\r\n    option: [\r\n      \"Default\",\r\n      \"Simplified To Traditional\",\r\n      \"Traditional To Simplified\",\r\n    ],\r\n  },\r\n];\r\nexport const speedList = {\r\n  id: 3,\r\n  title: \"Speed\",\r\n  value: \"speed\",\r\n  option: [\r\n    \"0.1\",\r\n    \"0.2\",\r\n    \"0.3\",\r\n    \"0.4\",\r\n    \"0.5\",\r\n    \"0.75\",\r\n    \"1\",\r\n    \"1.25\",\r\n    \"1.5\",\r\n    \"1.75\",\r\n    \"2\",\r\n    \"3\",\r\n    \"4\",\r\n    \"5\",\r\n  ],\r\n};\r\n","export const settingList = [\r\n  {\r\n    isElectron: false,\r\n    title: \"Turn on touch screen mode\",\r\n    desc: \"Gesture and UI optimization for touch screen\",\r\n    propName: \"isTouch\",\r\n  },\r\n  {\r\n    isElectron: false,\r\n    title: \"Prevent accidental trigger\",\r\n    desc: \"Reader menu will not be triggered by hovering but clicking on the area\",\r\n    propName: \"isPreventTrigger\",\r\n  },\r\n  {\r\n    isElectron: true,\r\n    title: \"Import books as link\",\r\n    desc: \"The imported books will not be copied to library, only linked to the original book path\",\r\n    propName: \"isImportPath\",\r\n  },\r\n  {\r\n    isElectron: true,\r\n    title: \"Merge reader into Word\",\r\n    desc: \"Get rid of window frame, make reader hide into Word or any text editor, and can't be detected. You need to set up the reader's position, size and style first.\",\r\n    propName: \"isMergeWord\",\r\n  },\r\n  {\r\n    isElectron: false,\r\n    title: \"Auto open last-read book\",\r\n    desc: \"The book that you read from last time will be open automatically when launching\",\r\n    propName: \"isOpenBook\",\r\n  },\r\n  {\r\n    isElectron: true,\r\n    title: \"Auto open book in fullscreen\",\r\n    desc: \"Reader window will be maximized to fit the screen when opening a book\",\r\n    propName: \"isAutoFullscreen\",\r\n  },\r\n  {\r\n    isElectron: false,\r\n    title: \"Auto expand content\",\r\n    desc: \"All the folded content will be expanded in the navigation panel\",\r\n    propName: \"isExpandContent\",\r\n  },\r\n  {\r\n    isElectron: true,\r\n    title: \"Disable screen blanking\",\r\n    desc: \"When Koodo is running, your computer won't enter sleep mode\",\r\n    propName: \"isPreventSleep\",\r\n  },\r\n  {\r\n    isElectron: true,\r\n    title: \"Open book without adding it to library\",\r\n    desc: \"When opening books in the file manager with Koodo, the opened books won't be added to the library\",\r\n    propName: \"isPreventAdd\",\r\n  },\r\n  {\r\n    isElectron: false,\r\n    title: \"Open books in the main window\",\r\n    desc: \"Book won't be opened in a seperate window but directly opened in the main window\",\r\n    propName: \"isOpenInMain\",\r\n  },\r\n  {\r\n    isElectron: true,\r\n    title: \"Disable update notification\",\r\n    propName: \"isDisableUpdate\",\r\n  },\r\n  {\r\n    isElectron: false,\r\n    title: \"Disable analytics service\",\r\n    propName: \"isDisableAnalytics\",\r\n  },\r\n  {\r\n    isElectron: false,\r\n    title: \"Use first page as PDF cover\",\r\n    propName: \"isPDFCover\",\r\n  },\r\n  {\r\n    isElectron: true,\r\n    title: \"Open url with built-in browser\",\r\n    propName: \"isUseBuiltIn\",\r\n  },\r\n];\r\nexport const langList = [\r\n  { label: \"简体中文\", value: \"zh\" },\r\n  { label: \"繁體中文\", value: \"cht\" },\r\n  { label: \"English\", value: \"en\" },\r\n  { label: \"русский\", value: \"ru\" },\r\n  { label: \"Español\", value: \"es\" },\r\n  { label: \"Français\", value: \"fr\" },\r\n  { label: \"Português\", value: \"ptBR\" },\r\n  { label: \"فارسی\", value: \"fa\" },\r\n  { label: \"日本語\", value: \"jp\" },\r\n];\r\n\r\nexport const searchList = [\r\n  { label: \"Google\", value: \"google\" },\r\n  { label: \"Baidu\", value: \"baidu\" },\r\n  { label: \"Bing\", value: \"bing\" },\r\n  { label: \"DuckDuckGo\", value: \"duckduckgo\" },\r\n  { label: \"Yandex\", value: \"yandex\" },\r\n  { label: \"Yahoo\", value: \"yahoo\" },\r\n  { label: \"Naver\", value: \"naver\" },\r\n  { label: \"Baidu Baike\", value: \"baike\" },\r\n  { label: \"Wikipedia\", value: \"wiki\" },\r\n];\r\nexport const skinList = [\r\n  { label: \"Light Mode\", value: \"light\" },\r\n  { label: \"Night Mode\", value: \"night\" },\r\n  { label: \"Follow OS\", value: \"system\" },\r\n];\r\n\r\nexport const readerSettingList = [\r\n  {\r\n    title: \"Sliding Animation\",\r\n    propName: \"isSliding\",\r\n  },\r\n  {\r\n    title: \"Text Indent\",\r\n    propName: \"isIndent\",\r\n  },\r\n  {\r\n    title: \"Bold\",\r\n    propName: \"isBold\",\r\n  },\r\n  {\r\n    title: \"Italic\",\r\n    propName: \"isItalic\",\r\n  },\r\n  {\r\n    title: \"Text underline\",\r\n    propName: \"isUnderline\",\r\n  },\r\n  {\r\n    title: \"Text shadow\",\r\n    propName: \"isShadow\",\r\n  },\r\n  {\r\n    title: \"Invert color\",\r\n    propName: \"isInvert\",\r\n  },\r\n  {\r\n    title: \"Hide footer\",\r\n    propName: \"isHideFooter\",\r\n  },\r\n  {\r\n    title: \"Hide header\",\r\n    propName: \"isHideHeader\",\r\n  },\r\n  {\r\n    title: \"Hide mimical background\",\r\n    propName: \"isHideBackground\",\r\n  },\r\n  {\r\n    title: \"Hide navigation button\",\r\n    propName: \"isHidePageButton\",\r\n  },\r\n  {\r\n    title: \"Hide menu button\",\r\n    propName: \"isHideMenuButton\",\r\n  },\r\n];\r\n","export const backgroundList = [\r\n  \"rgba(255,255,255,1)\",\r\n  \"rgba(44,47,49,1)\",\r\n  \"rgba(233, 216, 188,1)\",\r\n  \"rgba(197, 231, 207,1)\",\r\n];\r\nexport const textList = [\r\n  \"rgba(0,0,0,1)\",\r\n  \"rgba(255,255,255,1)\",\r\n  \"rgba(89, 68, 41,1)\",\r\n  \"rgba(54, 80, 62,1)\",\r\n];\r\nexport const themeList = [\r\n  {\r\n    id: 0,\r\n    color: \"rgba(75, 75, 75, 1)\",\r\n    name: \"default\",\r\n    title: \"Default\",\r\n  },\r\n  {\r\n    id: 1,\r\n    color: \"rgba(1, 121, 202, 1)\",\r\n    name: \"blue\",\r\n    title: \"Blue\",\r\n  },\r\n  {\r\n    id: 2,\r\n    color: \"rgba(0, 143, 145, 1)\",\r\n    name: \"green\",\r\n    title: \"Green\",\r\n  },\r\n\r\n  {\r\n    id: 3,\r\n    color: \"rgba(241, 100, 100, 1)\",\r\n    name: \"red\",\r\n    title: \"Red\",\r\n  },\r\n  {\r\n    id: 4,\r\n    color: \"rgba(104, 103, 209, 1)\",\r\n    name: \"purple\",\r\n    title: \"Purple\",\r\n  },\r\n];\r\n","import React from \"react\";\r\nimport \"./settingDialog.css\";\r\nimport { SettingInfoProps, SettingInfoState } from \"./interface\";\r\nimport { Trans } from \"react-i18next\";\r\nimport i18n from \"../../../i18n\";\r\nimport { version } from \"../../../../package.json\";\r\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\r\nimport { changePath } from \"../../../utils/syncUtils/common\";\r\nimport { isElectron } from \"react-device-detect\";\r\nimport { dropdownList } from \"../../../constants/dropdownList\";\r\nimport { Tooltip } from \"react-tippy\";\r\nimport { restore } from \"../../../utils/syncUtils/restoreUtil\";\r\nimport {\r\n  settingList,\r\n  langList,\r\n  searchList,\r\n  skinList,\r\n} from \"../../../constants/settingList\";\r\nimport { themeList } from \"../../../constants/themeList\";\r\nimport _ from \"underscore\";\r\nimport toast from \"react-hot-toast\";\r\nimport { openExternalUrl } from \"../../../utils/serviceUtils/urlUtil\";\r\nclass SettingDialog extends React.Component<\r\n  SettingInfoProps,\r\n  SettingInfoState\r\n> {\r\n  constructor(props: SettingInfoProps) {\r\n    super(props);\r\n    this.state = {\r\n      isTouch: StorageUtil.getReaderConfig(\"isTouch\") === \"yes\",\r\n      isImportPath: StorageUtil.getReaderConfig(\"isImportPath\") === \"yes\",\r\n      isMergeWord: StorageUtil.getReaderConfig(\"isMergeWord\") === \"yes\",\r\n      isPreventTrigger:\r\n        StorageUtil.getReaderConfig(\"isPreventTrigger\") === \"yes\",\r\n      isAutoFullscreen:\r\n        StorageUtil.getReaderConfig(\"isAutoFullscreen\") === \"yes\",\r\n      isPreventAdd: StorageUtil.getReaderConfig(\"isPreventAdd\") === \"yes\",\r\n      isOpenBook: StorageUtil.getReaderConfig(\"isOpenBook\") === \"yes\",\r\n      isExpandContent: StorageUtil.getReaderConfig(\"isExpandContent\") === \"yes\",\r\n      isPreventSleep: StorageUtil.getReaderConfig(\"isPreventSleep\") === \"yes\",\r\n      isOpenInMain: StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\",\r\n      isDisableUpdate: StorageUtil.getReaderConfig(\"isDisableUpdate\") === \"yes\",\r\n      appSkin: StorageUtil.getReaderConfig(\"appSkin\"),\r\n      isDisableAnalytics:\r\n        StorageUtil.getReaderConfig(\"isDisableAnalytics\") === \"yes\",\r\n      isUseBuiltIn: StorageUtil.getReaderConfig(\"isUseBuiltIn\") === \"yes\",\r\n      isPDFCover: StorageUtil.getReaderConfig(\"isPDFCover\") === \"yes\",\r\n      currentThemeIndex: _.findLastIndex(themeList, {\r\n        name: StorageUtil.getReaderConfig(\"themeColor\"),\r\n      }),\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    StorageUtil.getReaderConfig(\"systemFont\") &&\r\n      document\r\n        .getElementsByClassName(\"lang-setting-dropdown\")[0]\r\n        ?.children[\r\n          dropdownList[0].option.indexOf(\r\n            StorageUtil.getReaderConfig(\"systemFont\")\r\n          )\r\n        ]?.setAttribute(\"selected\", \"selected\");\r\n    document\r\n      .getElementsByClassName(\"lang-setting-dropdown\")[1]\r\n      ?.children[\r\n        langList\r\n          .map((item) => item.value)\r\n          .indexOf(\r\n            StorageUtil.getReaderConfig(\"lang\") ||\r\n              (navigator.language.indexOf(\"zh\") > -1 ? \"zh\" : \"en\")\r\n          )\r\n      ]?.setAttribute(\"selected\", \"selected\");\r\n    document.getElementsByClassName(\"lang-setting-dropdown\")[2]?.children[\r\n      _.findLastIndex(searchList, {\r\n        value:\r\n          StorageUtil.getReaderConfig(\"searchEngine\") ||\r\n          (navigator.language === \"zh-CN\" ? \"baidu\" : \"google\"),\r\n      })\r\n    ]?.setAttribute(\"selected\", \"selected\");\r\n    document.getElementsByClassName(\"lang-setting-dropdown\")[3]?.children[\r\n      _.findLastIndex(skinList, {\r\n        value: StorageUtil.getReaderConfig(\"appSkin\") || \"light\",\r\n      })\r\n    ]?.setAttribute(\"selected\", \"selected\");\r\n  }\r\n  handleRest = (bool: boolean) => {\r\n    toast.success(this.props.t(\"Change Successfully\"));\r\n  };\r\n  changeLanguage = (lng: string) => {\r\n    i18n.changeLanguage(lng);\r\n    StorageUtil.setReaderConfig(\"lang\", lng);\r\n  };\r\n  changeSearch = (searchEngine: string) => {\r\n    StorageUtil.setReaderConfig(\"searchEngine\", searchEngine);\r\n  };\r\n  changeSkin = (skin: string) => {\r\n    StorageUtil.setReaderConfig(\"appSkin\", skin);\r\n\r\n    if (\r\n      skin === \"night\" ||\r\n      (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\r\n        StorageUtil.getReaderConfig(\"isOSNight\") === \"yes\")\r\n    ) {\r\n      StorageUtil.setReaderConfig(\"backgroundColor\", \"rgba(44,47,49,1)\");\r\n      StorageUtil.setReaderConfig(\"textColor\", \"rgba(255,255,255,1)\");\r\n    } else if (\r\n      skin === \"light\" ||\r\n      (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\r\n        StorageUtil.getReaderConfig(\"isOSNight\") !== \"yes\")\r\n    ) {\r\n      StorageUtil.setReaderConfig(\"backgroundColor\", \"rgba(255,255,255,1)\");\r\n      StorageUtil.setReaderConfig(\"textColor\", \"rgba(0,0,0,1)\");\r\n    }\r\n\r\n    if (isElectron) {\r\n      toast(this.props.t(\"Try refresh or restart\"));\r\n    } else {\r\n      window.location.reload();\r\n    }\r\n  };\r\n  changeFont = (font: string) => {\r\n    let body = document.getElementsByTagName(\"body\")[0];\r\n    body?.setAttribute(\"style\", \"font-family:\" + font + \"!important\");\r\n    StorageUtil.setReaderConfig(\"systemFont\", font);\r\n  };\r\n  handleJump = (url: string) => {\r\n    openExternalUrl(url);\r\n  };\r\n  handleSetting = (stateName: string) => {\r\n    this.setState({ [stateName]: !this.state[stateName] } as any);\r\n    StorageUtil.setReaderConfig(\r\n      stateName,\r\n      this.state[stateName] ? \"no\" : \"yes\"\r\n    );\r\n    this.handleRest(this.state[stateName]);\r\n  };\r\n  syncFromLocation = async () => {\r\n    const fs = window.require(\"fs\");\r\n    const path = window.require(\"path\");\r\n    const { zip } = window.require(\"zip-a-folder\");\r\n    let storageLocation = localStorage.getItem(\"storageLocation\")\r\n      ? localStorage.getItem(\"storageLocation\")\r\n      : window\r\n          .require(\"electron\")\r\n          .ipcRenderer.sendSync(\"storage-location\", \"ping\");\r\n    let sourcePath = path.join(storageLocation, \"config\");\r\n    let outPath = path.join(storageLocation, \"config.zip\");\r\n    await zip(sourcePath, outPath);\r\n\r\n    var data = fs.readFileSync(outPath);\r\n\r\n    let blobTemp = new Blob([data], { type: \"application/epub+zip\" });\r\n    let fileTemp = new File([blobTemp], \"config.zip\", {\r\n      lastModified: new Date().getTime(),\r\n      type: blobTemp.type,\r\n    });\r\n\r\n    let result = await restore(fileTemp, true);\r\n    if (result) {\r\n      toast.success(this.props.t(\"Change Successfully\"));\r\n    } else {\r\n      toast.error(this.props.t(\"Change Failed\"));\r\n    }\r\n  };\r\n  handleChangeLocation = async () => {\r\n    const { ipcRenderer } = window.require(\"electron\");\r\n    const path = await ipcRenderer.invoke(\"change-path\");\r\n    if (!path.filePaths[0]) {\r\n      return;\r\n    }\r\n    let result = await changePath(\r\n      localStorage.getItem(\"storageLocation\")\r\n        ? localStorage.getItem(\"storageLocation\")\r\n        : ipcRenderer.sendSync(\"storage-location\", \"ping\"),\r\n      path.filePaths[0]\r\n    );\r\n    if (result === 1) {\r\n      this.syncFromLocation();\r\n    } else if (result === 2) {\r\n      this.props.handleFetchBooks();\r\n      toast.success(this.props.t(\"Change Successfully\"));\r\n    } else {\r\n      toast.error(this.props.t(\"Change Failed\"));\r\n    }\r\n    localStorage.setItem(\"storageLocation\", path.filePaths[0]);\r\n    document.getElementsByClassName(\r\n      \"setting-dialog-location-title\"\r\n    )[0].innerHTML =\r\n      path.filePaths[0] ||\r\n      localStorage.getItem(\"storageLocation\") ||\r\n      ipcRenderer.sendSync(\"storage-location\", \"ping\");\r\n  };\r\n\r\n  handleTheme = (name: string, index: number) => {\r\n    this.setState({ currentThemeIndex: index });\r\n    StorageUtil.setReaderConfig(\"themeColor\", name);\r\n    if (isElectron) {\r\n      toast(this.props.t(\"Try refresh or restart\"));\r\n    } else {\r\n      window.location.reload();\r\n    }\r\n  };\r\n  handleMergeWord = () => {\r\n    if (this.state.isOpenInMain && !this.state.isMergeWord) {\r\n      toast(this.props.t(\"Please turn off open books in the main window\"));\r\n      return;\r\n    }\r\n    this.handleSetting(\"isMergeWord\");\r\n  };\r\n  handleOpenInMain = () => {\r\n    if (this.state.isMergeWord && !this.state.isOpenInMain) {\r\n      toast(this.props.t(\"Please turn off merge with word first\"));\r\n      return;\r\n    }\r\n    this.handleSetting(\"isOpenInMain\");\r\n  };\r\n  render() {\r\n    return (\r\n      <div className=\"setting-dialog-container\">\r\n        <p className=\"setting-dialog-title\">\r\n          <Trans>Setting</Trans>\r\n        </p>\r\n        <p className=\"setting-subtitle\">\r\n          <Trans>Version</Trans>\r\n          {version}\r\n          &nbsp;&nbsp;\r\n          <Trans>\r\n            {StorageUtil.getReaderConfig(\"appInfo\") === \"new\"\r\n              ? \"New Version Available\"\r\n              : StorageUtil.getReaderConfig(\"appInfo\") === \"stable\"\r\n              ? \"Latest Stable Version\"\r\n              : StorageUtil.getReaderConfig(\"appInfo\") === \"dev\"\r\n              ? \"Developer Version\"\r\n              : \"\"}\r\n          </Trans>\r\n        </p>\r\n        <div\r\n          className=\"setting-close-container\"\r\n          onClick={() => {\r\n            this.props.handleSetting(false);\r\n          }}\r\n        >\r\n          <span className=\"icon-close setting-close\"></span>\r\n        </div>\r\n\r\n        <div className=\"setting-dialog-info\">\r\n          {settingList.map((item, index) => {\r\n            return (\r\n              <div\r\n                style={\r\n                  item.isElectron ? (isElectron ? {} : { display: \"none\" }) : {}\r\n                }\r\n                key={item.propName}\r\n              >\r\n                <div className=\"setting-dialog-new-title\" key={item.title}>\r\n                  <span style={{ width: \"250px\" }}>\r\n                    <Trans>{item.title}</Trans>\r\n                  </span>\r\n\r\n                  <span\r\n                    className=\"single-control-switch\"\r\n                    onClick={() => {\r\n                      switch (item.propName) {\r\n                        case \"isMergeWord\":\r\n                          this.handleMergeWord();\r\n                          break;\r\n                        case \"isOpenInMain\":\r\n                          this.handleOpenInMain();\r\n                          break;\r\n                        default:\r\n                          this.handleSetting(item.propName);\r\n                          break;\r\n                      }\r\n                    }}\r\n                    style={this.state[item.propName] ? {} : { opacity: 0.6 }}\r\n                  >\r\n                    <span\r\n                      className=\"single-control-button\"\r\n                      style={\r\n                        this.state[item.propName]\r\n                          ? {\r\n                              transform: \"translateX(20px)\",\r\n                              transition: \"transform 0.5s ease\",\r\n                            }\r\n                          : {\r\n                              transform: \"translateX(0px)\",\r\n                              transition: \"transform 0.5s ease\",\r\n                            }\r\n                      }\r\n                    ></span>\r\n                  </span>\r\n                </div>\r\n                <p className=\"setting-option-subtitle\">\r\n                  <Trans>{item.desc}</Trans>\r\n                </p>\r\n              </div>\r\n            );\r\n          })}\r\n          <div className=\"setting-dialog-new-title\">\r\n            <Trans>Theme Color</Trans>\r\n            <ul className=\"theme-setting-container\">\r\n              {themeList.map((item, index) => (\r\n                <Tooltip\r\n                  key={item.id}\r\n                  title={this.props.t(item.title)}\r\n                  position=\"top\"\r\n                  trigger=\"mouseenter\"\r\n                >\r\n                  <li\r\n                    className={\r\n                      index === this.state.currentThemeIndex\r\n                        ? \"active-color theme-setting-item\"\r\n                        : \"theme-setting-item\"\r\n                    }\r\n                    onClick={() => {\r\n                      this.handleTheme(item.name, index);\r\n                    }}\r\n                    style={{ backgroundColor: item.color }}\r\n                  ></li>\r\n                </Tooltip>\r\n              ))}\r\n            </ul>\r\n          </div>\r\n\r\n          {isElectron && (\r\n            <>\r\n              <div className=\"setting-dialog-new-title\">\r\n                <Trans>Change storage location</Trans>\r\n\r\n                <span\r\n                  className=\"change-location-button\"\r\n                  onClick={() => {\r\n                    this.handleChangeLocation();\r\n                  }}\r\n                >\r\n                  <Trans>Change location</Trans>\r\n                </span>\r\n              </div>\r\n              <div className=\"setting-dialog-location-title\">\r\n                {localStorage.getItem(\"storageLocation\")\r\n                  ? localStorage.getItem(\"storageLocation\")\r\n                  : window\r\n                      .require(\"electron\")\r\n                      .ipcRenderer.sendSync(\"storage-location\", \"ping\")}\r\n              </div>\r\n            </>\r\n          )}\r\n\r\n          <div className=\"setting-dialog-new-title\">\r\n            <Trans>System Font</Trans>\r\n            <select\r\n              name=\"\"\r\n              className=\"lang-setting-dropdown\"\r\n              onChange={(event) => {\r\n                this.changeFont(event.target.value);\r\n              }}\r\n            >\r\n              {dropdownList[0].option.map((item) => (\r\n                <option value={item} key={item} className=\"lang-setting-option\">\r\n                  {this.props.t(item)}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n\r\n          <div className=\"setting-dialog-new-title\">\r\n            <Trans>Language</Trans>\r\n            <select\r\n              name=\"\"\r\n              className=\"lang-setting-dropdown\"\r\n              onChange={(event) => {\r\n                this.changeLanguage(event.target.value);\r\n              }}\r\n            >\r\n              {langList.map((item) => (\r\n                <option\r\n                  value={item.value}\r\n                  key={item.value}\r\n                  className=\"lang-setting-option\"\r\n                >\r\n                  {item.label}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n          <div className=\"setting-dialog-new-title\">\r\n            <Trans>Default search engine</Trans>\r\n            <select\r\n              name=\"\"\r\n              className=\"lang-setting-dropdown\"\r\n              onChange={(event) => {\r\n                this.changeSearch(event.target.value);\r\n              }}\r\n            >\r\n              {searchList.map((item) => (\r\n                <option\r\n                  value={item.value}\r\n                  key={item.value}\r\n                  className=\"lang-setting-option\"\r\n                >\r\n                  {this.props.t(item.label)}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n          <div className=\"setting-dialog-new-title\">\r\n            <Trans>Appearance</Trans>\r\n            <select\r\n              name=\"\"\r\n              className=\"lang-setting-dropdown\"\r\n              onChange={(event) => {\r\n                this.changeSkin(event.target.value);\r\n              }}\r\n            >\r\n              {skinList.map((item) => (\r\n                <option\r\n                  value={item.value}\r\n                  key={item.value}\r\n                  className=\"lang-setting-option\"\r\n                >\r\n                  {this.props.t(item.label)}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default SettingDialog;\r\n","import { connect } from \"react-redux\";\r\nimport SettingDialog from \"./component\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport {\r\n  handleSetting,\r\n  handleTipDialog,\r\n  handleTip,\r\n  handleFetchBooks,\r\n} from \"../../../store/actions\";\r\nimport { stateType } from \"../../../store\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    bookmarks: state.reader.bookmarks,\r\n    books: state.manager.books,\r\n    notes: state.reader.notes,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleSetting,\r\n  handleTipDialog,\r\n  handleTip,\r\n  handleFetchBooks,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(SettingDialog as any));\r\n","import React from \"react\";\r\nimport \"./actionDialog.css\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { ActionDialogProps } from \"./interface\";\r\nimport AddTrash from \"../../../utils/readUtils/addTrash\";\r\nimport FileSaver from \"file-saver\";\r\nimport Parser from \"html-react-parser\";\r\nimport ShelfUtil from \"../../../utils/readUtils/shelfUtil\";\r\nimport toast from \"react-hot-toast\";\r\nimport BookUtil from \"../../../utils/fileUtils/bookUtil\";\r\nclass ActionDialog extends React.Component<ActionDialogProps> {\r\n  handleDeleteBook = () => {\r\n    this.props.handleReadingBook(this.props.currentBook);\r\n    this.props.handleDeleteDialog(true);\r\n    this.props.handleActionDialog(false);\r\n  };\r\n  handleEditBook = () => {\r\n    this.props.handleEditDialog(true);\r\n    this.props.handleReadingBook(this.props.currentBook);\r\n    this.props.handleActionDialog(false);\r\n  };\r\n  handleAddShelf = () => {\r\n    this.props.handleAddDialog(true);\r\n    this.props.handleReadingBook(this.props.currentBook);\r\n    this.props.handleActionDialog(false);\r\n  };\r\n  handleRestoreBook = () => {\r\n    AddTrash.clear(this.props.currentBook.key);\r\n    this.props.handleActionDialog(false);\r\n    toast.success(this.props.t(\"Restore Successfully\"));\r\n    this.props.handleFetchBooks();\r\n  };\r\n  render() {\r\n    if (this.props.mode === \"trash\") {\r\n      return (\r\n        <div\r\n          className=\"action-dialog-container\"\r\n          onMouseLeave={() => {\r\n            this.props.handleActionDialog(false);\r\n          }}\r\n          style={{\r\n            left: this.props.left,\r\n            top: this.props.top,\r\n            maxHeight: \"45px\",\r\n            paddingTop: \"3px\",\r\n          }}\r\n        >\r\n          <div className=\"action-dialog-actions-container\">\r\n            <div\r\n              className=\"action-dialog-add\"\r\n              onClick={() => {\r\n                this.handleRestoreBook();\r\n              }}\r\n            >\r\n              <span className=\"icon-clockwise view-icon\"></span>\r\n              <span className=\"action-name\">\r\n                <Trans>Restore</Trans>\r\n              </span>\r\n              <p className=\"action-name\"></p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n    return (\r\n      <div\r\n        className=\"action-dialog-container\"\r\n        onMouseLeave={() => {\r\n          this.props.handleActionDialog(false);\r\n        }}\r\n        onMouseEnter={() => {\r\n          this.props.handleActionDialog(true);\r\n        }}\r\n        style={{ left: this.props.left, top: this.props.top }}\r\n      >\r\n        <div className=\"action-dialog-actions-container\">\r\n          <div\r\n            className=\"action-dialog-add\"\r\n            onClick={() => {\r\n              this.handleAddShelf();\r\n            }}\r\n          >\r\n            <span className=\"icon-shelf view-icon\"></span>\r\n            <p className=\"action-name\">\r\n              <Trans>Add to Shelf</Trans>\r\n            </p>\r\n            <p className=\"action-name\"></p>\r\n          </div>\r\n          <div\r\n            className=\"action-dialog-delete\"\r\n            onClick={() => {\r\n              this.handleDeleteBook();\r\n            }}\r\n          >\r\n            <span className=\"icon-trash view-icon\"></span>\r\n            <p className=\"action-name\">\r\n              <Trans>Delete</Trans>\r\n            </p>\r\n            <p className=\"action-name\"></p>\r\n          </div>\r\n          <div\r\n            className=\"action-dialog-edit\"\r\n            onClick={() => {\r\n              this.handleEditBook();\r\n            }}\r\n          >\r\n            <span className=\"icon-edit view-icon\"></span>\r\n            <p className=\"action-name\">\r\n              <Trans>Edit</Trans>\r\n            </p>\r\n            <p className=\"action-name\"></p>\r\n          </div>\r\n          <div\r\n            className=\"action-dialog-edit\"\r\n            onClick={() => {\r\n              BookUtil.fetchBook(\r\n                this.props.currentBook.key,\r\n                true,\r\n                this.props.currentBook.path\r\n              ).then((result: any) => {\r\n                toast.success(this.props.t(\"Export Successfully\"));\r\n                FileSaver.saveAs(\r\n                  new Blob([result]),\r\n                  this.props.currentBook.name +\r\n                    `.${this.props.currentBook.format.toLocaleLowerCase()}`\r\n                );\r\n              });\r\n            }}\r\n          >\r\n            <span className=\"icon-export view-icon\"></span>\r\n            <p className=\"action-name\">\r\n              <Trans>Export</Trans>\r\n            </p>\r\n            <p className=\"action-name\"></p>\r\n          </div>\r\n        </div>\r\n        <div className=\"sort-dialog-seperator\"></div>\r\n\r\n        <div className=\"action-dialog-book-info\">\r\n          <div>\r\n            <p className=\"action-dialog-book-publisher\">\r\n              <Trans>Book Name</Trans>:\r\n            </p>\r\n            <p className=\"action-dialog-book-title\">\r\n              {this.props.currentBook.name}\r\n            </p>\r\n            <p className=\"action-dialog-book-publisher\">\r\n              <Trans>Author</Trans>:\r\n            </p>\r\n            <p className=\"action-dialog-book-title\">\r\n              <Trans>{this.props.currentBook.author}</Trans>\r\n            </p>\r\n          </div>\r\n          <div>\r\n            <p className=\"action-dialog-book-publisher\">\r\n              <Trans>Publisher</Trans>:\r\n            </p>\r\n            <p className=\"action-dialog-book-title\">\r\n              {this.props.currentBook.publisher}\r\n            </p>\r\n          </div>\r\n          <div>\r\n            <p className=\"action-dialog-book-publisher\">\r\n              <Trans>File size</Trans>:\r\n            </p>\r\n            <p className=\"action-dialog-book-title\">\r\n              {this.props.currentBook.size\r\n                ? this.props.currentBook.size / 1024 / 1024 > 1\r\n                  ? parseFloat(\r\n                      this.props.currentBook.size / 1024 / 1024 + \"\"\r\n                    ).toFixed(2) + \"Mb\"\r\n                  : parseInt(this.props.currentBook.size / 1024 + \"\") + \"Kb\"\r\n                : // eslint-disable-next-line\r\n                  \"0\" + \"Kb\"}\r\n            </p>\r\n          </div>\r\n          <div>\r\n            <p className=\"action-dialog-book-added\">\r\n              <Trans>Added at</Trans>:\r\n            </p>\r\n            <p className=\"action-dialog-book-title\">\r\n              {new Date(parseInt(this.props.currentBook.key))\r\n                .toLocaleString()\r\n                .replace(/:\\d{1,2}$/, \" \")}\r\n            </p>\r\n          </div>\r\n          <div>\r\n            <p className=\"action-dialog-book-publisher\">\r\n              <Trans>Shelf</Trans>:\r\n            </p>\r\n            <p className=\"action-dialog-book-title\">\r\n              {ShelfUtil.getBookPosition(this.props.currentBook.key).map(\r\n                (item) => (\r\n                  <>\r\n                    #<Trans>{item}</Trans>&nbsp;\r\n                  </>\r\n                )\r\n              )}\r\n            </p>\r\n          </div>\r\n          <div>\r\n            <p className=\"action-dialog-book-desc\">\r\n              <Trans>Description</Trans>:\r\n            </p>\r\n            <div className=\"action-dialog-book-detail\">\r\n              {Parser(this.props.currentBook.description || \" \")}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ActionDialog;\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleEditDialog,\r\n  handleDeleteDialog,\r\n  handleAddDialog,\r\n  handleActionDialog,\r\n  handleReadingBook,\r\n  handleFetchBooks,\r\n} from \"../../../store/actions\";\r\n\r\nimport { stateType } from \"../../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport ActionDialog from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    mode: state.sidebar.mode,\r\n    currentBook: state.book.currentBook,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleEditDialog,\r\n  handleAddDialog,\r\n  handleDeleteDialog,\r\n  handleReadingBook,\r\n  handleActionDialog,\r\n  handleFetchBooks,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(ActionDialog as any));\r\n","import React from \"react\";\r\nimport \"./emptyCover.css\";\r\n\r\nconst emptyCover = (props) => (\r\n  <div className=\"empty-cover\" style={{ transform: `scale(${props.scale})` }}>\r\n    <div\r\n      className=\"cover-banner\"\r\n      style={{\r\n        backgroundColor:\r\n          props.format === \"PDF\"\r\n            ? \"rgba(55, 170, 81, 0.7)\"\r\n            : props.format === \"TXT\"\r\n            ? \"rgba(251, 191, 16,1)\"\r\n            : props.format === \"EPUB\"\r\n            ? \"rgba(33, 165, 241,1)\"\r\n            : props.format === \"MOBI\"\r\n            ? \"rgba(255, 108, 110,1)\"\r\n            : props.format === \"AZW3\"\r\n            ? \" #ff9900\"\r\n            : props.format === \"MD\"\r\n            ? \"#5e7fff\"\r\n            : props.format === \"DJVU\"\r\n            ? \"#109870\"\r\n            : props.format === \"FB2\"\r\n            ? \"#0063b1\"\r\n            : props.format === \"DOCX\" || props.format === \"RTF\"\r\n            ? \" #6867d1\"\r\n            : props.format === \"CBT\" ||\r\n              props.format === \"CBZ\" ||\r\n              props.format === \"CBR\"\r\n            ? \"#00b6c2\"\r\n            : \"rgba(104, 103, 209, 1)\",\r\n      }}\r\n    >\r\n      {props.format || \"BOOK\"}\r\n    </div>\r\n    <div\r\n      className=\"cover-title\"\r\n      style={{ fontSize: props.scale === 1.15 ? \"13px\" : \"\" }}\r\n    >\r\n      {props.title}\r\n    </div>\r\n    <div className=\"cover-footer\">Koodo Reader</div>\r\n  </div>\r\n);\r\n\r\nexport default emptyCover;\r\n","import React from \"react\";\r\nimport RecentBooks from \"../../utils/readUtils/recordRecent\";\r\nimport \"./bookCardItem.css\";\r\nimport { BookCardProps, BookCardState } from \"./interface\";\r\nimport AddFavorite from \"../../utils/readUtils/addFavorite\";\r\nimport ActionDialog from \"../dialogs/actionDialog\";\r\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\r\nimport { isElectron } from \"react-device-detect\";\r\nimport EmptyCover from \"../emptyCover\";\r\nimport BookUtil from \"../../utils/fileUtils/bookUtil\";\r\nimport toast from \"react-hot-toast\";\r\n\r\ndeclare var window: any;\r\n\r\nclass BookCardItem extends React.Component<BookCardProps, BookCardState> {\r\n  constructor(props: BookCardProps) {\r\n    super(props);\r\n    this.state = {\r\n      isOpenConfig: false,\r\n      isFavorite:\r\n        AddFavorite.getAllFavorite().indexOf(this.props.book.key) > -1,\r\n      left: 0,\r\n      top: 0,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    let filePath = \"\";\r\n    //控制是否自动打开本书\r\n    if (isElectron) {\r\n      const { ipcRenderer } = window.require(\"electron\");\r\n      filePath = ipcRenderer.sendSync(\"get-file-data\");\r\n    }\r\n\r\n    if (\r\n      StorageUtil.getReaderConfig(\"isOpenBook\") === \"yes\" &&\r\n      RecentBooks.getAllRecent()[0] === this.props.book.key &&\r\n      !this.props.currentBook.key &&\r\n      !filePath\r\n    ) {\r\n      this.props.handleReadingBook(this.props.book);\r\n      if (StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\") {\r\n        this.props.history.push(BookUtil.getBookUrl(this.props.book));\r\n      } else {\r\n        BookUtil.RedirectBook(this.props.book);\r\n      }\r\n    }\r\n  }\r\n\r\n  handleMoreAction = (event: any) => {\r\n    event.preventDefault();\r\n    const e = event || window.event;\r\n    let x = e.clientX;\r\n    if (x > document.body.clientWidth - 300) {\r\n      x = x - 180;\r\n    }\r\n    this.setState(\r\n      {\r\n        left: x,\r\n        top:\r\n          document.body.clientHeight - e.clientY > 300\r\n            ? e.clientY\r\n            : e.clientY - 300,\r\n      },\r\n      () => {\r\n        this.props.handleActionDialog(true);\r\n        this.props.handleReadingBook(this.props.book);\r\n      }\r\n    );\r\n  };\r\n  handleDeleteBook = () => {\r\n    this.props.handleReadingBook(this.props.book);\r\n    this.props.handleDeleteDialog(true);\r\n    this.props.handleActionDialog(false);\r\n  };\r\n  handleLoveBook = () => {\r\n    AddFavorite.setFavorite(this.props.book.key);\r\n    this.setState({ isFavorite: true });\r\n    toast.success(this.props.t(\"Add Successfully\"));\r\n  };\r\n  handleCancelLoveBook = () => {\r\n    AddFavorite.clear(this.props.book.key);\r\n    this.setState({ isFavorite: false });\r\n    if (Object.keys(AddFavorite.getAllFavorite()).length === 0) {\r\n      this.props.history.push(\"/manager/empty\");\r\n      document.title = \"Koodo Reader\";\r\n    }\r\n    toast.success(this.props.t(\"Cancel Successfully\"));\r\n  };\r\n  //控制按钮的弹出\r\n  handleConfig = (mode: boolean) => {\r\n    this.setState({ isOpenConfig: mode });\r\n  };\r\n  handleJump = () => {\r\n    if (this.props.isSelectBook) {\r\n      this.props.handleSelectedBooks(\r\n        this.props.isSelected\r\n          ? this.props.selectedBooks.filter(\r\n              (item) => item !== this.props.book.key\r\n            )\r\n          : [...this.props.selectedBooks, this.props.book.key]\r\n      );\r\n      return;\r\n    }\r\n    RecentBooks.setRecent(this.props.book.key);\r\n    this.props.handleReadingBook(this.props.book);\r\n    if (StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\") {\r\n      this.props.history.push(BookUtil.getBookUrl(this.props.book));\r\n    } else {\r\n      BookUtil.RedirectBook(this.props.book);\r\n    }\r\n  };\r\n  render() {\r\n    let percentage = RecordLocation.getHtmlLocation(this.props.book.key)\r\n      ? RecordLocation.getHtmlLocation(this.props.book.key).percentage\r\n      : 0;\r\n    const actionProps = { left: this.state.left, top: this.state.top };\r\n\r\n    return (\r\n      <>\r\n        <div\r\n          className=\"book-list-item\"\r\n          onMouseOver={() => {\r\n            this.handleConfig(true);\r\n          }}\r\n          onMouseLeave={() => {\r\n            this.handleConfig(false);\r\n            this.props.handleActionDialog(false);\r\n          }}\r\n          onContextMenu={(event) => {\r\n            this.handleMoreAction(event);\r\n          }}\r\n        >\r\n          {!this.props.book.cover ||\r\n          this.props.book.cover === \"noCover\" ||\r\n          (this.props.book.format === \"PDF\" &&\r\n            StorageUtil.getReaderConfig(\"isPDFCover\") !== \"yes\") ? (\r\n            <div\r\n              className=\"book-item-cover\"\r\n              onClick={() => {\r\n                this.handleJump();\r\n              }}\r\n            >\r\n              <EmptyCover\r\n                {...{\r\n                  format: this.props.book.format,\r\n                  title: this.props.book.name,\r\n                  scale: 1,\r\n                }}\r\n              />\r\n            </div>\r\n          ) : (\r\n            <img\r\n              className=\"book-item-cover\"\r\n              src={this.props.book.cover}\r\n              alt=\"\"\r\n              onClick={() => {\r\n                this.handleJump();\r\n              }}\r\n            />\r\n          )}\r\n\r\n          <p className=\"book-item-title\">{this.props.book.name}</p>\r\n\r\n          {this.state.isFavorite && !this.props.isSelectBook ? (\r\n            <span\r\n              className=\"icon-love book-loved-icon\"\r\n              onClick={() => {\r\n                this.handleCancelLoveBook();\r\n              }}\r\n            ></span>\r\n          ) : null}\r\n          {this.props.isSelectBook ? (\r\n            <span\r\n              className=\"icon-message book-selected-icon\"\r\n              style={this.props.isSelected ? {} : { color: \"#eee\" }}\r\n            ></span>\r\n          ) : null}\r\n\r\n          {this.state.isOpenConfig && !this.props.isSelectBook ? (\r\n            <>\r\n              {this.props.book.format !== \"PDF\" && (\r\n                <div className=\"reading-progress-icon\">\r\n                  <div style={{ position: \"relative\", left: \"4px\" }}>\r\n                    {percentage\r\n                      ? Math.floor(percentage * 100) < 10\r\n                        ? \"0\" + Math.floor(percentage * 100)\r\n                        : Math.floor(percentage * 100) === 100\r\n                        ? \"完\"\r\n                        : Math.floor(percentage * 100)\r\n                      : \"00\"}\r\n                    <span className=\"reading-percentage-char\">%</span>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              <span\r\n                className=\"icon-more book-more-action\"\r\n                onClick={(event) => {\r\n                  this.handleMoreAction(event);\r\n                }}\r\n              ></span>\r\n              <span\r\n                className=\"icon-love book-love-icon\"\r\n                onClick={() => {\r\n                  this.handleLoveBook();\r\n                }}\r\n              ></span>\r\n            </>\r\n          ) : null}\r\n        </div>\r\n\r\n        {this.props.isOpenActionDialog &&\r\n        this.props.book.key === this.props.currentBook.key ? (\r\n          <div className=\"action-dialog-parent\">\r\n            <ActionDialog {...actionProps} />\r\n          </div>\r\n        ) : null}\r\n      </>\r\n    );\r\n  }\r\n}\r\nexport default withRouter(BookCardItem);\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleActionDialog,\r\n  handleReadingBook,\r\n  handleDragItem,\r\n  handleDeleteDialog,\r\n  handleSelectedBooks,\r\n} from \"../../store/actions\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport Book from \"./component\";\r\nimport { stateType } from \"../../store\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    isOpenActionDialog: state.book.isOpenActionDialog,\r\n    dragItem: state.book.dragItem,\r\n    currentBook: state.book.currentBook,\r\n    isSelectBook: state.manager.isSelectBook,\r\n    selectedBooks: state.manager.selectedBooks,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleReadingBook,\r\n  handleActionDialog,\r\n  handleDragItem,\r\n  handleDeleteDialog,\r\n  handleSelectedBooks,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(Book as any));\r\n","import React from \"react\";\r\nimport \"./bookListItem.css\";\r\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\r\nimport { BookItemProps, BookItemState } from \"./interface\";\r\nimport { Trans } from \"react-i18next\";\r\nimport AddFavorite from \"../../utils/readUtils/addFavorite\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport RecentBooks from \"../../utils/readUtils/recordRecent\";\r\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\nimport AddTrash from \"../../utils/readUtils/addTrash\";\r\nimport EmptyCover from \"../emptyCover\";\r\nimport BookUtil from \"../../utils/fileUtils/bookUtil\";\r\nimport FileSaver from \"file-saver\";\r\nimport localforage from \"localforage\";\r\nimport { isElectron } from \"react-device-detect\";\r\nimport toast from \"react-hot-toast\";\r\nclass BookListItem extends React.Component<BookItemProps, BookItemState> {\r\n  constructor(props: BookItemProps) {\r\n    super(props);\r\n    this.state = {\r\n      isDeleteDialog: false,\r\n      isFavorite: AddFavorite.getAllFavorite().indexOf(this.props.book.key) > 1,\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    let filePath = \"\";\r\n    //控制是否自动打开本书\r\n    if (isElectron) {\r\n      const { ipcRenderer } = window.require(\"electron\");\r\n      filePath = ipcRenderer.sendSync(\"get-file-data\");\r\n    }\r\n    if (\r\n      StorageUtil.getReaderConfig(\"isOpenBook\") === \"yes\" &&\r\n      RecentBooks.getAllRecent()[0] === this.props.book.key &&\r\n      !this.props.currentBook.key &&\r\n      !filePath\r\n    ) {\r\n      this.props.handleReadingBook(this.props.book);\r\n      if (StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\") {\r\n        this.props.history.push(BookUtil.getBookUrl(this.props.book));\r\n      } else {\r\n        BookUtil.RedirectBook(this.props.book);\r\n      }\r\n    }\r\n  }\r\n\r\n  handleDeleteBook = () => {\r\n    this.props.handleDeleteDialog(true);\r\n    this.props.handleReadingBook(this.props.book);\r\n  };\r\n  handleEditBook = () => {\r\n    this.props.handleEditDialog(true);\r\n    this.props.handleReadingBook(this.props.book);\r\n  };\r\n  handleAddShelf = () => {\r\n    this.props.handleAddDialog(true);\r\n    this.props.handleReadingBook(this.props.book);\r\n  };\r\n  handleLoveBook = () => {\r\n    AddFavorite.setFavorite(this.props.book.key);\r\n    this.setState({ isFavorite: true });\r\n    toast.success(this.props.t(\"Add Successfully\"));\r\n  };\r\n  handleCancelLoveBook = () => {\r\n    AddFavorite.clear(this.props.book.key);\r\n    this.setState({ isFavorite: false });\r\n    toast.success(this.props.t(\"Cancel Successfully\"));\r\n  };\r\n  handleResoreBook = () => {\r\n    AddTrash.clear(this.props.currentBook.key);\r\n    toast.success(this.props.t(\"Restore Successfully\"));\r\n    this.props.handleFetchBooks();\r\n  };\r\n  handleJump = () => {\r\n    if (this.props.isSelectBook) {\r\n      this.props.handleSelectedBooks(\r\n        this.props.isSelected\r\n          ? this.props.selectedBooks.filter(\r\n              (item) => item !== this.props.book.key\r\n            )\r\n          : [...this.props.selectedBooks, this.props.book.key]\r\n      );\r\n      return;\r\n    }\r\n    RecentBooks.setRecent(this.props.book.key);\r\n    this.props.handleReadingBook(this.props.book);\r\n    if (StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\") {\r\n      this.props.history.push(BookUtil.getBookUrl(this.props.book));\r\n    } else {\r\n      BookUtil.RedirectBook(this.props.book);\r\n    }\r\n  };\r\n  render() {\r\n    let percentage = RecordLocation.getHtmlLocation(this.props.book.key)\r\n      ? RecordLocation.getHtmlLocation(this.props.book.key).percentage\r\n      : 0;\r\n\r\n    return (\r\n      <div className=\"book-list-item-container\">\r\n        {!this.props.book.cover ||\r\n        this.props.book.cover === \"noCover\" ||\r\n        (this.props.book.format === \"PDF\" &&\r\n          StorageUtil.getReaderConfig(\"isPDFCover\") !== \"yes\") ? (\r\n          <div\r\n            className=\"book-item-list-cover\"\r\n            onClick={() => {\r\n              this.handleJump();\r\n            }}\r\n          >\r\n            <EmptyCover\r\n              {...{\r\n                format: this.props.book.format,\r\n                title: this.props.book.name,\r\n                scale: 0.54,\r\n              }}\r\n            />\r\n          </div>\r\n        ) : (\r\n          <div className=\"book-item-list-cover\">\r\n            <img\r\n              className=\"book-item-list-cover-item\"\r\n              src={this.props.book.cover}\r\n              alt=\"\"\r\n              onClick={() => {\r\n                this.handleJump();\r\n              }}\r\n            />\r\n          </div>\r\n        )}\r\n        {this.props.isSelectBook && this.props.isSelected ? (\r\n          <span\r\n            className=\"icon-message book-selected-icon\"\r\n            style={{ left: \"35px\", bottom: \"5px\" }}\r\n          ></span>\r\n        ) : null}\r\n        <p\r\n          className=\"book-item-list-title\"\r\n          onClick={() => {\r\n            this.handleJump();\r\n          }}\r\n        >\r\n          <span className=\"book-item-list-subtitle\">\r\n            {this.props.book.name}\r\n          </span>\r\n        </p>\r\n\r\n        <p className=\"book-item-list-author\">\r\n          <span className=\"book-item-list-subtitle\">\r\n            <Trans>\r\n              {this.props.book.author\r\n                ? this.props.book.author\r\n                : \"Unknown Authur\"}\r\n            </Trans>\r\n          </span>\r\n        </p>\r\n        <p className=\"book-item-list-percentage\">\r\n          {percentage ? Math.round(percentage * 100) : 0}%\r\n        </p>\r\n        {this.props.mode === \"trash\" ? (\r\n          <div className=\"book-item-list-config\">\r\n            <span\r\n              className=\"icon-clockwise list-icon\"\r\n              onClick={() => {\r\n                this.handleResoreBook();\r\n              }}\r\n            ></span>\r\n          </div>\r\n        ) : (\r\n          <div className=\"book-item-list-config\">\r\n            {this.state.isFavorite ? (\r\n              <span\r\n                className=\"icon-love list-icon\"\r\n                onClick={() => {\r\n                  this.handleCancelLoveBook();\r\n                }}\r\n                style={{ color: \"#f87356\" }}\r\n              ></span>\r\n            ) : (\r\n              <span\r\n                className=\"icon-love list-icon\"\r\n                onClick={() => {\r\n                  this.handleLoveBook();\r\n                }}\r\n              ></span>\r\n            )}\r\n\r\n            <span\r\n              className=\"icon-shelf list-icon\"\r\n              onClick={() => {\r\n                this.handleAddShelf();\r\n              }}\r\n            ></span>\r\n            <span\r\n              className=\"icon-trash list-icon\"\r\n              onClick={() => {\r\n                this.handleDeleteBook();\r\n              }}\r\n            ></span>\r\n            <span\r\n              className=\"icon-edit list-icon\"\r\n              onClick={() => {\r\n                this.handleEditBook();\r\n              }}\r\n            ></span>\r\n            <span\r\n              className=\"icon-export list-icon\"\r\n              onClick={() => {\r\n                localforage\r\n                  .getItem(this.props.currentBook.key)\r\n                  .then((result: any) => {\r\n                    toast.success(this.props.t(\"Export Successfully\"));\r\n\r\n                    FileSaver.saveAs(\r\n                      new Blob([result]),\r\n                      this.props.currentBook.name +\r\n                        `.${this.props.currentBook.format.toLocaleLowerCase()}`\r\n                    );\r\n                  });\r\n              }}\r\n            ></span>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(BookListItem);\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleEditDialog,\r\n  handleDeleteDialog,\r\n  handleAddDialog,\r\n  handleReadingBook,\r\n  handleDragItem,\r\n  handleFetchBooks,\r\n  handleSelectedBooks,\r\n} from \"../../store/actions\";\r\nimport { withTranslation } from \"react-i18next\";\r\n\r\nimport { stateType } from \"../../store\";\r\nimport BookItem from \"./component\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    isReading: state.book.isReading,\r\n    percentage: state.progressPanel.percentage,\r\n    currentBook: state.book.currentBook,\r\n    dragItem: state.book.dragItem,\r\n    mode: state.sidebar.mode,\r\n    isSelectBook: state.manager.isSelectBook,\r\n    selectedBooks: state.manager.selectedBooks,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleReadingBook,\r\n  handleEditDialog,\r\n  handleDeleteDialog,\r\n  handleAddDialog,\r\n  handleDragItem,\r\n  handleFetchBooks,\r\n  handleSelectedBooks,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(BookItem as any));\r\n","import React from \"react\";\r\nimport RecentBooks from \"../../utils/readUtils/recordRecent\";\r\nimport \"./bookCoverItem.css\";\r\nimport { BookCoverProps, BookCoverState } from \"./interface\";\r\nimport AddFavorite from \"../../utils/readUtils/addFavorite\";\r\nimport ActionDialog from \"../dialogs/actionDialog\";\r\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\r\nimport { isElectron } from \"react-device-detect\";\r\nimport EmptyCover from \"../emptyCover\";\r\nimport Parser from \"html-react-parser\";\r\nimport { Trans } from \"react-i18next\";\r\nimport BookUtil from \"../../utils/fileUtils/bookUtil\";\r\nimport toast from \"react-hot-toast\";\r\ndeclare var window: any;\r\n\r\nclass BookCoverItem extends React.Component<BookCoverProps, BookCoverState> {\r\n  constructor(props: BookCoverProps) {\r\n    super(props);\r\n    this.state = {\r\n      isOpenConfig: false,\r\n      isFavorite:\r\n        AddFavorite.getAllFavorite().indexOf(this.props.book.key) > -1,\r\n      left: 0,\r\n      top: 0,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    let filePath = \"\";\r\n    //控制是否自动打开本书\r\n    if (isElectron) {\r\n      const { ipcRenderer } = window.require(\"electron\");\r\n      filePath = ipcRenderer.sendSync(\"get-file-data\");\r\n    }\r\n\r\n    if (\r\n      StorageUtil.getReaderConfig(\"isOpenBook\") === \"yes\" &&\r\n      RecentBooks.getAllRecent()[0] === this.props.book.key &&\r\n      !this.props.currentBook.key &&\r\n      !filePath\r\n    ) {\r\n      this.props.handleReadingBook(this.props.book);\r\n      if (StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\") {\r\n        this.props.history.push(BookUtil.getBookUrl(this.props.book));\r\n      } else {\r\n        BookUtil.RedirectBook(this.props.book);\r\n      }\r\n    }\r\n  }\r\n\r\n  handleMoreAction = (event: any) => {\r\n    event.preventDefault();\r\n    const e = event || window.event;\r\n    let x = e.clientX;\r\n    if (x > document.body.clientWidth - 300 && !this.props.isCollapsed) {\r\n      x = x - 180;\r\n    }\r\n    this.setState(\r\n      {\r\n        left: x,\r\n        top:\r\n          document.body.clientHeight - e.clientY > 300\r\n            ? e.clientY\r\n            : e.clientY - 300,\r\n      },\r\n      () => {\r\n        this.props.handleActionDialog(true);\r\n        this.props.handleReadingBook(this.props.book);\r\n      }\r\n    );\r\n  };\r\n  handleDeleteBook = () => {\r\n    this.props.handleReadingBook(this.props.book);\r\n    this.props.handleDeleteDialog(true);\r\n    this.props.handleActionDialog(false);\r\n  };\r\n  handleLoveBook = () => {\r\n    AddFavorite.setFavorite(this.props.book.key);\r\n    this.setState({ isFavorite: true });\r\n    toast.success(this.props.t(\"Add Successfully\"));\r\n  };\r\n  handleCancelLoveBook = () => {\r\n    AddFavorite.clear(this.props.book.key);\r\n    this.setState({ isFavorite: false });\r\n    toast.success(this.props.t(\"Cancel Successfully\"));\r\n  };\r\n  //控制按钮的弹出\r\n  handleConfig = (mode: boolean) => {\r\n    this.setState({ isOpenConfig: mode });\r\n  };\r\n  handleJump = () => {\r\n    if (this.props.isSelectBook) {\r\n      this.props.handleSelectedBooks(\r\n        this.props.isSelected\r\n          ? this.props.selectedBooks.filter(\r\n              (item) => item !== this.props.book.key\r\n            )\r\n          : [...this.props.selectedBooks, this.props.book.key]\r\n      );\r\n      return;\r\n    }\r\n    RecentBooks.setRecent(this.props.book.key);\r\n    this.props.handleReadingBook(this.props.book);\r\n    if (StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\") {\r\n      this.props.history.push(BookUtil.getBookUrl(this.props.book));\r\n    } else {\r\n      BookUtil.RedirectBook(this.props.book);\r\n    }\r\n  };\r\n  render() {\r\n    let percentage = RecordLocation.getHtmlLocation(this.props.book.key)\r\n      ? RecordLocation.getHtmlLocation(this.props.book.key).percentage\r\n      : 0;\r\n    const actionProps = { left: this.state.left, top: this.state.top };\r\n    return (\r\n      <>\r\n        <div\r\n          className=\"book-list-cover-item\"\r\n          onMouseOver={() => {\r\n            this.handleConfig(true);\r\n          }}\r\n          onMouseLeave={() => {\r\n            this.handleConfig(false);\r\n            this.props.handleActionDialog(false);\r\n          }}\r\n          onContextMenu={(event) => {\r\n            this.handleMoreAction(event);\r\n          }}\r\n        >\r\n          {!this.props.book.cover ||\r\n          this.props.book.cover === \"noCover\" ||\r\n          (this.props.book.format === \"PDF\" &&\r\n            StorageUtil.getReaderConfig(\"isPDFCover\") !== \"yes\") ? (\r\n            <div\r\n              className=\"book-cover-item-cover\"\r\n              onClick={() => {\r\n                this.handleJump();\r\n              }}\r\n            >\r\n              <EmptyCover\r\n                {...{\r\n                  format: this.props.book.format,\r\n                  title: this.props.book.name,\r\n                  scale: 1.15,\r\n                }}\r\n              />\r\n            </div>\r\n          ) : (\r\n            <img\r\n              className=\"book-cover-item-cover\"\r\n              src={this.props.book.cover}\r\n              alt=\"\"\r\n              onClick={() => {\r\n                this.handleJump();\r\n              }}\r\n            />\r\n          )}\r\n\r\n          <p className=\"book-cover-item-title\">{this.props.book.name}</p>\r\n          <p className=\"book-cover-item-author\">\r\n            <Trans>Author</Trans>:&nbsp;\r\n            <Trans>{this.props.book.author}</Trans>\r\n          </p>\r\n          <p className=\"book-cover-item-author\">\r\n            <Trans>Publisher</Trans>:&nbsp;\r\n            <Trans>{this.props.book.publisher}</Trans>\r\n          </p>\r\n          <div className=\"book-cover-item-desc\">\r\n            <Trans>Description</Trans>:&nbsp;\r\n            {this.props.book.description ? (\r\n              Parser(this.props.book.description)\r\n            ) : (\r\n              <Trans>Empty</Trans>\r\n            )}\r\n          </div>\r\n          {this.state.isFavorite && !this.props.isSelectBook ? (\r\n            <span\r\n              className=\"icon-love book-loved-icon\"\r\n              onClick={() => {\r\n                this.handleCancelLoveBook();\r\n              }}\r\n              style={{ right: \"274px\", bottom: \"25px\" }}\r\n            ></span>\r\n          ) : null}\r\n          {this.props.isSelectBook && this.props.isSelected ? (\r\n            <span\r\n              className=\"icon-message book-selected-icon\"\r\n              style={{ right: \"274px\", bottom: \"25px\" }}\r\n            ></span>\r\n          ) : null}\r\n          {this.state.isOpenConfig && !this.props.isSelectBook ? (\r\n            <>\r\n              {this.props.book.format !== \"PDF\" && (\r\n                <div\r\n                  className=\"reading-progress-icon\"\r\n                  style={{ right: \"270px\" }}\r\n                >\r\n                  <div style={{ position: \"relative\", left: \"4px\" }}>\r\n                    {percentage\r\n                      ? Math.floor(percentage * 100) < 10\r\n                        ? \"0\" + Math.floor(percentage * 100)\r\n                        : Math.floor(percentage * 100) === 100\r\n                        ? \"完\"\r\n                        : Math.floor(percentage * 100)\r\n                      : \"00\"}\r\n                    <span className=\"reading-percentage-char\">%</span>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              <span\r\n                className=\"icon-more book-more-action\"\r\n                onClick={(event) => {\r\n                  this.handleMoreAction(event);\r\n                }}\r\n                style={{ right: \"270px\" }}\r\n              ></span>\r\n              <span\r\n                className=\"icon-love book-love-icon\"\r\n                onClick={() => {\r\n                  this.handleLoveBook();\r\n                }}\r\n                style={{ right: \"275px\", bottom: \"25px\" }}\r\n              ></span>\r\n            </>\r\n          ) : null}\r\n        </div>\r\n        {this.props.isOpenActionDialog &&\r\n        this.props.book.key === this.props.currentBook.key ? (\r\n          <ActionDialog {...actionProps} />\r\n        ) : null}\r\n      </>\r\n    );\r\n  }\r\n}\r\nexport default withRouter(BookCoverItem);\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleActionDialog,\r\n  handleReadingBook,\r\n  handleDragItem,\r\n  handleDeleteDialog,\r\n  handleSelectedBooks,\r\n} from \"../../store/actions\";\r\nimport BookCoverItem from \"./component\";\r\nimport { stateType } from \"../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    isOpenActionDialog: state.book.isOpenActionDialog,\r\n    isCollapsed: state.sidebar.isCollapsed,\r\n    dragItem: state.book.dragItem,\r\n    currentBook: state.book.currentBook,\r\n    isSelectBook: state.manager.isSelectBook,\r\n    selectedBooks: state.manager.selectedBooks,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleReadingBook,\r\n  handleActionDialog,\r\n  handleDragItem,\r\n  handleDeleteDialog,\r\n  handleSelectedBooks,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(BookCoverItem));\r\n","export const emptyList = [\r\n  {\r\n    mode: \"home\",\r\n    main: \"Empty Library\",\r\n    sub: \"Click the import button to add books\",\r\n  },\r\n  {\r\n    mode: \"favorite\",\r\n    main: \"No Favorite Books\",\r\n    sub: \"Move your mouse on the top of any book, click the heart icon to add it to your favorite books\",\r\n  },\r\n  {\r\n    mode: \"bookmark\",\r\n    main: \"Empty Bookmark\",\r\n    sub: \"Move your mouse on the top edge of the reader\",\r\n  },\r\n  {\r\n    mode: \"note\",\r\n    main: \"Empty Note\",\r\n    sub: \"Select any text and click the Note button on the popup menu\",\r\n  },\r\n  {\r\n    mode: \"digest\",\r\n    main: \"Empty Highlight\",\r\n    sub: \"Select any text and click the Highlight button on the popup menu\",\r\n  },\r\n  {\r\n    mode: \"shelf\",\r\n    main: \"Empty Shelf\",\r\n    sub: \"Move your mouse on top of any book, then click the more icon to add the book to the shelf\",\r\n  },\r\n\r\n  {\r\n    mode: \"trash\",\r\n    main: \"Empty Recycle Bin\",\r\n    sub: \"The deleted books will show up here\",\r\n  },\r\n];\r\n","import React from \"react\";\r\nimport \"./emptyPage.css\";\r\nimport { emptyList } from \"../../constants/emptyList\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { EmptyPageProps, EmptyPageState } from \"./interface\";\r\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\n\r\nclass EmptyPage extends React.Component<EmptyPageProps, EmptyPageState> {\r\n  render() {\r\n    const renderEmptyList = () => {\r\n      return emptyList.map((item) => {\r\n        return (\r\n          <div\r\n            className=\"empty-page-info-container\"\r\n            key={item.mode}\r\n            style={\r\n              this.props.mode === item.mode ? {} : { visibility: \"hidden\" }\r\n            }\r\n          >\r\n            <div className=\"empty-page-info-main\">\r\n              <Trans>{item.main}</Trans>\r\n            </div>\r\n            <div className=\"empty-page-info-sub\">\r\n              <Trans>{item.sub}</Trans>\r\n            </div>\r\n          </div>\r\n        );\r\n      });\r\n    };\r\n    return (\r\n      <div\r\n        className=\"empty-page-container\"\r\n        style={\r\n          this.props.isCollapsed\r\n            ? { width: \"calc(100vw - 100px)\", left: \"100px\" }\r\n            : {}\r\n        }\r\n      >\r\n        <div\r\n          className=\"empty-illustration-container\"\r\n          style={{ width: \"calc(100% - 50px)\" }}\r\n        >\r\n          <img\r\n            src={\r\n              StorageUtil.getReaderConfig(\"appSkin\") === \"night\" ||\r\n              (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\r\n                StorageUtil.getReaderConfig(\"isOSNight\") === \"yes\")\r\n                ? \"./assets/empty_light.svg\"\r\n                : \"./assets/empty.svg\"\r\n            }\r\n            alt=\"\"\r\n            className=\"empty-page-illustration\"\r\n          />\r\n        </div>\r\n\r\n        {renderEmptyList()}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default EmptyPage;\r\n","import { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport EmptyPage from \"./component\";\r\nimport { withTranslation } from \"react-i18next\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    mode: state.sidebar.mode,\r\n    isCollapsed: state.sidebar.isCollapsed,\r\n  };\r\n};\r\nconst actionCreator = {};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(EmptyPage as any));\r\n","export const viewMode = [\r\n  {\r\n    name: \"Card\",\r\n    icon: \"grid\",\r\n    mode: \"card\",\r\n  },\r\n  {\r\n    name: \"List\",\r\n    icon: \"menu\",\r\n    mode: \"list\",\r\n  },\r\n\r\n  {\r\n    name: \"Cover\",\r\n    icon: \"cover\",\r\n    mode: \"cover\",\r\n  },\r\n];\r\n","import React from \"react\";\r\nimport \"./viewMode.css\";\r\nimport { ViewModeProps, ViewModeState } from \"./interface\";\r\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\nimport { Tooltip } from \"react-tippy\";\r\nimport { viewMode } from \"../../constants/viewMode\";\r\n\r\nclass ViewMode extends React.Component<ViewModeProps, ViewModeState> {\r\n  constructor(props: ViewModeProps) {\r\n    super(props);\r\n    this.state = {};\r\n  }\r\n  handleChange = (mode: string) => {\r\n    StorageUtil.setReaderConfig(\"viewMode\", mode);\r\n    this.props.handleFetchList();\r\n  };\r\n  render() {\r\n    return (\r\n      <div className=\"book-list-view\">\r\n        {viewMode.map((item) => (\r\n          <Tooltip\r\n            key={item.name}\r\n            title={this.props.t(item.name)}\r\n            position=\"top\"\r\n            trigger=\"mouseenter\"\r\n          >\r\n            <div\r\n              className=\"card-list-mode\"\r\n              onClick={() => {\r\n                this.handleChange(item.mode);\r\n              }}\r\n              style={this.props.viewMode !== item.mode ? { opacity: 0.5 } : {}}\r\n            >\r\n              <span className={`icon-${item.icon}`}></span>\r\n            </div>\r\n          </Tooltip>\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ViewMode;\r\n","import { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport ViewMode from \"./component\";\r\nimport { handleFetchList } from \"../../store/actions\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    viewMode: state.manager.viewMode,\r\n  };\r\n};\r\nconst actionCreator = { handleFetchList };\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(ViewMode as any));\r\n","import React from \"react\";\r\nimport AddFavorite from \"../../utils/readUtils/addFavorite\";\r\nimport BookModel from \"../../model/Book\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { BookListProps, BookListState } from \"./interface\";\r\nimport localforage from \"localforage\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport FileSaver from \"file-saver\";\r\nimport toast from \"react-hot-toast\";\r\nclass SelectBook extends React.Component<BookListProps, BookListState> {\r\n  constructor(props: BookListProps) {\r\n    super(props);\r\n    this.state = {\r\n      isOpenDelete: false,\r\n      favoriteBooks: Object.keys(AddFavorite.getAllFavorite()).length,\r\n    };\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div\r\n        className=\"booklist-manage-container\"\r\n        style={this.props.isCollapsed ? { left: \"75px\" } : {}}\r\n      >\r\n        <span\r\n          onClick={() => {\r\n            this.props.handleSelectBook(!this.props.isSelectBook);\r\n            if (this.props.isSelectBook) {\r\n              this.props.handleSelectedBooks([]);\r\n            }\r\n          }}\r\n          className=\"book-manage-title\"\r\n        >\r\n          <Trans>{this.props.isSelectBook ? \"Cancel\" : \"Select\"}</Trans>\r\n        </span>\r\n        {this.props.isSelectBook && (\r\n          <>\r\n            <span\r\n              className=\"book-manage-title\"\r\n              onClick={() => {\r\n                this.props.handleAddDialog(true);\r\n              }}\r\n            >\r\n              <Trans>Add to Shelf</Trans>\r\n            </span>\r\n            <span\r\n              className=\"book-manage-title\"\r\n              onClick={() => {\r\n                this.props.handleDeleteDialog(true);\r\n              }}\r\n            >\r\n              <Trans>Delete</Trans>\r\n            </span>\r\n            <span\r\n              className=\"book-manage-title\"\r\n              onClick={() => {\r\n                this.props.books\r\n                  .filter(\r\n                    (item: BookModel) =>\r\n                      this.props.selectedBooks.indexOf(item.key) > -1\r\n                  )\r\n                  .forEach(async (item: BookModel) => {\r\n                    let result: any = await localforage.getItem(item.key);\r\n\r\n                    FileSaver.saveAs(\r\n                      new Blob([result]),\r\n                      item.name + `.${item.format.toLocaleLowerCase()}`\r\n                    );\r\n                  });\r\n                this.props.handleSelectBook(!this.props.isSelectBook);\r\n                if (this.props.isSelectBook) {\r\n                  this.props.handleSelectedBooks([]);\r\n                }\r\n                toast.success(this.props.t(\"Export Successfully\"));\r\n              }}\r\n            >\r\n              <Trans>Export</Trans>\r\n            </span>\r\n            <span\r\n              className=\"book-manage-title\"\r\n              onClick={() => {\r\n                if (\r\n                  this.props.selectedBooks.length === this.props.books.length\r\n                ) {\r\n                  this.props.handleSelectedBooks([]);\r\n                } else {\r\n                  this.props.handleSelectedBooks(\r\n                    this.props.books.map((item) => item.key)\r\n                  );\r\n                }\r\n              }}\r\n            >\r\n              {this.props.selectedBooks.length === this.props.books.length ? (\r\n                <Trans>Deselect All</Trans>\r\n              ) : (\r\n                <Trans>Select All</Trans>\r\n              )}\r\n            </span>{\" \"}\r\n          </>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(SelectBook);\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleDeleteDialog,\r\n  handleSelectBook,\r\n  handleAddDialog,\r\n  handleSelectedBooks,\r\n} from \"../../store/actions\";\r\nimport { stateType } from \"../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport SelectBook from \"./component\";\r\n\r\nconst mappropsToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    selectedBooks: state.manager.selectedBooks,\r\n    isCollapsed: state.sidebar.isCollapsed,\r\n    isSelectBook: state.manager.isSelectBook,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleDeleteDialog,\r\n  handleSelectBook,\r\n  handleAddDialog,\r\n  handleSelectedBooks,\r\n};\r\nexport default connect(\r\n  mappropsToProps,\r\n  actionCreator\r\n)(withTranslation()(SelectBook as any));\r\n","import React from \"react\";\r\nimport ShelfUtil from \"../../utils/readUtils/shelfUtil\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { ShelfChooserProps, ShelfChooserState } from \"./interface\";\r\nimport localforage from \"localforage\";\r\nimport DeletePopup from \"../dialogs/deletePopup\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport { backup } from \"../../utils/syncUtils/backupUtil\";\r\nimport { isElectron } from \"react-device-detect\";\r\nclass ShelfChooser extends React.Component<\r\n  ShelfChooserProps,\r\n  ShelfChooserState\r\n> {\r\n  constructor(props: ShelfChooserProps) {\r\n    super(props);\r\n    this.state = {\r\n      shelfIndex: 0,\r\n      isOpenDelete: false,\r\n    };\r\n  }\r\n\r\n  //切换书架\r\n  handleShelfItem = (event: any) => {\r\n    let index = event.target.value.split(\",\")[1];\r\n    this.setState({ shelfIndex: index });\r\n    this.props.handleShelfIndex(index);\r\n    if (index > 0) {\r\n      this.props.handleMode(\"shelf\");\r\n    } else {\r\n      this.props.handleMode(\"home\");\r\n    }\r\n  };\r\n  handleDeleteShelf = () => {\r\n    if (this.state.shelfIndex < 1) return;\r\n    let shelfTitles = Object.keys(ShelfUtil.getShelf());\r\n    //获取当前书架名\r\n    let currentShelfTitle = shelfTitles[this.state.shelfIndex];\r\n    ShelfUtil.removeShelf(currentShelfTitle);\r\n    this.setState({ shelfIndex: 0 }, () => {\r\n      this.props.handleShelfIndex(0);\r\n      this.props.handleMode(\"shelf\");\r\n    });\r\n  };\r\n  renderShelfList = () => {\r\n    let shelfList = ShelfUtil.getShelf();\r\n    let shelfTitle = Object.keys(shelfList);\r\n\r\n    return shelfTitle.map((item, index) => {\r\n      return (\r\n        <option\r\n          value={[item, index.toString()]}\r\n          key={index}\r\n          className=\"add-dialog-shelf-list-option\"\r\n          selected={this.props.shelfIndex === index ? true : false}\r\n        >\r\n          {this.props.t(item === \"New\" ? \"Books\" : item)}\r\n        </option>\r\n      );\r\n    });\r\n  };\r\n  handleDeletePopup = (isOpenDelete: boolean) => {\r\n    this.setState({ isOpenDelete });\r\n  };\r\n  render() {\r\n    if (isElectron) {\r\n      //兼容之前的版本\r\n      localforage.getItem(this.props.books[0].key).then((result) => {\r\n        if (result) {\r\n          backup(\r\n            this.props.books,\r\n            this.props.notes,\r\n            this.props.bookmarks,\r\n            false\r\n          );\r\n        }\r\n      });\r\n    }\r\n    const deletePopupProps = {\r\n      mode: \"shelf\",\r\n      name: Object.keys(ShelfUtil.getShelf())[this.state.shelfIndex],\r\n      title: \"Delete this shelf\",\r\n      description: \"This action will clear and remove this shelf\",\r\n      handleDeletePopup: this.handleDeletePopup,\r\n      handleDeleteOpearion: this.handleDeleteShelf,\r\n    };\r\n\r\n    return (\r\n      <>\r\n        {this.state.isOpenDelete && <DeletePopup {...deletePopupProps} />}\r\n        <div\r\n          className=\"booklist-shelf-container\"\r\n          style={this.props.isCollapsed ? {} : { left: \"calc(50% - 60px)\" }}\r\n        >\r\n          <p className=\"general-setting-title\" style={{ display: \"inline\" }}>\r\n            <Trans>Shelf</Trans>\r\n          </p>\r\n          <select\r\n            className=\"booklist-shelf-list\"\r\n            onChange={(event: React.ChangeEvent<HTMLSelectElement>) => {\r\n              this.handleShelfItem(event);\r\n            }}\r\n          >\r\n            {this.renderShelfList()}\r\n          </select>\r\n          {this.state.shelfIndex > 0 ? (\r\n            <span\r\n              className=\"icon-trash delete-shelf-icon\"\r\n              onClick={() => {\r\n                this.handleDeletePopup(true);\r\n              }}\r\n            ></span>\r\n          ) : null}\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(ShelfChooser);\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleFetchList,\r\n  handleFetchBooks,\r\n  handleMode,\r\n  handleShelfIndex,\r\n  handleDeleteDialog,\r\n} from \"../../store/actions\";\r\nimport { stateType } from \"../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport ShelfChooser from \"./component\";\r\n\r\nconst mappropsToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    mode: state.sidebar.mode,\r\n    bookmarks: state.reader.bookmarks,\r\n    notes: state.reader.notes,\r\n    selectedBooks: state.manager.selectedBooks,\r\n    shelfIndex: state.sidebar.shelfIndex,\r\n    isCollapsed: state.sidebar.isCollapsed,\r\n    searchResults: state.manager.searchResults,\r\n    isSearch: state.manager.isSearch,\r\n    isSelectBook: state.manager.isSelectBook,\r\n    isBookSort: state.manager.isBookSort,\r\n    viewMode: state.manager.viewMode,\r\n    bookSortCode: state.manager.bookSortCode,\r\n    noteSortCode: state.manager.noteSortCode,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleFetchList,\r\n  handleMode,\r\n  handleShelfIndex,\r\n  handleDeleteDialog,\r\n  handleFetchBooks,\r\n};\r\nexport default connect(\r\n  mappropsToProps,\r\n  actionCreator\r\n)(withTranslation()(ShelfChooser));\r\n","import React from \"react\";\r\nimport \"./booklist.css\";\r\nimport BookCardItem from \"../../../components/bookCardItem\";\r\nimport BookListItem from \"../../../components/bookListItem\";\r\nimport BookCoverItem from \"../../../components/bookCoverItem\";\r\nimport AddFavorite from \"../../../utils/readUtils/addFavorite\";\r\nimport ShelfUtil from \"../../../utils/readUtils/shelfUtil\";\r\nimport SortUtil from \"../../../utils/readUtils/sortUtil\";\r\nimport BookModel from \"../../../model/Book\";\r\nimport { BookListProps, BookListState } from \"./interface\";\r\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\r\nimport localforage from \"localforage\";\r\nimport Empty from \"../../emptyPage\";\r\nimport { Redirect, withRouter } from \"react-router-dom\";\r\nimport ViewMode from \"../../../components/viewMode\";\r\nimport { backup } from \"../../../utils/syncUtils/backupUtil\";\r\nimport { isElectron } from \"react-device-detect\";\r\nimport SelectBook from \"../../../components/selectBook\";\r\nimport ShelfSelector from \"../../../components/shelfSelector\";\r\nclass BookList extends React.Component<BookListProps, BookListState> {\r\n  constructor(props: BookListProps) {\r\n    super(props);\r\n    this.state = {\r\n      favoriteBooks: Object.keys(AddFavorite.getAllFavorite()).length,\r\n    };\r\n  }\r\n  UNSAFE_componentWillMount() {\r\n    if (this.props.mode === \"trash\") {\r\n      this.props.handleFetchBooks(true);\r\n    } else {\r\n      this.props.handleFetchBooks(false);\r\n    }\r\n  }\r\n  componentDidMount() {\r\n    if (!this.props.books || !this.props.books[0]) {\r\n      return <Redirect to=\"manager/empty\" />;\r\n    }\r\n  }\r\n\r\n  handleKeyFilter = (items: any[], arr: string[]) => {\r\n    let itemArr: any[] = [];\r\n    arr.forEach((item) => {\r\n      items.forEach((subItem: any) => {\r\n        if (subItem.key === item) {\r\n          itemArr.push(subItem);\r\n        }\r\n      });\r\n    });\r\n    return itemArr;\r\n  };\r\n\r\n  //获取书架数据\r\n  handleShelf(items: any, index: number) {\r\n    //获取书架名\r\n    if (index < 1) return items;\r\n    let shelfTitle = Object.keys(ShelfUtil.getShelf());\r\n    //获取当前书架名\r\n    let currentShelfTitle = shelfTitle[index];\r\n    if (!currentShelfTitle) return items;\r\n    //获取当前书架的图书列表\r\n    let currentShelfList = ShelfUtil.getShelf()[currentShelfTitle];\r\n    //根据图书列表获取到图书数据\r\n    let shelfItems = items.filter((item: { key: number }) => {\r\n      return currentShelfList.indexOf(item.key) > -1;\r\n    });\r\n    return shelfItems;\r\n  }\r\n\r\n  //根据搜索图书index获取到搜索出的图书\r\n  handleIndexFilter = (items: any, arr: number[]) => {\r\n    let itemArr: any[] = [];\r\n    arr.forEach((item) => {\r\n      items[item] && itemArr.push(items[item]);\r\n    });\r\n    return itemArr;\r\n  };\r\n  renderBookList = () => {\r\n    //根据不同的场景获取不同的图书数据\r\n\r\n    let books = this.props.isSearch //搜索图书\r\n      ? this.handleIndexFilter(this.props.books, this.props.searchResults)\r\n      : this.props.shelfIndex > 0 //展示书架\r\n      ? this.handleIndexFilter(\r\n          this.handleShelf(this.props.books, this.props.shelfIndex),\r\n          //返回排序后的图书index\r\n          SortUtil.sortBooks(this.props.books, this.props.bookSortCode) || []\r\n        )\r\n      : this.props.mode === \"favorite\" && !this.props.isBookSort\r\n      ? this.handleKeyFilter(this.props.books, AddFavorite.getAllFavorite())\r\n      : this.props.mode === \"favorite\" && this.props.isBookSort\r\n      ? this.handleIndexFilter(\r\n          this.handleKeyFilter(this.props.books, AddFavorite.getAllFavorite()),\r\n          //返回排序后的图书index\r\n          SortUtil.sortBooks(this.props.books, this.props.bookSortCode) || []\r\n        )\r\n      : this.props.isBookSort\r\n      ? this.handleIndexFilter(\r\n          this.props.books,\r\n          //返回排序后的图书index\r\n          SortUtil.sortBooks(this.props.books, this.props.bookSortCode) || []\r\n        )\r\n      : this.props.books;\r\n\r\n    if (this.props.mode === \"shelf\" && books.length === 0) {\r\n      return (\r\n        <div\r\n          style={{\r\n            position: \"fixed\",\r\n            left: 0,\r\n            top: 0,\r\n            width: \"100%\",\r\n            height: \"100%\",\r\n            zIndex: -1,\r\n          }}\r\n        >\r\n          <Empty />\r\n        </div>\r\n      );\r\n    }\r\n    return books.map((item: BookModel, index: number) => {\r\n      return this.props.viewMode === \"list\" ? (\r\n        <BookListItem\r\n          {...{\r\n            key: item.key,\r\n            book: item,\r\n            isSelected: this.props.selectedBooks.indexOf(item.key) > -1,\r\n          }}\r\n        />\r\n      ) : this.props.viewMode === \"card\" ? (\r\n        <BookCardItem\r\n          key={item.key}\r\n          book={item}\r\n          isSelected={this.props.selectedBooks.indexOf(item.key) > -1}\r\n        />\r\n      ) : (\r\n        <BookCoverItem\r\n          {...{\r\n            key: item.key,\r\n            book: item,\r\n            isSelected: this.props.selectedBooks.indexOf(item.key) > -1,\r\n          }}\r\n        />\r\n      );\r\n    });\r\n  };\r\n\r\n  render() {\r\n    if (\r\n      (this.state.favoriteBooks === 0 && this.props.mode === \"favorite\") ||\r\n      !this.props.books ||\r\n      !this.props.books[0]\r\n    ) {\r\n      return <Redirect to=\"/manager/empty\" />;\r\n    }\r\n    if (isElectron) {\r\n      //兼容之前的版本\r\n      localforage.getItem(this.props.books[0].key).then((result) => {\r\n        if (result) {\r\n          backup(\r\n            this.props.books,\r\n            this.props.notes,\r\n            this.props.bookmarks,\r\n            false\r\n          );\r\n        }\r\n      });\r\n    }\r\n\r\n    StorageUtil.setReaderConfig(\r\n      \"totalBooks\",\r\n      this.props.books.length.toString()\r\n    );\r\n    return (\r\n      <>\r\n        <ViewMode />\r\n        <SelectBook />\r\n        {!this.props.isSelectBook && <ShelfSelector />}\r\n        <div\r\n          className=\"book-list-container-parent\"\r\n          style={\r\n            this.props.isCollapsed\r\n              ? { width: \"calc(100vw - 70px)\", left: \"70px\" }\r\n              : {}\r\n          }\r\n        >\r\n          <div className=\"book-list-container\">\r\n            <ul className=\"book-list-item-box\">{this.renderBookList()}</ul>\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(BookList);\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleFetchList,\r\n  handleFetchBooks,\r\n  handleMode,\r\n  handleShelfIndex,\r\n} from \"../../../store/actions\";\r\nimport { stateType } from \"../../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport BookList from \"./component\";\r\n\r\nconst mappropsToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    mode: state.sidebar.mode,\r\n    bookmarks: state.reader.bookmarks,\r\n    notes: state.reader.notes,\r\n    selectedBooks: state.manager.selectedBooks,\r\n    shelfIndex: state.sidebar.shelfIndex,\r\n    isCollapsed: state.sidebar.isCollapsed,\r\n    searchResults: state.manager.searchResults,\r\n    isSearch: state.manager.isSearch,\r\n    isSelectBook: state.manager.isSelectBook,\r\n    isBookSort: state.manager.isBookSort,\r\n    viewMode: state.manager.viewMode,\r\n    bookSortCode: state.manager.bookSortCode,\r\n    noteSortCode: state.manager.noteSortCode,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleFetchList,\r\n  handleMode,\r\n  handleShelfIndex,\r\n  handleFetchBooks,\r\n};\r\nexport default connect(\r\n  mappropsToProps,\r\n  actionCreator\r\n)(withTranslation()(BookList as any));\r\n","import React from \"react\";\r\nimport \"./booklist.css\";\r\nimport BookCardItem from \"../../../components/bookCardItem\";\r\nimport BookCoverItem from \"../../../components/bookCoverItem\";\r\nimport BookListItem from \"../../../components/bookListItem\";\r\nimport AddTrash from \"../../../utils/readUtils/addTrash\";\r\nimport RecordRecent from \"../../../utils/readUtils/recordRecent\";\r\nimport SortUtil from \"../../../utils/readUtils/sortUtil\";\r\nimport BookModel from \"../../../model/Book\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { BookListProps, BookListState } from \"./interface\";\r\nimport Empty from \"../../emptyPage\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport ViewMode from \"../../../components/viewMode\";\r\n\r\nclass BookList extends React.Component<BookListProps, BookListState> {\r\n  constructor(props: BookListProps) {\r\n    super(props);\r\n    this.state = {};\r\n  }\r\n  UNSAFE_componentWillMount() {\r\n    this.props.handleFetchBooks(true);\r\n  }\r\n  handleKeyFilter = (items: any[], arr: string[]) => {\r\n    let itemArr: any[] = [];\r\n    arr.forEach((item) => {\r\n      items.forEach((subItem: any) => {\r\n        if (subItem.key === item) {\r\n          itemArr.push(subItem);\r\n        }\r\n      });\r\n    });\r\n\r\n    return itemArr;\r\n  };\r\n\r\n  //根据搜索图书index获取到搜索出的图书\r\n  handleIndexFilter = (items: any, arr: number[]) => {\r\n    let itemArr: any[] = [];\r\n    arr.forEach((item) => {\r\n      items[item] && itemArr.push(items[item]);\r\n    });\r\n\r\n    return itemArr;\r\n  };\r\n  renderBookList = () => {\r\n    //根据不同的场景获取不同的图书数据\r\n    let books = !this.props.isBookSort\r\n      ? this.handleKeyFilter(this.props.deletedBooks, AddTrash.getAllTrash())\r\n      : this.props.isBookSort\r\n      ? this.handleIndexFilter(\r\n          this.handleKeyFilter(this.props.deletedBooks, AddTrash.getAllTrash()),\r\n          //返回排序后的图书index\r\n          SortUtil.sortBooks(\r\n            this.props.deletedBooks,\r\n            this.props.bookSortCode\r\n          ) || []\r\n        )\r\n      : this.props.isBookSort\r\n      ? this.handleIndexFilter(\r\n          this.props.deletedBooks,\r\n          //返回排序后的图书index\r\n          SortUtil.sortBooks(\r\n            this.props.deletedBooks,\r\n            this.props.bookSortCode\r\n          ) || []\r\n        )\r\n      : this.handleKeyFilter(\r\n          this.props.deletedBooks,\r\n          RecordRecent.getAllRecent()\r\n        );\r\n    if (books.length === 0) {\r\n      return (\r\n        <div\r\n          style={{\r\n            position: \"fixed\",\r\n            left: 0,\r\n            top: 0,\r\n            width: \"100%\",\r\n            height: \"100%\",\r\n            zIndex: -1,\r\n          }}\r\n        >\r\n          <Empty />\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return books.map((item: BookModel, index: number) => {\r\n      return this.props.viewMode === \"list\" ? (\r\n        <BookListItem\r\n          {...{\r\n            key: item.key,\r\n            book: item,\r\n          }}\r\n        />\r\n      ) : this.props.viewMode === \"card\" ? (\r\n        <BookCardItem\r\n          key={item.key}\r\n          book={item}\r\n          isSelected={this.props.selectedBooks.indexOf(item.key) > -1}\r\n        />\r\n      ) : (\r\n        <BookCoverItem\r\n          key={item.key}\r\n          book={item}\r\n          isSelected={this.props.selectedBooks.indexOf(item.key) > -1}\r\n        />\r\n      );\r\n    });\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <ViewMode />\r\n        <div\r\n          className=\"booklist-delete-container\"\r\n          onClick={() => {\r\n            this.props.handleDeleteDialog(true);\r\n          }}\r\n          style={this.props.isCollapsed ? { left: \"calc(50% - 60px)\" } : {}}\r\n        >\r\n          <Trans>Delete All Books</Trans>\r\n        </div>\r\n\r\n        <div\r\n          className=\"book-list-container-parent\"\r\n          style={\r\n            this.props.isCollapsed\r\n              ? { width: \"calc(100vw - 70px)\", left: \"70px\" }\r\n              : {}\r\n          }\r\n        >\r\n          <div className=\"book-list-container\">\r\n            <ul className=\"book-list-item-box\">{this.renderBookList()}</ul>\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(BookList);\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleFetchList,\r\n  handleFetchBooks,\r\n  handleMode,\r\n  handleShelfIndex,\r\n  handleDeleteDialog,\r\n} from \"../../../store/actions\";\r\nimport { stateType } from \"../../../store\";\r\nimport BookList from \"./component\";\r\n\r\nconst mappropsToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    deletedBooks: state.manager.deletedBooks,\r\n    mode: state.sidebar.mode,\r\n    isBookSort: state.manager.isBookSort,\r\n    isCollapsed: state.sidebar.isCollapsed,\r\n    viewMode: state.manager.viewMode,\r\n    bookSortCode: state.manager.bookSortCode,\r\n    noteSortCode: state.manager.noteSortCode,\r\n    selectedBooks: state.manager.selectedBooks,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleFetchList,\r\n  handleMode,\r\n  handleShelfIndex,\r\n  handleDeleteDialog,\r\n  handleFetchBooks,\r\n};\r\nexport default connect(mappropsToProps, actionCreator)(BookList);\r\n","import React from \"react\";\r\nimport \"./cardList.css\";\r\nimport NoteModel from \"../../../model/Note\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { CardListProps, CardListStates } from \"./interface\";\r\nimport DeleteIcon from \"../../../components/deleteIcon\";\r\nimport RecordLocation from \"../../../utils/readUtils/recordLocation\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport SortUtil from \"../../../utils/readUtils/sortUtil\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport NoteTag from \"../../../components/noteTag\";\r\nimport BookUtil from \"../../../utils/fileUtils/bookUtil\";\r\nimport toast from \"react-hot-toast\";\r\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\r\nimport BookModel from \"../../../model/Book\";\r\nclass CardList extends React.Component<CardListProps, CardListStates> {\r\n  constructor(props: CardListProps) {\r\n    super(props);\r\n    this.state = { deleteKey: \"\" };\r\n  }\r\n  //根据bookkey获取\r\n  handleBookName = (bookKey: string) => {\r\n    let { books } = this.props;\r\n    let bookName = \"\";\r\n    for (let i = 0; i < this.props.books.length; i++) {\r\n      if (books[i].key === bookKey) {\r\n        bookName = books[i].name;\r\n        break;\r\n      }\r\n    }\r\n    return bookName;\r\n  };\r\n  handleShowDelete = (deleteKey: string) => {\r\n    this.setState({ deleteKey });\r\n  };\r\n  handleJump = (cfi: string, bookKey: string, percentage: number) => {\r\n    let { books } = this.props;\r\n    let book: BookModel | null = null;\r\n    //根据bookKey获取指定的book和epub\r\n    for (let i = 0; i < books.length; i++) {\r\n      if (books[i].key === bookKey) {\r\n        book = books[i];\r\n        break;\r\n      }\r\n    }\r\n    if (!book) {\r\n      toast(this.props.t(\"Book not exist\"));\r\n      return;\r\n    }\r\n\r\n    if (book.format === \"PDF\") {\r\n      let bookLocation = JSON.parse(cfi) || {};\r\n      RecordLocation.recordPDFLocation(book.md5, bookLocation);\r\n    } else {\r\n      let bookLocation = JSON.parse(cfi) || {};\r\n      RecordLocation.recordHtmlLocation(\r\n        bookKey,\r\n        bookLocation.text,\r\n        bookLocation.chapterTitle,\r\n        bookLocation.count,\r\n        bookLocation.percentage,\r\n        bookLocation.cfi\r\n      );\r\n    }\r\n\r\n    if (StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\") {\r\n      this.props.history.push(BookUtil.getBookUrl(book));\r\n    } else {\r\n      BookUtil.RedirectBook(book);\r\n    }\r\n  };\r\n  render() {\r\n    let { cards } = this.props;\r\n    if (cards.length === 0) {\r\n      return <Redirect to=\"/manager/empty\" />;\r\n    }\r\n\r\n    let noteObj = SortUtil.sortNotes(\r\n      cards,\r\n      this.props.noteSortCode,\r\n      this.props.books\r\n    );\r\n    const renderCardListItem = (title: string) => {\r\n      return noteObj![title].map((item: NoteModel, index: number) => {\r\n        const cardProps = {\r\n          itemKey: item.key,\r\n          mode: \"notes\",\r\n        };\r\n        return (\r\n          <li\r\n            className=\"card-list-item\"\r\n            key={index}\r\n            onMouseOver={() => {\r\n              this.handleShowDelete(item.key);\r\n            }}\r\n            onMouseLeave={() => {\r\n              this.handleShowDelete(\"\");\r\n            }}\r\n            style={\r\n              this.props.mode === \"note\" && !this.props.isCollapsed\r\n                ? { height: \"250px\" }\r\n                : this.props.mode === \"note\" && this.props.isCollapsed\r\n                ? { height: \"250px\", width: \"calc(50vw - 70px)\" }\r\n                : this.props.isCollapsed\r\n                ? { width: \"calc(50vw - 70px)\" }\r\n                : {}\r\n            }\r\n          >\r\n            <div className=\"card-list-item-card\">\r\n              <div style={{ position: \"relative\", bottom: \"25px\" }}>\r\n                {this.state.deleteKey === item.key ? (\r\n                  <DeleteIcon {...cardProps} />\r\n                ) : null}\r\n              </div>\r\n              <div className=\"card-list-item-text-parent\">\r\n                <div className=\"card-list-item-note\">\r\n                  {this.props.mode === \"note\" ? item.notes : item.text}\r\n                </div>\r\n              </div>\r\n              {this.props.mode === \"note\" ? (\r\n                <div className=\"card-list-item-text-note\">\r\n                  <div className=\"card-list-item-text\">{item.text}</div>\r\n                </div>\r\n              ) : null}\r\n\r\n              <div className=\"card-list-item-citation\">\r\n                <div className=\"card-list-item-title\">\r\n                  <Trans>From</Trans>《\r\n                </div>\r\n                <div className=\"card-list-item-chapter card-list-item-title\">\r\n                  {this.handleBookName(item.bookKey)}\r\n                </div>\r\n                <div className=\"card-list-item-chapter card-list-item-title\">\r\n                  》{item.chapter}\r\n                </div>\r\n              </div>\r\n              <div\r\n                className=\"note-tags\"\r\n                style={{\r\n                  position: \"absolute\",\r\n                  bottom: \"60px\",\r\n                  height: \"30px\",\r\n                  overflow: \"hidden\",\r\n                }}\r\n              >\r\n                <NoteTag\r\n                  {...{\r\n                    handleTag: () => {},\r\n                    tag: item.tag || [],\r\n                    isCard: true,\r\n                  }}\r\n                />\r\n              </div>\r\n              <div\r\n                onClick={() => {\r\n                  this.handleJump(item.cfi, item.bookKey, item.percentage);\r\n                }}\r\n              >\r\n                <div\r\n                  className=\"card-list-item-show-more\"\r\n                  style={{ bottom: \"10px\" }}\r\n                >\r\n                  {this.props.mode === \"note\" ? (\r\n                    <Trans>{\"More Notes\"}</Trans>\r\n                  ) : (\r\n                    <Trans>{\"Show in the book\"}</Trans>\r\n                  )}\r\n\r\n                  <span className=\"icon-dropdown icon-card-right\"></span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </li>\r\n        );\r\n      });\r\n    };\r\n    const renderCardList = () => {\r\n      return Object.keys(noteObj!).map((item, index) => {\r\n        return (\r\n          <li className=\"card-page-item\" key={index}>\r\n            <div className=\"card-page-item-date\">{item}</div>\r\n            <ul className=\"card-list-container-box\">\r\n              {renderCardListItem(item)}\r\n            </ul>\r\n          </li>\r\n        );\r\n      });\r\n    };\r\n    return <div className=\"card-list-container\">{renderCardList()}</div>;\r\n  }\r\n}\r\n\r\nexport default withRouter(CardList);\r\n","import { connect } from \"react-redux\";\r\nimport { stateType } from \"../../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport CardList from \"./component\";\r\nimport { handleReadingBook } from \"../../../store/actions\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    digests: state.reader.digests,\r\n    isCollapsed: state.sidebar.isCollapsed,\r\n    currentBook: state.book.currentBook,\r\n    bookmarks: state.reader.bookmarks,\r\n    chapters: state.reader.chapters,\r\n    books: state.manager.books,\r\n    noteSortCode: state.manager.noteSortCode,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleReadingBook,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(CardList as any));\r\n","import React from \"react\";\r\nimport \"./noteList.css\";\r\nimport { NoteListProps, NoteListState } from \"./interface\";\r\nimport CardList from \"../cardList\";\r\nimport NoteTag from \"../../../components/noteTag\";\r\nimport NoteModel from \"../../../model/Note\";\r\nimport Empty from \"../../emptyPage\";\r\n\r\nclass NoteList extends React.Component<NoteListProps, NoteListState> {\r\n  constructor(props: NoteListProps) {\r\n    super(props);\r\n    this.state = {\r\n      tag: [],\r\n    };\r\n  }\r\n  UNSAFE_componentWillMount() {\r\n    this.props.handleFetchNotes();\r\n  }\r\n  handleTag = (tag: string[]) => {\r\n    this.setState({ tag });\r\n  };\r\n  handleFilter = (items: any, arr: number[]) => {\r\n    let itemArr: any[] = [];\r\n    arr.forEach((item) => {\r\n      items[item] && itemArr.push(items[item]);\r\n    });\r\n    return itemArr;\r\n  };\r\n  filterTag = (notes: NoteModel[]) => {\r\n    let temp: NoteModel[] = [];\r\n    for (let i = 0; i < notes.length; i++) {\r\n      let flag = false;\r\n      for (let j = 0; j < this.state.tag.length; j++) {\r\n        if (notes[i].tag && notes[i].tag.indexOf(this.state.tag[j]) > -1) {\r\n          flag = true;\r\n          break;\r\n        }\r\n      }\r\n      if (flag) {\r\n        temp.push(notes[i]);\r\n      }\r\n    }\r\n    return temp;\r\n  };\r\n  render() {\r\n    const noteProps = {\r\n      cards: this.props.isSearch\r\n        ? this.handleFilter(\r\n            this.props.notes.filter((item) => item.notes !== \"\"),\r\n            this.props.searchResults\r\n          )\r\n        : this.state.tag.length > 0\r\n        ? this.filterTag(this.props.notes.filter((item) => item.notes !== \"\"))\r\n        : this.props.notes.filter((item) => item.notes !== \"\"),\r\n      mode: \"note\",\r\n    };\r\n    return (\r\n      <div\r\n        className=\"note-list-container-parent\"\r\n        style={\r\n          this.props.isCollapsed\r\n            ? { width: \"calc(100vw - 70px)\", left: \"70px\" }\r\n            : {}\r\n        }\r\n      >\r\n        <div className=\"note-tags\">\r\n          <NoteTag {...{ handleTag: this.handleTag }} />\r\n        </div>\r\n        {noteProps.cards.length === 0 ? (\r\n          <div\r\n            style={{\r\n              position: \"fixed\",\r\n              left: 0,\r\n              top: 0,\r\n              width: \"100%\",\r\n              height: \"100%\",\r\n              zIndex: -1,\r\n            }}\r\n          >\r\n            {this.state.tag.length === 0 && <Empty />}\r\n          </div>\r\n        ) : (\r\n          <CardList {...noteProps} />\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default NoteList;\r\n","import { connect } from \"react-redux\";\r\nimport { stateType } from \"../../../store\";\r\nimport NoteList from \"./component\";\r\nimport { handleFetchNotes } from \"../../../store/actions\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    notes: state.reader.notes,\r\n    isSearch: state.manager.isSearch,\r\n    isCollapsed: state.sidebar.isCollapsed,\r\n    searchResults: state.manager.searchResults,\r\n  };\r\n};\r\nconst actionCreator = { handleFetchNotes };\r\nexport default connect(mapStateToProps, actionCreator)(NoteList);\r\n","import React from \"react\";\r\nimport \"./digestList.css\";\r\nimport { DigestListProps, DigestListStates } from \"./interface\";\r\nimport CardList from \"../cardList\";\r\nimport NoteTag from \"../../../components/noteTag\";\r\nimport NoteModel from \"../../../model/Note\";\r\nimport Empty from \"../../emptyPage\";\r\n\r\nclass DigestList extends React.Component<DigestListProps, DigestListStates> {\r\n  constructor(props: DigestListProps) {\r\n    super(props);\r\n    this.state = {\r\n      tag: [],\r\n    };\r\n  }\r\n  UNSAFE_componentWillMount() {\r\n    this.props.handleFetchNotes();\r\n  }\r\n  handleFilter = (items: any, arr: number[]) => {\r\n    let itemArr: any[] = [];\r\n    arr.forEach((item) => {\r\n      items[item] && itemArr.push(items[item]);\r\n    });\r\n    return itemArr;\r\n  };\r\n  handleTag = (tag: string[]) => {\r\n    this.setState({ tag });\r\n  };\r\n  filterTag = (digests: NoteModel[]) => {\r\n    let temp: NoteModel[] = [];\r\n    for (let i = 0; i < digests.length; i++) {\r\n      let flag = false;\r\n      for (let j = 0; j < this.state.tag.length; j++) {\r\n        if (digests[i].tag && digests[i].tag.indexOf(this.state.tag[j]) > -1) {\r\n          flag = true;\r\n          break;\r\n        }\r\n      }\r\n      if (flag) {\r\n        temp.push(digests[i]);\r\n      }\r\n    }\r\n    return temp;\r\n  };\r\n  render() {\r\n    const noteProps = {\r\n      cards: this.props.isSearch\r\n        ? this.handleFilter(this.props.digests, this.props.searchResults)\r\n        : this.state.tag.length > 0\r\n        ? this.filterTag(this.props.digests)\r\n        : this.props.digests,\r\n      mode: \"digest\",\r\n    };\r\n\r\n    return (\r\n      <div\r\n        className=\"digest-list-container-parent\"\r\n        style={\r\n          this.props.isCollapsed\r\n            ? { width: \"calc(100vw - 70px)\", left: \"70px\" }\r\n            : {}\r\n        }\r\n      >\r\n        <div className=\"note-tags\">\r\n          <NoteTag {...{ handleTag: this.handleTag }} />\r\n        </div>\r\n        {noteProps.cards.length === 0 ? (\r\n          <div\r\n            style={{\r\n              position: \"fixed\",\r\n              left: 0,\r\n              top: 0,\r\n              width: \"100%\",\r\n              height: \"100%\",\r\n              zIndex: -1,\r\n            }}\r\n          >\r\n            {this.state.tag.length === 0 && <Empty />}\r\n          </div>\r\n        ) : (\r\n          <CardList {...noteProps} />\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DigestList;\r\n","import { connect } from \"react-redux\";\r\nimport { stateType } from \"../../../store\";\r\nimport DigestList from \"./component\";\r\nimport { handleFetchNotes } from \"../../../store/actions\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    digests: state.reader.digests,\r\n    isSearch: state.manager.isSearch,\r\n    isCollapsed: state.sidebar.isCollapsed,\r\n    searchResults: state.manager.searchResults,\r\n  };\r\n};\r\nconst actionCreator = { handleFetchNotes };\r\nexport default connect(mapStateToProps, actionCreator)(DigestList);\r\n","import React from \"react\";\r\nimport \"./loadingPage.css\";\r\nimport { LoadingPageProps } from \"./interface\";\r\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\nimport { Redirect } from \"react-router-dom\";\r\n\r\nclass LoadingPage extends React.Component<LoadingPageProps> {\r\n  render() {\r\n    if (this.props.books) {\r\n      return <Redirect to=\"/manager/home\" />;\r\n    }\r\n    let arr: number[] = [];\r\n    for (\r\n      let i = 0;\r\n      i < parseInt(StorageUtil.getReaderConfig(\"totalBooks\")) || 0;\r\n      i++\r\n    ) {\r\n      arr.push(i);\r\n    }\r\n    if (StorageUtil.getReaderConfig(\"viewMode\") !== \"list\") {\r\n      const renderLoadingCard = () => {\r\n        return arr.map((item, index) => {\r\n          return (\r\n            <div className=\"loading-page-book\" key={item}>\r\n              <div\r\n                className=\"loading-page-cover\"\r\n                style={{ opacity: `${(index % 7) * 0.2}` }}\r\n              ></div>\r\n            </div>\r\n          );\r\n        });\r\n      };\r\n      return (\r\n        <div className=\"loading-page-container-parent\">\r\n          <div className=\"loading-page-container\">{renderLoadingCard()}</div>\r\n        </div>\r\n      );\r\n    } else {\r\n      const renderLoadingList = () => {\r\n        return arr.map((item, index) => {\r\n          return (\r\n            <div className=\"loading-page-list\" key={item}>\r\n              <div className=\"loading-page-list-cover\"></div>\r\n              <div className=\"loading-page-bar\">\r\n                <div className=\"loading-page-bar1\"></div>\r\n                <div className=\"loading-page-bar2\"></div>\r\n                <div className=\"loading-page-bar3\"></div>\r\n              </div>\r\n            </div>\r\n          );\r\n        });\r\n      };\r\n      return (\r\n        <div className=\"loading-page-container-parent\">\r\n          <div className=\"loading-page-container\" style={{ marginTop: \"8px\" }}>\r\n            {renderLoadingList()}\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nexport default LoadingPage;\r\n","import { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport LoadingPage from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n  };\r\n};\r\nconst actionCreator = {};\r\nexport default connect(mapStateToProps, actionCreator)(LoadingPage);\r\n","import BookList from \"../containers/lists/bookList\";\r\nimport DeletedBookList from \"../containers/lists/deletedBookList\";\r\nimport NoteList from \"../containers/lists/noteList\";\r\nimport DigestList from \"../containers/lists/digestList\";\r\nimport EmptyPage from \"../containers/emptyPage\";\r\nimport LoadingPage from \"../containers/loadingPage\";\r\n\r\nexport const routes = [\r\n  { path: \"/manager/empty\", component: EmptyPage },\r\n  { path: \"/manager/loading\", component: LoadingPage },\r\n  { path: \"/manager/note\", component: NoteList },\r\n  { path: \"/manager/digest\", component: DigestList },\r\n  { path: \"/manager/home\", component: BookList },\r\n  { path: \"/manager/favorite\", component: BookList },\r\n  { path: \"/manager/trash\", component: DeletedBookList },\r\n];\r\n","import React from \"react\";\r\nimport \"./arrow.css\";\r\nconst Arrow = () => {\r\n  return (\r\n    <div className=\"arrow-container\">\r\n      <svg\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        width=\"48\"\r\n        height=\"48\"\r\n        viewBox=\"0 0 48 48\"\r\n        className=\"circle\"\r\n      >\r\n        <g\r\n          transform=\"translate(48 48) rotate(180)\"\r\n          fill=\"none\"\r\n          stroke=\"rgba(75,75,75)\"\r\n          strokeWidth=\"1.5\"\r\n        >\r\n          <circle cx=\"24\" cy=\"24\" r=\"24\" stroke=\"none\" />\r\n          <circle cx=\"24\" cy=\"24\" r=\"23.25\" fill=\"none\" />\r\n        </g>\r\n      </svg>\r\n      <svg\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        width=\"7\"\r\n        height=\"40.5\"\r\n        viewBox=\"0 0 9 64.5\"\r\n        className=\"arrow\"\r\n      >\r\n        <g transform=\"translate(-799.5 -100)\">\r\n          <line\r\n            y2=\"59\"\r\n            transform=\"translate(804 163.5) rotate(180)\"\r\n            fill=\"none\"\r\n            stroke=\"rgba(75,75,75)\"\r\n            strokeLinecap=\"round\"\r\n            strokeWidth=\"2\"\r\n          />\r\n          <path\r\n            d=\"M4.5,0,9,8H0Z\"\r\n            transform=\"translate(799.5 100)\"\r\n            fill=\"rgba(75,75,75)\"\r\n          />\r\n        </g>\r\n      </svg>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Arrow;\r\n","import React from \"react\";\r\nimport \"./loadingDialog.css\";\r\nimport Lottie from \"react-lottie\";\r\nimport animationData from \"../../../assets/lotties/loading.json\";\r\nimport { Trans } from \"react-i18next\";\r\nconst defaultOptions = {\r\n  loop: true,\r\n  autoplay: true,\r\n  animationData: animationData,\r\n  rendererSettings: {\r\n    preserveAspectRatio: \"xMidYMid slice\",\r\n  },\r\n};\r\nconst LoadingDialog = (props) => {\r\n  return (\r\n    <div className=\"loading-dialog\">\r\n      <div className=\"loading-dialog-title\">\r\n        <Trans>Please Wait a moment</Trans>\r\n      </div>\r\n      <div className=\"loading-animation\">\r\n        <Lottie options={defaultOptions} height={250} width={280} />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nexport default LoadingDialog;\r\n","import React from \"react\";\r\nimport \"./updateInfo.css\";\r\nimport { TipDialogProps, TipDialogState } from \"./interface\";\r\nimport { Trans } from \"react-i18next\";\r\nimport Lottie from \"react-lottie\";\r\nimport animationDownload from \"../../../assets/lotties/download.json\";\r\n\r\nconst downloadOptions = {\r\n  loop: true,\r\n  autoplay: true,\r\n  animationData: animationDownload,\r\n  rendererSettings: {\r\n    preserveAspectRatio: \"xMidYMid slice\",\r\n  },\r\n};\r\n\r\nclass TipDialog extends React.Component<TipDialogProps, TipDialogState> {\r\n  constructor(props: TipDialogProps) {\r\n    super(props);\r\n    this.state = {};\r\n  }\r\n\r\n  handleClose = () => {\r\n    this.props.handleTipDialog(false);\r\n  };\r\n  render() {\r\n    return (\r\n      <div className=\"download-desk-container\">\r\n        <div\r\n          className=\"setting-close-container\"\r\n          onClick={() => {\r\n            this.handleClose();\r\n          }}\r\n        >\r\n          <span className=\"icon-close tip-close-icon\"></span>\r\n        </div>\r\n\r\n        <div className=\"download-desk-title\">\r\n          <Trans>Tips</Trans>\r\n        </div>\r\n\r\n        <div className=\"download-desk-feature-container\">\r\n          <div className=\"download-desk-feature-item\">\r\n            <Trans>{this.props.tip}</Trans>\r\n          </div>\r\n        </div>\r\n        <div\r\n          className=\"new-version-open\"\r\n          onClick={() => {\r\n            this.handleClose();\r\n          }}\r\n          style={{ marginTop: \"-10px\" }}\r\n        >\r\n          <Trans>Understand</Trans>\r\n        </div>\r\n        <div className=\"download-desk-animation\">\r\n          <Lottie options={downloadOptions} height={200} width={300} />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default TipDialog;\r\n","import { connect } from \"react-redux\";\r\nimport { handleTipDialog } from \"../../../store/actions\";\r\nimport TipDialog from \"./component\";\r\nimport { stateType } from \"../../../store\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return { tip: state.manager.tip };\r\n};\r\nconst actionCreator = {\r\n  handleTipDialog,\r\n};\r\nexport default connect(mapStateToProps, actionCreator)(TipDialog);\r\n","import React from \"react\";\r\nimport Sidebar from \"../../containers/sidebar\";\r\nimport Header from \"../../containers/header\";\r\nimport DeleteDialog from \"../../components/dialogs/deleteDialog\";\r\nimport EditDialog from \"../../components/dialogs/editDialog\";\r\nimport AddDialog from \"../../components/dialogs/addDialog\";\r\nimport SortDialog from \"../../components/dialogs/sortDialog\";\r\nimport AboutDialog from \"../../components/dialogs/aboutDialog\";\r\nimport BackupDialog from \"../../components/dialogs/backupDialog\";\r\nimport \"./manager.css\";\r\nimport { ManagerProps, ManagerState } from \"./interface\";\r\nimport { Trans } from \"react-i18next\";\r\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\nimport AddFavorite from \"../../utils/readUtils/addFavorite\";\r\nimport SettingDialog from \"../../components/dialogs/settingDialog\";\r\nimport { isMobile } from \"react-device-detect\";\r\nimport { Route, Switch, Redirect } from \"react-router-dom\";\r\nimport { routes } from \"../../router/routes\";\r\nimport Arrow from \"../../components/arrow\";\r\nimport LoadingDialog from \"../../components/dialogs/loadingDialog\";\r\nimport TipDialog from \"../../components/dialogs/TipDialog\";\r\nimport { Toaster } from \"react-hot-toast\";\r\n\r\n//判断是否为触控设备\r\nconst is_touch_device = () => {\r\n  return \"ontouchstart\" in window;\r\n};\r\n\r\nclass Manager extends React.Component<ManagerProps, ManagerState> {\r\n  timer!: NodeJS.Timeout;\r\n  constructor(props: ManagerProps) {\r\n    super(props);\r\n    this.state = {\r\n      totalBooks: parseInt(StorageUtil.getReaderConfig(\"totalBooks\")) || 0,\r\n      favoriteBooks: Object.keys(AddFavorite.getAllFavorite()).length,\r\n      isAuthed: false,\r\n      isError: false,\r\n      isCopied: false,\r\n      isUpdated: false,\r\n      isDrag: false,\r\n      token: \"\",\r\n    };\r\n  }\r\n\r\n  UNSAFE_componentWillReceiveProps(nextProps: ManagerProps) {\r\n    if (nextProps.books && this.state.totalBooks !== nextProps.books.length) {\r\n      this.setState(\r\n        {\r\n          totalBooks: nextProps.books.length,\r\n        },\r\n        () => {\r\n          StorageUtil.setReaderConfig(\r\n            \"totalBooks\",\r\n            this.state.totalBooks.toString()\r\n          );\r\n        }\r\n      );\r\n    }\r\n    if (nextProps.books && nextProps.books.length === 1 && !this.props.books) {\r\n      this.props.history.push(\"/manager/home\");\r\n    }\r\n    if (this.props.mode !== nextProps.mode) {\r\n      this.setState({\r\n        favoriteBooks: Object.keys(AddFavorite.getAllFavorite()).length,\r\n      });\r\n    }\r\n  }\r\n  UNSAFE_componentWillMount() {\r\n    this.props.handleFetchBooks();\r\n    this.props.handleFetchNotes();\r\n    this.props.handleFetchBookmarks();\r\n    this.props.handleFetchBookSortCode();\r\n    this.props.handleFetchNoteSortCode();\r\n    this.props.handleFetchList();\r\n  }\r\n  componentDidMount() {\r\n    if (is_touch_device() && !StorageUtil.getReaderConfig(\"isTouch\")) {\r\n      StorageUtil.setReaderConfig(\"isTouch\", \"yes\");\r\n    }\r\n    this.props.handleReadingState(false);\r\n  }\r\n\r\n  handleDrag = (isDrag: boolean) => {\r\n    this.setState({ isDrag });\r\n  };\r\n  render() {\r\n    let { books } = this.props;\r\n    if (isMobile) {\r\n      return (\r\n        <>\r\n          <p className=\"waring-title\">\r\n            <Trans>Warning</Trans>\r\n          </p>\r\n          <div className=\"mobile-warning\">\r\n            <span>\r\n              <Trans>\r\n                For better user experince, please visit this site on a computer\r\n              </Trans>\r\n            </span>\r\n          </div>\r\n          <div>\r\n            <img\r\n              src={\r\n                StorageUtil.getReaderConfig(\"appSkin\") === \"night\" ||\r\n                (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\r\n                  StorageUtil.getReaderConfig(\"isOSNight\") === \"yes\")\r\n                  ? \"./assets/empty_light.svg\"\r\n                  : \"./assets/empty.svg\"\r\n              }\r\n              alt=\"\"\r\n              className=\"waring-pic\"\r\n            />\r\n          </div>\r\n        </>\r\n      );\r\n    }\r\n    return (\r\n      <div\r\n        className=\"manager\"\r\n        onDragEnter={() => {\r\n          !this.props.dragItem && this.handleDrag(true);\r\n          (\r\n            document.getElementsByClassName(\"import-from-local\")[0] as any\r\n          ).style.zIndex = \"50\";\r\n        }}\r\n      >\r\n        {!this.props.dragItem && (\r\n          <div\r\n            className=\"drag-background\"\r\n            onClick={() => {\r\n              this.props.handleEditDialog(false);\r\n              this.props.handleDeleteDialog(false);\r\n              this.props.handleAddDialog(false);\r\n              this.props.handleTipDialog(false);\r\n              this.props.handleLoadingDialog(false);\r\n              this.props.handleNewDialog(false);\r\n              this.props.handleBackupDialog(false);\r\n              this.props.handleSetting(false);\r\n              this.handleDrag(false);\r\n            }}\r\n            style={\r\n              this.props.isSettingOpen ||\r\n              this.props.isBackup ||\r\n              this.props.isShowNew ||\r\n              this.props.isOpenDeleteDialog ||\r\n              this.props.isOpenEditDialog ||\r\n              this.props.isOpenAddDialog ||\r\n              this.props.isTipDialog ||\r\n              this.props.isShowLoading ||\r\n              this.state.isDrag\r\n                ? {}\r\n                : {\r\n                    display: \"none\",\r\n                  }\r\n            }\r\n          >\r\n            {this.state.isDrag && (\r\n              <div className=\"drag-info\">\r\n                <Arrow />\r\n                <p className=\"arrow-text\">\r\n                  <Trans>Drop your books here</Trans>\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n        <Sidebar />\r\n        <Header {...{ handleDrag: this.handleDrag }} />\r\n        {this.props.isOpenDeleteDialog && <DeleteDialog />}\r\n        {this.props.isOpenEditDialog && <EditDialog />}\r\n        {this.props.isOpenAddDialog && <AddDialog />}\r\n        {this.props.isShowLoading && <LoadingDialog />}\r\n        <Toaster />\r\n        {this.props.isSortDisplay && <SortDialog />}\r\n        {this.props.isAboutOpen && <AboutDialog />}\r\n        {this.props.isBackup && <BackupDialog />}\r\n        {this.props.isSettingOpen && <SettingDialog />}\r\n        {this.props.isTipDialog && <TipDialog />}\r\n        {(!books || books.length === 0) && this.state.totalBooks ? (\r\n          <Redirect to=\"/manager/loading\" />\r\n        ) : (\r\n          <Switch>\r\n            {routes.map((ele) => (\r\n              <Route\r\n                render={() => <ele.component />}\r\n                key={ele.path}\r\n                path={ele.path}\r\n              />\r\n            ))}\r\n          </Switch>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default Manager;\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleFetchBooks,\r\n  handleFetchBookSortCode,\r\n  handleFetchNoteSortCode,\r\n  handleFetchList,\r\n  handleTipDialog,\r\n  handleLoadingDialog,\r\n  handleNewDialog,\r\n  handleSetting,\r\n  handleBackupDialog,\r\n  handleFetchNotes,\r\n  handleFetchBookmarks,\r\n  handleEditDialog,\r\n  handleDeleteDialog,\r\n  handleAddDialog,\r\n  handleReadingState,\r\n} from \"../../store/actions\";\r\nimport { withTranslation } from \"react-i18next\";\r\n\r\nimport \"./manager.css\";\r\nimport { stateType } from \"../../store\";\r\nimport Manager from \"./component\";\r\nimport { withRouter } from \"react-router-dom\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    books: state.manager.books,\r\n    notes: state.reader.notes,\r\n    digests: state.reader.digests,\r\n    bookmarks: state.reader.bookmarks,\r\n    isReading: state.book.isReading,\r\n    mode: state.sidebar.mode,\r\n    dragItem: state.book.dragItem,\r\n    shelfIndex: state.sidebar.shelfIndex,\r\n    isOpenEditDialog: state.book.isOpenEditDialog,\r\n    isOpenDeleteDialog: state.book.isOpenDeleteDialog,\r\n    isOpenAddDialog: state.book.isOpenAddDialog,\r\n    isSettingOpen: state.manager.isSettingOpen,\r\n    isAboutOpen: state.manager.isAboutOpen,\r\n    isBookSort: state.manager.isBookSort,\r\n    isSortDisplay: state.manager.isSortDisplay,\r\n    isShowLoading: state.manager.isShowLoading,\r\n    isShowNew: state.manager.isShowNew,\r\n    isTipDialog: state.manager.isTipDialog,\r\n    isBackup: state.backupPage.isBackup,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleFetchBooks,\r\n  handleFetchNotes,\r\n  handleSetting,\r\n  handleFetchBookmarks,\r\n  handleFetchBookSortCode,\r\n  handleFetchNoteSortCode,\r\n  handleFetchList,\r\n  handleEditDialog,\r\n  handleDeleteDialog,\r\n  handleAddDialog,\r\n  handleTipDialog,\r\n  handleLoadingDialog,\r\n  handleNewDialog,\r\n  handleBackupDialog,\r\n  handleReadingState,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(withRouter(Manager)));\r\n","import React from \"react\";\r\nimport \"./background.css\";\r\nimport { BackgroundProps, BackgroundState } from \"./interface\";\r\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\nimport { Trans } from \"react-i18next\";\r\nclass Background extends React.Component<BackgroundProps, BackgroundState> {\r\n  isFirst: Boolean;\r\n  constructor(props: any) {\r\n    super(props);\r\n    this.state = {\r\n      isSingle:\r\n        StorageUtil.getReaderConfig(\"readerMode\") &&\r\n        StorageUtil.getReaderConfig(\"readerMode\") !== \"double\",\r\n      currentChapter: \"\",\r\n      prevPage: 0,\r\n      nextPage: 0,\r\n      scale: StorageUtil.getReaderConfig(\"scale\") || 1,\r\n      isHideFooter: StorageUtil.getReaderConfig(\"isHideFooter\") === \"yes\",\r\n      isHideHeader: StorageUtil.getReaderConfig(\"isHideHeader\") === \"yes\",\r\n    };\r\n    this.isFirst = true;\r\n  }\r\n\r\n  async UNSAFE_componentWillReceiveProps(nextProps: BackgroundProps) {\r\n    if (nextProps.htmlBook) {\r\n      let pageInfo = await nextProps.htmlBook.rendition.getProgress();\r\n\r\n      this.setState({\r\n        currentChapter: this.props.currentChapter,\r\n        prevPage: this.state.isSingle\r\n          ? pageInfo.currentPage\r\n          : pageInfo.currentPage * 2 - 1,\r\n        nextPage: this.state.isSingle\r\n          ? pageInfo.currentPage\r\n          : pageInfo.currentPage * 2,\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div\r\n        className=\"background\"\r\n        style={{\r\n          color: StorageUtil.getReaderConfig(\"textColor\")\r\n            ? StorageUtil.getReaderConfig(\"textColor\")\r\n            : \"\",\r\n        }}\r\n      >\r\n        <div className=\"header-container\">\r\n          {!this.state.isHideHeader && this.state.currentChapter && (\r\n            <p\r\n              className=\"header-chapter-name\"\r\n              style={\r\n                this.state.isSingle\r\n                  ? {\r\n                      left: `calc(50vw - \r\n                      270px)`,\r\n                    }\r\n                  : {}\r\n              }\r\n            >\r\n              {this.state.currentChapter}\r\n            </p>\r\n          )}\r\n          {!this.state.isHideHeader && !this.state.isSingle && (\r\n            <p\r\n              className=\"header-book-name\"\r\n              style={\r\n                this.state.isSingle\r\n                  ? {\r\n                      right: `calc(50vw - \r\n                      270px)`,\r\n                    }\r\n                  : {}\r\n              }\r\n            >\r\n              {this.props.currentBook.name}\r\n            </p>\r\n          )}\r\n        </div>\r\n        <div className=\"footer-container\">\r\n          {!this.state.isHideFooter && this.state.prevPage > 0 && (\r\n            <p\r\n              className=\"background-page-left\"\r\n              style={\r\n                this.state.isSingle\r\n                  ? {\r\n                      left: `calc(50vw - \r\n                      270px)`,\r\n                    }\r\n                  : {}\r\n              }\r\n            >\r\n              <Trans i18nKey=\"Book Page\" count={this.state.prevPage}>\r\n                Page\r\n                {{\r\n                  count: this.state.prevPage,\r\n                }}\r\n              </Trans>\r\n            </p>\r\n          )}\r\n          {!this.state.isHideFooter &&\r\n            this.state.nextPage > 0 &&\r\n            !this.state.isSingle && (\r\n              <p className=\"background-page-right\">\r\n                <Trans i18nKey=\"Book Page\" count={this.state.nextPage}>\r\n                  Page\r\n                  {{\r\n                    count: this.state.nextPage,\r\n                  }}\r\n                </Trans>\r\n              </p>\r\n            )}\r\n        </div>\r\n        <>\r\n          {this.props.isShowBookmark ? <div className=\"bookmark\"></div> : null}\r\n        </>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Background;\r\n","import { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport Background from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentBook: state.book.currentBook,\r\n    locations: state.progressPanel.locations,\r\n    currentChapter: state.reader.currentChapter,\r\n    htmlBook: state.reader.htmlBook,\r\n    isShowBookmark: state.viewArea.isShowBookmark,\r\n  };\r\n};\r\nconst actionCreator = {};\r\nexport default connect(mapStateToProps, actionCreator)(Background);\r\n","class ThemeUtil {\r\n  static setThemes(themeName: string) {\r\n    let themeArr =\r\n      localStorage.getItem(\"themeColors\") !== \"{}\" &&\r\n      localStorage.getItem(\"themeColors\")\r\n        ? JSON.parse(localStorage.getItem(\"themeColors\") || \"\")\r\n        : [];\r\n    const index = themeArr.indexOf(themeName);\r\n    if (index > -1) {\r\n      themeArr.splice(index, 1);\r\n      themeArr.unshift(themeName);\r\n    } else {\r\n      themeArr.unshift(themeName);\r\n    }\r\n\r\n    localStorage.setItem(\"themeColors\", JSON.stringify(themeArr));\r\n  }\r\n\r\n  static clear(themeName: string) {\r\n    let themeArr =\r\n      localStorage.getItem(\"themeColors\") !== \"{}\" &&\r\n      localStorage.getItem(\"themeColors\")\r\n        ? JSON.parse(localStorage.getItem(\"themeColors\") || \"\")\r\n        : [];\r\n    const index = themeArr.indexOf(themeName);\r\n    if (index > -1) {\r\n      themeArr.splice(index, 1);\r\n    }\r\n    localStorage.setItem(\"themeColors\", JSON.stringify(themeArr));\r\n  }\r\n  static getAllThemes() {\r\n    let themeArr =\r\n      localStorage.getItem(\"themeColors\") !== \"{}\" &&\r\n      localStorage.getItem(\"themeColors\")\r\n        ? JSON.parse(localStorage.getItem(\"themeColors\") || \"\")\r\n        : [];\r\n    return themeArr || [];\r\n  }\r\n}\r\n\r\nexport default ThemeUtil;\r\n","import React from \"react\";\r\nimport { backgroundList, textList } from \"../../../constants/themeList\";\r\nimport StyleUtil from \"../../../utils/readUtils/styleUtil\";\r\nimport \"./themeList.css\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { ThemeListProps, ThemeListState } from \"./interface\";\r\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\r\nimport { Panel as ColorPickerPanel } from \"rc-color-picker\";\r\nimport \"rc-color-picker/assets/index.css\";\r\nimport ThemeUtil from \"../../../utils/readUtils/themeUtil\";\r\nimport { Tooltip } from \"react-tippy\";\r\nimport toast from \"react-hot-toast\";\r\nimport { isElectron } from \"react-device-detect\";\r\n\r\nclass ThemeList extends React.Component<ThemeListProps, ThemeListState> {\r\n  constructor(props: ThemeListProps) {\r\n    super(props);\r\n    this.state = {\r\n      currentBackgroundIndex: backgroundList\r\n        .concat(ThemeUtil.getAllThemes())\r\n        .findIndex((item) => {\r\n          return (\r\n            item ===\r\n            (StorageUtil.getReaderConfig(\"backgroundColor\") ||\r\n              \"rgba(255,255,255,1)\")\r\n          );\r\n        }),\r\n      currentTextIndex: textList\r\n        .concat(ThemeUtil.getAllThemes())\r\n        .findIndex((item) => {\r\n          return (\r\n            item ===\r\n            (StorageUtil.getReaderConfig(\"textColor\") || \"rgba(0,0,0,1)\")\r\n          );\r\n        }),\r\n      isShowTextPicker: false,\r\n      isShowBgPicker: false,\r\n    };\r\n  }\r\n  handleChangeBgColor = (color: string, index: number = -1) => {\r\n    StorageUtil.setReaderConfig(\"backgroundColor\", color);\r\n    this.setState({\r\n      currentBackgroundIndex: index,\r\n    });\r\n    if (index === 1) {\r\n      StorageUtil.setReaderConfig(\"textColor\", \"rgba(255,255,255,1)\");\r\n    } else if (\r\n      index === 0 &&\r\n      StorageUtil.getReaderConfig(\"backgroundColor\") === \"rgba(255,255,255,1)\"\r\n    ) {\r\n      StorageUtil.setReaderConfig(\"textColor\", \"rgba(0,0,0,1)\");\r\n    }\r\n    if (isElectron) {\r\n      toast(this.props.t(\"Take effect at next startup\"));\r\n    } else {\r\n      window.location.reload();\r\n    }\r\n  };\r\n\r\n  handleChooseBgColor = (color) => {\r\n    StorageUtil.setReaderConfig(\"backgroundColor\", color.color);\r\n    StyleUtil.addDefaultCss();\r\n  };\r\n  handleColorTextPicker = (isShowTextPicker: boolean) => {\r\n    if (\r\n      !isShowTextPicker &&\r\n      textList.concat(ThemeUtil.getAllThemes()).findIndex((item) => {\r\n        return (\r\n          item === (StorageUtil.getReaderConfig(\"textColor\") || \"rgba(0,0,0,1)\")\r\n        );\r\n      }) === -1\r\n    ) {\r\n      ThemeUtil.setThemes(StorageUtil.getReaderConfig(\"textColor\"));\r\n    }\r\n    this.setState({ isShowTextPicker });\r\n  };\r\n  handleColorBgPicker = (isShowBgPicker: boolean) => {\r\n    if (\r\n      !isShowBgPicker &&\r\n      backgroundList.concat(ThemeUtil.getAllThemes()).findIndex((item) => {\r\n        return (\r\n          item ===\r\n          (StorageUtil.getReaderConfig(\"backgroundColor\") ||\r\n            \"rgba(255,255,255,1)\")\r\n        );\r\n      }) === -1\r\n    ) {\r\n      ThemeUtil.setThemes(StorageUtil.getReaderConfig(\"backgroundColor\"));\r\n    }\r\n    this.setState({ isShowBgPicker });\r\n  };\r\n  handleChooseTextColor = (color) => {\r\n    if (typeof color !== \"object\") {\r\n      this.setState({\r\n        currentTextIndex: textList\r\n          .concat(ThemeUtil.getAllThemes())\r\n          .indexOf(color),\r\n      });\r\n    }\r\n    StorageUtil.setReaderConfig(\r\n      \"textColor\",\r\n      typeof color === \"object\" ? color.color : color\r\n    );\r\n    this.props.renderFunc();\r\n  };\r\n  render() {\r\n    const renderBackgroundColorList = () => {\r\n      return backgroundList\r\n        .concat(ThemeUtil.getAllThemes())\r\n        .map((item, index) => {\r\n          return (\r\n            <li\r\n              key={item + index}\r\n              className={\r\n                index === this.state.currentBackgroundIndex\r\n                  ? \"active-color background-color-circle\"\r\n                  : \"background-color-circle\"\r\n              }\r\n              onClick={() => {\r\n                this.handleChangeBgColor(item, index);\r\n              }}\r\n              style={{ backgroundColor: item }}\r\n            >\r\n              {index > 3 && index === this.state.currentBackgroundIndex && (\r\n                <span\r\n                  className=\"icon-close\"\r\n                  onClick={() => {\r\n                    ThemeUtil.clear(item);\r\n                  }}\r\n                ></span>\r\n              )}\r\n            </li>\r\n          );\r\n        });\r\n    };\r\n    const renderTextColorList = () => {\r\n      return textList.concat(ThemeUtil.getAllThemes()).map((item, index) => {\r\n        return (\r\n          <li\r\n            key={item + index}\r\n            className={\r\n              index === this.state.currentTextIndex\r\n                ? \"active-color background-color-circle\"\r\n                : \"background-color-circle\"\r\n            }\r\n            onClick={() => {\r\n              this.handleChooseTextColor(item);\r\n            }}\r\n            style={{ backgroundColor: item }}\r\n          >\r\n            {index > 3 && index === this.state.currentTextIndex && (\r\n              <span\r\n                className=\"icon-close\"\r\n                onClick={() => {\r\n                  ThemeUtil.clear(item);\r\n                }}\r\n              ></span>\r\n            )}\r\n          </li>\r\n        );\r\n      });\r\n    };\r\n    return (\r\n      <div className=\"background-color-setting\">\r\n        <div className=\"background-color-text\">\r\n          <Trans>Background Color</Trans>\r\n        </div>\r\n        <ul className=\"background-color-list\">\r\n          <Tooltip\r\n            title={this.props.t(\"Customize\")}\r\n            position=\"top\"\r\n            trigger=\"mouseenter\"\r\n            style={{ display: \"inline-block\" }}\r\n          >\r\n            <li\r\n              className=\"background-color-circle\"\r\n              onClick={() => {\r\n                this.handleColorBgPicker(!this.state.isShowBgPicker);\r\n              }}\r\n            >\r\n              <span\r\n                className={\r\n                  this.state.isShowBgPicker ? \"icon-check\" : \"icon-more\"\r\n                }\r\n              ></span>\r\n            </li>\r\n          </Tooltip>\r\n\r\n          {renderBackgroundColorList()}\r\n        </ul>\r\n        {this.state.isShowBgPicker && (\r\n          <ColorPickerPanel\r\n            enableAlpha={false}\r\n            color={StorageUtil.getReaderConfig(\"backgroundColor\")}\r\n            onChange={this.handleChooseBgColor}\r\n            mode=\"RGB\"\r\n            style={{\r\n              margin: 20,\r\n              animation: \"fade-in 0.2s ease-in-out 0s 1\",\r\n            }}\r\n          />\r\n        )}\r\n        <div className=\"background-color-text\">\r\n          <Trans>Text Color</Trans>\r\n        </div>\r\n        <ul className=\"background-color-list\">\r\n          <Tooltip\r\n            title={this.props.t(\"Customize\")}\r\n            position=\"top\"\r\n            trigger=\"mouseenter\"\r\n            style={{ display: \"inline-block\" }}\r\n          >\r\n            <li\r\n              className=\"background-color-circle\"\r\n              onClick={() => {\r\n                this.handleColorTextPicker(!this.state.isShowTextPicker);\r\n              }}\r\n            >\r\n              <span\r\n                className={\r\n                  this.state.isShowTextPicker ? \"icon-check\" : \"icon-more\"\r\n                }\r\n              ></span>\r\n            </li>\r\n          </Tooltip>\r\n\r\n          {renderTextColorList()}\r\n        </ul>\r\n        {this.state.isShowTextPicker && (\r\n          <ColorPickerPanel\r\n            enableAlpha={false}\r\n            color={StorageUtil.getReaderConfig(\"textColor\")}\r\n            onChange={this.handleChooseTextColor}\r\n            mode=\"RGB\"\r\n            style={{\r\n              margin: 20,\r\n              animation: \"fade-in 0.2s ease-in-out 0s 1\",\r\n            }}\r\n          />\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ThemeList;\r\n","import { connect } from \"react-redux\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport ThemeList from \"./component\";\r\nimport { stateType } from \"../../../store\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    renderFunc: state.book.renderFunc,\r\n  };\r\n};\r\nconst actionCreator = {};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(ThemeList as any));\r\n","import React from \"react\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { SliderListProps, SliderListState } from \"./interface\";\r\nimport \"./sliderList.css\";\r\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\r\nimport { isElectron } from \"react-device-detect\";\r\nimport toast from \"react-hot-toast\";\r\nclass SliderList extends React.Component<SliderListProps, SliderListState> {\r\n  constructor(props: SliderListProps) {\r\n    super(props);\r\n    this.state = {\r\n      value:\r\n        this.props.mode === \"fontSize\"\r\n          ? StorageUtil.getReaderConfig(\"fontSize\") || \"17\"\r\n          : this.props.mode === \"scale\"\r\n          ? StorageUtil.getReaderConfig(\"scale\") || \"1\"\r\n          : this.props.mode === \"letterSpacing\"\r\n          ? StorageUtil.getReaderConfig(\"letterSpacing\") || \"0\"\r\n          : this.props.mode === \"paraSpacing\"\r\n          ? StorageUtil.getReaderConfig(\"paraSpacing\") || \"0\"\r\n          : this.props.mode === \"brightness\"\r\n          ? StorageUtil.getReaderConfig(\"brightness\") || \"1\"\r\n          : StorageUtil.getReaderConfig(\"margin\") || \"60\",\r\n    };\r\n  }\r\n  handleRest = () => {\r\n    if (this.props.mode === \"scale\" || this.props.mode === \"margin\") {\r\n      if (isElectron) {\r\n        toast(this.props.t(\"Take effect at next startup\"));\r\n      } else {\r\n        window.location.reload();\r\n      }\r\n      return;\r\n    }\r\n    this.props.renderFunc();\r\n  };\r\n  onValueChange = (event: any) => {\r\n    if (this.props.mode === \"fontSize\") {\r\n      const fontSize = event.target.value;\r\n      this.setState({ value: fontSize });\r\n      StorageUtil.setReaderConfig(\"fontSize\", fontSize);\r\n    } else if (this.props.mode === \"scale\") {\r\n      const scale = event.target.value;\r\n      this.setState({ value: scale });\r\n      StorageUtil.setReaderConfig(\"scale\", scale);\r\n    } else if (this.props.mode === \"letterSpacing\") {\r\n      const letterSpacing = event.target.value;\r\n      this.setState({ value: letterSpacing });\r\n      StorageUtil.setReaderConfig(\"letterSpacing\", letterSpacing);\r\n    } else if (this.props.mode === \"paraSpacing\") {\r\n      const paraSpacing = event.target.value;\r\n      this.setState({ value: paraSpacing });\r\n      StorageUtil.setReaderConfig(\"paraSpacing\", paraSpacing);\r\n    } else if (this.props.mode === \"brightness\") {\r\n      const brightness = event.target.value;\r\n      this.setState({ value: brightness });\r\n      StorageUtil.setReaderConfig(\"brightness\", brightness);\r\n    } else {\r\n      const margin = event.target.value;\r\n      this.setState({ value: margin });\r\n      StorageUtil.setReaderConfig(\"margin\", margin);\r\n    }\r\n  };\r\n  //使进度百分比随拖动实时变化\r\n  onValueInput = (event: any) => {\r\n    this.setState({ value: event.target.value });\r\n  };\r\n  handleMinus = (step: number) => {\r\n    this.setState({ value: parseFloat(this.state.value) - step + \"\" });\r\n    this.onValueChange({\r\n      target: { value: parseFloat(this.state.value) - step + \"\" },\r\n    });\r\n  };\r\n  handleAdd = (step: number) => {\r\n    this.setState({ value: parseFloat(this.state.value) + step + \"\" });\r\n    this.onValueChange({\r\n      target: { value: parseFloat(this.state.value) + step + \"\" },\r\n    });\r\n  };\r\n  render() {\r\n    return (\r\n      <div className=\"font-size-setting\">\r\n        <div className=\"font-size-title\">\r\n          <Trans>{this.props.title}</Trans>\r\n          <input\r\n            className=\"input-value\"\r\n            defaultValue={this.state.value}\r\n            type=\"number\"\r\n            step={\r\n              this.props.title === \"Page Width\" ||\r\n              this.props.title === \"Brightness\"\r\n                ? \"0.1\"\r\n                : \"1\"\r\n            }\r\n            onBlur={(event) => {\r\n              this.onValueChange(event);\r\n              this.handleRest();\r\n            }}\r\n          />\r\n          <span style={{ marginLeft: \"10px\" }}>{this.state.value}</span>\r\n        </div>\r\n\r\n        <span className=\"ultra-small-size\">{this.props.minLabel}</span>\r\n        <div className=\"font-size-selector\">\r\n          <input\r\n            className=\"input-progress\"\r\n            defaultValue={this.state.value}\r\n            type=\"range\"\r\n            max={this.props.maxValue}\r\n            min={this.props.minValue}\r\n            step={this.props.step}\r\n            onInput={(event) => {\r\n              this.onValueChange(event);\r\n            }}\r\n            onChange={(event) => {\r\n              this.onValueInput(event);\r\n            }}\r\n            onMouseUp={() => {\r\n              this.handleRest();\r\n            }}\r\n          />\r\n        </div>\r\n        {\r\n          <span\r\n            className=\"ultra-large-size\"\r\n            style={{ fontSize: \"16px\", right: \"5px\" }}\r\n          >\r\n            {this.props.maxLabel}\r\n          </span>\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default SliderList;\r\n","import { connect } from \"react-redux\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport SliderList from \"./component\";\r\nimport { stateType } from \"../../../store\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    renderFunc: state.book.renderFunc,\r\n  };\r\n};\r\nconst actionCreator = {};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(SliderList as any));\r\n","//图书样式设置的下拉菜单页面\r\nimport React from \"react\";\r\nimport { dropdownList } from \"../../../constants/dropdownList\";\r\nimport \"./dropdownList.css\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { DropdownListProps, DropdownListState } from \"./interface\";\r\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\r\nimport { isElectron } from \"react-device-detect\";\r\nclass DropdownList extends React.Component<\r\n  DropdownListProps,\r\n  DropdownListState\r\n> {\r\n  constructor(props: DropdownListProps) {\r\n    super(props);\r\n    this.state = {\r\n      currentFontFamilyIndex: dropdownList[0].option.findIndex((item: any) => {\r\n        return (\r\n          item ===\r\n          (StorageUtil.getReaderConfig(\"fontFamily\") || \"Built-in font\")\r\n        );\r\n      }),\r\n      currentLineHeightIndex: dropdownList[1].option.findIndex((item: any) => {\r\n        return item === (StorageUtil.getReaderConfig(\"lineHeight\") || \"1.25\");\r\n      }),\r\n      currentTextAlignIndex: dropdownList[2].option.findIndex((item: any) => {\r\n        return item === (StorageUtil.getReaderConfig(\"textAlign\") || \"left\");\r\n      }),\r\n      chineseConversionIndex: dropdownList[3].option.findIndex((item: any) => {\r\n        return (\r\n          item === (StorageUtil.getReaderConfig(\"convertChinese\") || \"Default\")\r\n        );\r\n      }),\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    //使下拉菜单选中预设的值\r\n    if (isElectron) {\r\n      const fontList = window.require(\"font-list\");\r\n      fontList.getFonts({ disableQuoting: true }).then((result) => {\r\n        if (!result || result.length === 0) return;\r\n        dropdownList[0].option = result;\r\n        dropdownList[0].option.push(\"Built-in font\");\r\n        this.setState(\r\n          {\r\n            currentFontFamilyIndex: dropdownList[0].option.findIndex(\r\n              (item: any) => {\r\n                return (\r\n                  item ===\r\n                  (StorageUtil.getReaderConfig(\"fontFamily\") || \"Built-in font\")\r\n                );\r\n              }\r\n            ),\r\n          },\r\n          () => {\r\n            document\r\n              .querySelector(\".paragraph-character-setting\")!\r\n              .children[0].children[1].children[\r\n                this.state.currentFontFamilyIndex === -1\r\n                  ? 0\r\n                  : this.state.currentFontFamilyIndex\r\n              ]?.setAttribute(\"selected\", \"selected\");\r\n          }\r\n        );\r\n      });\r\n    }\r\n\r\n    document\r\n      .querySelector(\".paragraph-character-setting\")!\r\n      .children[1].children[1].children[\r\n        this.state.currentLineHeightIndex\r\n      ]?.setAttribute(\"selected\", \"selected\");\r\n    document\r\n      .querySelector(\".paragraph-character-setting\")!\r\n      .children[2].children[1].children[\r\n        this.state.currentTextAlignIndex\r\n      ]?.setAttribute(\"selected\", \"selected\");\r\n    document\r\n      .querySelector(\".paragraph-character-setting\")!\r\n      .children[3].children[1].children[\r\n        this.state.chineseConversionIndex\r\n      ]?.setAttribute(\"selected\", \"selected\");\r\n  }\r\n\r\n  //切换不同的样式\r\n  handleView(event: any, option: string) {\r\n    let arr = event.target.value.split(\",\");\r\n    StorageUtil.setReaderConfig(option, arr[0]);\r\n    switch (option) {\r\n      case \"fontFamily\":\r\n        this.setState({\r\n          currentFontFamilyIndex: arr[1],\r\n        });\r\n\r\n        break;\r\n\r\n      case \"lineHeight\":\r\n        this.setState({\r\n          currentLineHeightIndex: arr[1],\r\n        });\r\n\r\n        break;\r\n      case \"textAlign\":\r\n        this.setState({\r\n          currentTextAlignIndex: arr[1],\r\n        });\r\n\r\n        break;\r\n      case \"convertChinese\":\r\n        this.setState({\r\n          chineseConversionIndex: arr[1],\r\n        });\r\n\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    this.props.renderFunc();\r\n  }\r\n  render() {\r\n    const renderParagraphCharacter = () => {\r\n      return dropdownList.map((item) => (\r\n        <li className=\"paragraph-character-container\" key={item.id}>\r\n          <p className=\"general-setting-title\">\r\n            <Trans>{item.title}</Trans>\r\n          </p>\r\n          <select\r\n            name=\"\"\r\n            className=\"general-setting-dropdown\"\r\n            onChange={(event) => {\r\n              this.handleView(event, item.value);\r\n            }}\r\n          >\r\n            {item.option.map((subItem: string, index: number) => (\r\n              <option\r\n                value={[subItem, index.toString()]}\r\n                key={index}\r\n                className=\"general-setting-option\"\r\n              >\r\n                {this.props.t(subItem)}\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </li>\r\n      ));\r\n    };\r\n\r\n    return (\r\n      <ul className=\"paragraph-character-setting\">\r\n        {renderParagraphCharacter()}\r\n      </ul>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DropdownList;\r\n","import { connect } from \"react-redux\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport DropdownList from \"./component\";\r\nimport { stateType } from \"../../../store\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    renderFunc: state.book.renderFunc,\r\n  };\r\n};\r\nconst actionCreator = {};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(DropdownList as any));\r\n","import React from \"react\";\r\nimport \"./modeControl.css\";\r\nimport { ModeControlProps, ModeControlState } from \"./interface\";\r\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { Tooltip } from \"react-tippy\";\r\nimport { isElectron } from \"react-device-detect\";\r\nimport toast from \"react-hot-toast\";\r\n\r\nclass ModeControl extends React.Component<ModeControlProps, ModeControlState> {\r\n  constructor(props: ModeControlProps) {\r\n    super(props);\r\n    this.state = {\r\n      readerMode: StorageUtil.getReaderConfig(\"readerMode\") || \"double\",\r\n    };\r\n  }\r\n\r\n  handleChangeMode = (mode: string) => {\r\n    this.setState({ readerMode: mode });\r\n    StorageUtil.setReaderConfig(\"readerMode\", mode);\r\n    if (isElectron) {\r\n      toast(this.props.t(\"Take effect at next startup\"));\r\n    } else {\r\n      window.location.reload();\r\n    }\r\n  };\r\n  render() {\r\n    return (\r\n      <div className=\"background-color-setting\">\r\n        <div\r\n          className=\"background-color-text\"\r\n          style={{ position: \"relative\", bottom: \"15px\" }}\r\n        >\r\n          <Trans>View Mode</Trans>\r\n        </div>\r\n        <div className=\"single-control-container\">\r\n          <Tooltip\r\n            title={this.props.t(\"Single-Page Mode\")}\r\n            position=\"top\"\r\n            trigger=\"mouseenter\"\r\n          >\r\n            <div\r\n              className=\"single-mode-container\"\r\n              onClick={() => {\r\n                this.handleChangeMode(\"single\");\r\n              }}\r\n              style={this.state.readerMode === \"single\" ? {} : { opacity: 0.4 }}\r\n            >\r\n              <span className=\"icon-single-page single-page-icon\"></span>\r\n            </div>\r\n          </Tooltip>\r\n          <Tooltip\r\n            title={this.props.t(\"Double-Page Mode\")}\r\n            position=\"top\"\r\n            trigger=\"mouseenter\"\r\n          >\r\n            <div\r\n              className=\"double-mode-container\"\r\n              onClick={() => {\r\n                this.handleChangeMode(\"double\");\r\n              }}\r\n              style={this.state.readerMode === \"double\" ? {} : { opacity: 0.4 }}\r\n            >\r\n              <span className=\"icon-two-page two-page-icon\"></span>\r\n            </div>\r\n          </Tooltip>\r\n          <Tooltip\r\n            title={this.props.t(\"Scroll Mode\")}\r\n            position=\"top\"\r\n            trigger=\"mouseenter\"\r\n          >\r\n            <div\r\n              className=\"double-mode-container\"\r\n              onClick={() => {\r\n                this.handleChangeMode(\"scroll\");\r\n              }}\r\n              style={this.state.readerMode === \"scroll\" ? {} : { opacity: 0.4 }}\r\n            >\r\n              <span className=\"icon-scroll two-page-icon\"></span>\r\n            </div>\r\n          </Tooltip>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default ModeControl;\r\n","import { connect } from \"react-redux\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport ModeControl from \"./component\";\r\nimport { stateType } from \"../../../store\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    renderFunc: state.book.renderFunc,\r\n  };\r\n};\r\nconst actionCreator = {};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(ModeControl as any));\r\n","import React from \"react\";\r\nimport { TextToSpeechProps, TextToSpeechState } from \"./interface\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { speedList } from \"../../constants/dropdownList\";\r\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\n\r\nclass TextToSpeech extends React.Component<\r\n  TextToSpeechProps,\r\n  TextToSpeechState\r\n> {\r\n  constructor(props: TextToSpeechProps) {\r\n    super(props);\r\n    this.state = {\r\n      isSupported: false,\r\n      isAudioOn: false,\r\n      voices: [],\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    if (\"speechSynthesis\" in window) {\r\n      this.setState({ isSupported: true });\r\n    }\r\n    if (this.state.isAudioOn) {\r\n      window.speechSynthesis && window.speechSynthesis.cancel();\r\n      this.setState({ isAudioOn: false });\r\n    }\r\n  }\r\n  handleChangeAudio = () => {\r\n    if (this.state.isAudioOn) {\r\n      window.speechSynthesis.cancel();\r\n      this.setState({ isAudioOn: false });\r\n    } else {\r\n      const setSpeech = () => {\r\n        return new Promise((resolve, reject) => {\r\n          let synth = window.speechSynthesis;\r\n          let id;\r\n\r\n          id = setInterval(() => {\r\n            if (synth.getVoices().length !== 0) {\r\n              resolve(synth.getVoices());\r\n              clearInterval(id);\r\n            } else {\r\n              this.setState({ isSupported: false });\r\n            }\r\n          }, 10);\r\n        });\r\n      };\r\n\r\n      let s = setSpeech();\r\n      s.then((voices) => {\r\n        this.setState({ voices }, () => {\r\n          this.setState({ isAudioOn: true }, () => {\r\n            this.handleAudio();\r\n            if (\r\n              document.querySelector(\"#text-speech-speed\") &&\r\n              document.querySelector(\"#text-speech-voice\") &&\r\n              document.querySelector(\"#text-speech-speed\")!.children[0] &&\r\n              document.querySelector(\"#text-speech-voice\")!.children[0]\r\n            ) {\r\n              document\r\n                .querySelector(\"#text-speech-speed\")!\r\n                .children[\r\n                  speedList.option.indexOf(\r\n                    StorageUtil.getReaderConfig(\"voiceSpeed\") || \"1\"\r\n                  )\r\n                ]?.setAttribute(\"selected\", \"selected\");\r\n              document\r\n                .querySelector(\"#text-speech-voice\")!\r\n                .children[\r\n                  StorageUtil.getReaderConfig(\"voiceIndex\") || 0\r\n                ]?.setAttribute(\"selected\", \"selected\");\r\n            }\r\n          });\r\n        });\r\n      });\r\n    }\r\n  };\r\n  handleAudio = async () => {\r\n    let text = \"\";\r\n\r\n    text = await this.props.htmlBook.rendition.visibleText();\r\n    text = text\r\n      .replace(/\\s\\s/g, \"\")\r\n      .replace(/\\r/g, \"\")\r\n      .replace(/\\n/g, \"\")\r\n      .replace(/\\t/g, \"\")\r\n      .replace(/\\f/g, \"\");\r\n    this.handleSpeech(\r\n      text,\r\n      StorageUtil.getReaderConfig(\"voiceIndex\") || 0,\r\n      StorageUtil.getReaderConfig(\"voiceSpeed\") || 1\r\n    );\r\n  };\r\n  handleSpeech = (text: string, voiceIndex: number, speed: number) => {\r\n    var msg = new SpeechSynthesisUtterance();\r\n    msg.text = text;\r\n    msg.voice = window.speechSynthesis.getVoices()[voiceIndex];\r\n    msg.rate = speed;\r\n    window.speechSynthesis.speak(msg);\r\n    msg.onerror = (err) => {\r\n      console.log(err);\r\n    };\r\n\r\n    msg.onend = (event) => {\r\n      if (!(this.state.isAudioOn && this.props.isReading)) {\r\n        return;\r\n      }\r\n      this.props.htmlBook.rendition.next();\r\n      this.handleAudio();\r\n    };\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        {this.state.isSupported ? (\r\n          <>\r\n            <div className=\"single-control-switch-container\">\r\n              <span className=\"single-control-switch-title\">\r\n                <Trans>Turn on text-to-speech</Trans>\r\n              </span>\r\n\r\n              <span\r\n                className=\"single-control-switch\"\r\n                onClick={() => {\r\n                  this.handleChangeAudio();\r\n                }}\r\n                style={this.state.isAudioOn ? {} : { opacity: 0.6 }}\r\n              >\r\n                <span\r\n                  className=\"single-control-button\"\r\n                  style={\r\n                    this.state.isAudioOn\r\n                      ? {\r\n                          transform: \"translateX(20px)\",\r\n                          transition: \"transform 0.5s ease\",\r\n                        }\r\n                      : {\r\n                          transform: \"translateX(0px)\",\r\n                          transition: \"transform 0.5s ease\",\r\n                        }\r\n                  }\r\n                ></span>\r\n              </span>\r\n            </div>\r\n            {this.state.isAudioOn && this.state.voices.length > 0 && (\r\n              <div\r\n                className=\"setting-dialog-new-title\"\r\n                style={{\r\n                  marginLeft: \"20px\",\r\n                  width: \"88%\",\r\n                  marginTop: \"20px\",\r\n                  fontWeight: 500,\r\n                }}\r\n              >\r\n                <Trans>Voice</Trans>\r\n                <select\r\n                  name=\"\"\r\n                  className=\"lang-setting-dropdown\"\r\n                  id=\"text-speech-voice\"\r\n                  onChange={(event) => {\r\n                    StorageUtil.setReaderConfig(\r\n                      \"voiceIndex\",\r\n                      event.target.value\r\n                    );\r\n                    window.speechSynthesis.cancel();\r\n                  }}\r\n                >\r\n                  {this.state.voices.map((item, index) => {\r\n                    return (\r\n                      <option\r\n                        value={index}\r\n                        key={item.name}\r\n                        className=\"lang-setting-option\"\r\n                      >\r\n                        {item.name}\r\n                      </option>\r\n                    );\r\n                  })}\r\n                </select>\r\n              </div>\r\n            )}\r\n            {this.state.isAudioOn && (\r\n              <div\r\n                className=\"setting-dialog-new-title\"\r\n                style={{ marginLeft: \"20px\", width: \"88%\", fontWeight: 500 }}\r\n              >\r\n                <Trans>Speed</Trans>\r\n                <select\r\n                  name=\"\"\r\n                  id=\"text-speech-speed\"\r\n                  className=\"lang-setting-dropdown\"\r\n                  onChange={(event) => {\r\n                    StorageUtil.setReaderConfig(\r\n                      \"voiceSpeed\",\r\n                      event.target.value\r\n                    );\r\n                    window.speechSynthesis.cancel();\r\n                  }}\r\n                >\r\n                  {speedList.option.map((item) => (\r\n                    <option value={item} className=\"lang-setting-option\">\r\n                      {item}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n            )}\r\n          </>\r\n        ) : null}\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default TextToSpeech;\r\n","import { withTranslation } from \"react-i18next\";\r\nimport { connect } from \"react-redux\";\r\nimport TextToSpeech from \"./component\";\r\nimport { stateType } from \"../../store\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentBook: state.book.currentBook,\r\n    htmlBook: state.reader.htmlBook,\r\n    locations: state.progressPanel.locations,\r\n    isReading: state.book.isReading,\r\n  };\r\n};\r\nconst actionCreator = {};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(TextToSpeech as any));\r\n","import React from \"react\";\r\nimport { SettingSwitchProps, SettingSwitchState } from \"./interface\";\r\nimport { Trans } from \"react-i18next\";\r\nimport TextToSpeech from \"../../textToSpeech\";\r\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\r\nimport { readerSettingList } from \"../../../constants/settingList\";\r\nimport { isElectron } from \"react-device-detect\";\r\nimport toast from \"react-hot-toast\";\r\nclass SettingSwitch extends React.Component<\r\n  SettingSwitchProps,\r\n  SettingSwitchState\r\n> {\r\n  constructor(props: SettingSwitchProps) {\r\n    super(props);\r\n    this.state = {\r\n      isBold: StorageUtil.getReaderConfig(\"isBold\") === \"yes\",\r\n      isIndent: StorageUtil.getReaderConfig(\"isIndent\") === \"yes\",\r\n      isSliding: StorageUtil.getReaderConfig(\"isSliding\") === \"yes\",\r\n      isUnderline: StorageUtil.getReaderConfig(\"isUnderline\") === \"yes\",\r\n      isShadow: StorageUtil.getReaderConfig(\"isShadow\") === \"yes\",\r\n      isItalic: StorageUtil.getReaderConfig(\"isItalic\") === \"yes\",\r\n      isInvert: StorageUtil.getReaderConfig(\"isInvert\") === \"yes\",\r\n      isHideBackground:\r\n        StorageUtil.getReaderConfig(\"isHideBackground\") === \"yes\",\r\n      isHideFooter: StorageUtil.getReaderConfig(\"isHideFooter\") === \"yes\",\r\n      isHideHeader: StorageUtil.getReaderConfig(\"isHideHeader\") === \"yes\",\r\n      isHidePageButton:\r\n        StorageUtil.getReaderConfig(\"isHidePageButton\") === \"yes\",\r\n      isHideMenuButton:\r\n        StorageUtil.getReaderConfig(\"isHideMenuButton\") === \"yes\",\r\n    };\r\n  }\r\n\r\n  _handleRest = () => {\r\n    if (isElectron) {\r\n      toast(this.props.t(\"Take effect at next startup\"));\r\n    } else {\r\n      window.location.reload();\r\n    }\r\n  };\r\n\r\n  _handleChange = (stateName: string) => {\r\n    this.setState({ [stateName]: !this.state[stateName] } as any, () => {\r\n      StorageUtil.setReaderConfig(\r\n        stateName,\r\n        this.state[stateName] ? \"yes\" : \"no\"\r\n      );\r\n      toast(this.props.t(\"Change Successfully\"));\r\n      setTimeout(() => {\r\n        this.props.renderFunc();\r\n      }, 500);\r\n    });\r\n  };\r\n\r\n  handleChange = (stateName: string) => {\r\n    this.setState({ [stateName]: !this.state[stateName] } as any);\r\n    StorageUtil.setReaderConfig(\r\n      stateName,\r\n      this.state[stateName] ? \"no\" : \"yes\"\r\n    );\r\n\r\n    toast(this.props.t(\"Change Successfully\"));\r\n    setTimeout(() => {\r\n      this._handleRest();\r\n    }, 500);\r\n  };\r\n  render() {\r\n    return (\r\n      <>\r\n        <TextToSpeech />\r\n        {readerSettingList.map((item) => (\r\n          <div className=\"single-control-switch-container\" key={item.title}>\r\n            <span className=\"single-control-switch-title\">\r\n              <Trans>{item.title}</Trans>\r\n            </span>\r\n\r\n            <span\r\n              className=\"single-control-switch\"\r\n              onClick={() => {\r\n                switch (item.propName) {\r\n                  case \"isBold\":\r\n                    this._handleChange(\"isBold\");\r\n                    break;\r\n                  case \"isIndent\":\r\n                    this._handleChange(\"isIndent\");\r\n                    break;\r\n                  case \"isSliding\":\r\n                    this._handleChange(\"isSliding\");\r\n                    break;\r\n                  case \"isItalic\":\r\n                    this._handleChange(\"isItalic\");\r\n                    break;\r\n                  case \"isUnderline\":\r\n                    this._handleChange(\"isUnderline\");\r\n                    break;\r\n                  case \"isShadow\":\r\n                    this._handleChange(\"isShadow\");\r\n                    break;\r\n                  case \"isInvert\":\r\n                    this._handleChange(\"isInvert\");\r\n                    break;\r\n                  case \"isHideFooter\":\r\n                    this.handleChange(\"isHideFooter\");\r\n                    break;\r\n                  case \"isHideHeader\":\r\n                    this.handleChange(\"isHideHeader\");\r\n                    break;\r\n                  case \"isHideBackground\":\r\n                    this.handleChange(\"isHideBackground\");\r\n                    break;\r\n                  case \"isHidePageButton\":\r\n                    this.handleChange(\"isHidePageButton\");\r\n                    break;\r\n                  case \"isHideMenuButton\":\r\n                    this.handleChange(\"isHideMenuButton\");\r\n                    break;\r\n                  default:\r\n                    break;\r\n                }\r\n              }}\r\n              style={this.state[item.propName] ? {} : { opacity: 0.6 }}\r\n            >\r\n              <span\r\n                className=\"single-control-button\"\r\n                style={\r\n                  !this.state[item.propName]\r\n                    ? {\r\n                        transform: \"translateX(0px)\",\r\n                        transition: \"transform 0.5s ease\",\r\n                      }\r\n                    : {\r\n                        transform: \"translateX(20px)\",\r\n                        transition: \"transform 0.5s ease\",\r\n                      }\r\n                }\r\n              ></span>\r\n            </span>\r\n          </div>\r\n        ))}\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default SettingSwitch;\r\n","import { withTranslation } from \"react-i18next\";\r\nimport { connect } from \"react-redux\";\r\nimport SettingSwitch from \"./component\";\r\nimport { stateType } from \"../../../store\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentBook: state.book.currentBook,\r\n    locations: state.progressPanel.locations,\r\n    isReading: state.book.isReading,\r\n    renderFunc: state.book.renderFunc,\r\n  };\r\n};\r\nconst actionCreator = {};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(SettingSwitch as any));\r\n","import React from \"react\";\r\nimport \"./settingPanel.css\";\r\nimport ThemeList from \"../../../components/readerSettings/themeList\";\r\nimport SliderList from \"../../../components/readerSettings/sliderList\";\r\nimport DropdownList from \"../../../components/readerSettings/dropdownList\";\r\nimport ModeControl from \"../../../components/readerSettings/modeControl\";\r\nimport SettingSwitch from \"../../../components/readerSettings/settingSwitch\";\r\nimport { SettingPanelProps, SettingPanelState } from \"./interface\";\r\nimport { Trans } from \"react-i18next\";\r\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\r\nimport { Tooltip } from \"react-tippy\";\r\n\r\nclass SettingPanel extends React.Component<\r\n  SettingPanelProps,\r\n  SettingPanelState\r\n> {\r\n  constructor(props: SettingPanelProps) {\r\n    super(props);\r\n    this.state = {\r\n      readerMode: StorageUtil.getReaderConfig(\"readerMode\") || \"double\",\r\n      isSettingLocked:\r\n        StorageUtil.getReaderConfig(\"isSettingLocked\") === \"yes\" ? true : false,\r\n    };\r\n  }\r\n\r\n  handleLock = () => {\r\n    this.setState({ isSettingLocked: !this.state.isSettingLocked }, () => {\r\n      StorageUtil.setReaderConfig(\r\n        \"isSettingLocked\",\r\n        this.state.isSettingLocked ? \"yes\" : \"no\"\r\n      );\r\n    });\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"setting-panel-parent\">\r\n        <Tooltip\r\n          title={this.props.t(this.state.isSettingLocked ? \"Unlock\" : \"Lock\")}\r\n          position=\"bottom\"\r\n          trigger=\"mouseenter\"\r\n          style={{ height: \"30px\", display: \"inline-block\", float: \"left\" }}\r\n        >\r\n          <span\r\n            className={\r\n              this.state.isSettingLocked\r\n                ? \"icon-lock lock-icon\"\r\n                : \"icon-unlock lock-icon\"\r\n            }\r\n            onClick={() => {\r\n              this.handleLock();\r\n            }}\r\n          ></span>\r\n        </Tooltip>\r\n        <div className=\"setting-panel-title\">\r\n          <Trans>Reading Option</Trans>\r\n        </div>\r\n        <div className=\"setting-panel\">\r\n          <ModeControl />\r\n          <ThemeList />\r\n          <SliderList\r\n            {...{\r\n              maxValue: 40,\r\n              minValue: 13,\r\n              mode: \"fontSize\",\r\n              minLabel: \"13\",\r\n              maxLabel: \"40\",\r\n              step: 1,\r\n              title: \"Font Size\",\r\n            }}\r\n          />\r\n\r\n          {this.state.readerMode && this.state.readerMode === \"double\" && (\r\n            <SliderList\r\n              {...{\r\n                maxValue: 80,\r\n                minValue: 0,\r\n                mode: \"margin\",\r\n                minLabel: \"0\",\r\n                maxLabel: \"80\",\r\n                step: 5,\r\n                title: \"Margin\",\r\n              }}\r\n            />\r\n          )}\r\n\r\n          <SliderList\r\n            {...{\r\n              maxValue: 20,\r\n              minValue: 0,\r\n              mode: \"letterSpacing\",\r\n              minLabel: \"0\",\r\n              maxLabel: \"20\",\r\n              step: 1,\r\n              title: \"Letter Spacing\",\r\n            }}\r\n          />\r\n\r\n          <SliderList\r\n            {...{\r\n              maxValue: 60,\r\n              minValue: 0,\r\n              mode: \"paraSpacing\",\r\n              minLabel: \"0\",\r\n              maxLabel: \"60\",\r\n              step: 1,\r\n              title: \"Paragraph Spacing\",\r\n            }}\r\n          />\r\n\r\n          {this.state.readerMode && this.state.readerMode !== \"double\" ? (\r\n            <SliderList\r\n              {...{\r\n                maxValue: 3,\r\n                minValue: 0.5,\r\n                mode: \"scale\",\r\n                minLabel: \"0.5\",\r\n                maxLabel: \"3\",\r\n                step: 0.1,\r\n                title: \"Page Width\",\r\n              }}\r\n            />\r\n          ) : null}\r\n          <SliderList\r\n            {...{\r\n              maxValue: 2,\r\n              minValue: 0.5,\r\n              mode: \"brightness\",\r\n              minLabel: \"0.5\",\r\n              maxLabel: \"2\",\r\n              step: 0.1,\r\n              title: \"Brightness\",\r\n            }}\r\n          />\r\n          <DropdownList />\r\n          <SettingSwitch />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default SettingPanel;\r\n","import { withTranslation } from \"react-i18next\";\r\nimport { connect } from \"react-redux\";\r\nimport SettingPanel from \"./component\";\r\nimport { stateType } from \"../../../store\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentBook: state.book.currentBook,\r\n    locations: state.progressPanel.locations,\r\n    isReading: state.book.isReading,\r\n  };\r\n};\r\nconst actionCreator = {};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(SettingPanel as any));\r\n","import React from \"react\";\r\nimport \"./contentList.css\";\r\nimport { ContentListProps, ContentListState } from \"./interface\";\r\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\r\nimport _ from \"underscore\";\r\nimport RecordLocation from \"../../../utils/readUtils/recordLocation\";\r\nclass ContentList extends React.Component<ContentListProps, ContentListState> {\r\n  constructor(props: ContentListProps) {\r\n    super(props);\r\n    this.state = {\r\n      chapters: [],\r\n      isCollapsed: true,\r\n      currentIndex: -1,\r\n      currentChapter: \"\",\r\n      isExpandContent: StorageUtil.getReaderConfig(\"isExpandContent\") === \"yes\",\r\n    };\r\n    this.handleJump = this.handleJump.bind(this);\r\n  }\r\n  componentDidMount() {\r\n    this.props.htmlBook &&\r\n      this.setState({\r\n        chapters: this.props.htmlBook.chapters,\r\n      });\r\n  }\r\n  flatChapter(chapters: any) {\r\n    let newChapter: any = [];\r\n    for (let i = 0; i < chapters.length; i++) {\r\n      if (chapters[i].subitems[0]) {\r\n        newChapter.push(chapters[i]);\r\n        newChapter = newChapter.concat(this.flatChapter(chapters[i].subitems));\r\n      } else {\r\n        newChapter.push(chapters[i]);\r\n      }\r\n    }\r\n    return newChapter;\r\n  }\r\n  handleJump(event: any) {\r\n    event.preventDefault();\r\n    let href = event.target.getAttribute(\"href\");\r\n    let title =\r\n      this.props.htmlBook.flattenChapters[\r\n        _.findIndex(this.props.htmlBook.flattenChapters, { href })\r\n      ].label;\r\n    RecordLocation.recordHtmlLocation(\r\n      this.props.currentBook.key,\r\n      \"test\",\r\n      title,\r\n      \"test\",\r\n      \"0\",\r\n      \"\"\r\n    );\r\n    this.props.htmlBook.rendition.goToChapter(title);\r\n    this.props.handleCurrentChapter(title);\r\n  }\r\n  UNSAFE_componentWillReceiveProps(nextProps: ContentListProps) {\r\n    if (nextProps.htmlBook && nextProps.htmlBook !== this.props.htmlBook) {\r\n      this.setState({ chapters: nextProps.htmlBook.chapters });\r\n    }\r\n  }\r\n  render() {\r\n    const renderContentList = (items: any, level: number) => {\r\n      level++;\r\n      return items.map((item: any, index: number) => {\r\n        return (\r\n          <li key={index} className=\"book-content-list\">\r\n            {item.subitems.length > 0 &&\r\n              level <= 2 &&\r\n              !this.state.isExpandContent && (\r\n                <span\r\n                  className=\"icon-dropdown content-dropdown\"\r\n                  onClick={() => {\r\n                    this.setState({\r\n                      currentIndex:\r\n                        this.state.currentIndex === index ? -1 : index,\r\n                    });\r\n                  }}\r\n                  style={\r\n                    this.state.currentIndex === index\r\n                      ? {}\r\n                      : { transform: \"rotate(-90deg)\" }\r\n                  }\r\n                ></span>\r\n              )}\r\n\r\n            <a\r\n              href={item.href}\r\n              onClick={this.handleJump}\r\n              className=\"book-content-name\"\r\n            >\r\n              {item.label.indexOf(\"#\") > -1\r\n                ? item.label.split(\"#\")[0]\r\n                : item.label}\r\n            </a>\r\n            {item.subitems.length > 0 &&\r\n            (this.state.currentIndex === index ||\r\n              level > 2 ||\r\n              this.state.isExpandContent) ? (\r\n              <ul>{renderContentList(item.subitems, level)}</ul>\r\n            ) : null}\r\n          </li>\r\n        );\r\n      });\r\n    };\r\n\r\n    return (\r\n      <div className=\"book-content-container\">\r\n        <ul className=\"book-content\">\r\n          {this.state.chapters && renderContentList(this.state.chapters, 1)}\r\n        </ul>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ContentList;\r\n","import { connect } from \"react-redux\";\r\nimport { stateType } from \"../../../store\";\r\nimport ContentList from \"./component\";\r\nimport { handleCurrentChapter } from \"../../../store/actions\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentBook: state.book.currentBook,\r\n    chapters: state.reader.chapters,\r\n    htmlBook: state.reader.htmlBook,\r\n    renderFunc: state.book.renderFunc,\r\n  };\r\n};\r\nconst actionCreator = { handleCurrentChapter };\r\nexport default connect(mapStateToProps, actionCreator)(ContentList);\r\n","import React from \"react\";\r\nimport \"./navList.css\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { NavListProps, NavListState } from \"./interface\";\r\nimport DeleteIcon from \"../../../components/deleteIcon\";\r\nimport toast from \"react-hot-toast\";\r\nclass NavList extends React.Component<NavListProps, NavListState> {\r\n  constructor(props: NavListProps) {\r\n    super(props);\r\n    this.state = {\r\n      deleteIndex: -1,\r\n    };\r\n  }\r\n  //跳转到图书的指定位置\r\n  async handleJump(cfi: string) {\r\n    if (!cfi) {\r\n      toast(this.props.t(\"Wrong bookmark\"));\r\n      return;\r\n    }\r\n    let bookLocation = JSON.parse(cfi) || {};\r\n    await this.props.htmlBook.rendition.goToPosition(\r\n      JSON.stringify({\r\n        text: bookLocation.text,\r\n        chapterTitle: bookLocation.chapterTitle,\r\n        count: bookLocation.count,\r\n        percentage: bookLocation.percentage,\r\n        cfi: bookLocation.cfi,\r\n      })\r\n    );\r\n  }\r\n  handleShowDelete = (index: number) => {\r\n    this.setState({ deleteIndex: index });\r\n  };\r\n  render() {\r\n    let currentData: any = (\r\n      (this.props.currentTab === \"bookmarks\"\r\n        ? this.props.bookmarks\r\n        : this.props.currentTab === \"notes\"\r\n        ? this.props.notes.filter((item) => item.notes !== \"\")\r\n        : this.props.digests) as any\r\n    ).filter((item: any) => {\r\n      return item.bookKey === this.props.currentBook.key;\r\n    });\r\n    const renderBookNavList = () => {\r\n      return currentData.reverse().map((item: any, index: number) => {\r\n        const bookmarkProps = {\r\n          itemKey: item.key,\r\n          mode: this.props.currentTab === \"bookmarks\" ? \"bookmarks\" : \"notes\",\r\n        };\r\n        return (\r\n          <li\r\n            className=\"book-bookmark-list\"\r\n            key={item.key}\r\n            onMouseEnter={() => {\r\n              this.handleShowDelete(index);\r\n            }}\r\n            onMouseLeave={() => {\r\n              this.handleShowDelete(-1);\r\n            }}\r\n          >\r\n            <p className=\"book-bookmark-digest\">\r\n              {this.props.currentTab === \"bookmarks\"\r\n                ? item.label\r\n                : this.props.currentTab === \"notes\"\r\n                ? item.notes\r\n                : item.text}\r\n            </p>\r\n            <div className=\"bookmark-page-list-item-title\">\r\n              <Trans>{item.chapter}</Trans>\r\n            </div>\r\n            <div className=\"book-bookmark-progress\">\r\n              {Math.floor(item.percentage * 100)}%\r\n            </div>\r\n            {this.state.deleteIndex === index ? (\r\n              <DeleteIcon {...bookmarkProps} />\r\n            ) : null}\r\n            <div\r\n              className=\"book-bookmark-link\"\r\n              onClick={() => {\r\n                this.handleJump(item.cfi);\r\n              }}\r\n              style={{ cursor: \"pointer\" }}\r\n            >\r\n              <Trans>Go To</Trans>\r\n            </div>\r\n          </li>\r\n        );\r\n      });\r\n    };\r\n    if (!currentData[0]) {\r\n      return (\r\n        <div className=\"navigation-panel-empty-bookmark\">\r\n          <Trans>Empty</Trans>\r\n        </div>\r\n      );\r\n    }\r\n    return (\r\n      <div className=\"book-bookmark-container\">\r\n        <ul className=\"book-bookmark\">{renderBookNavList()}</ul>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default NavList;\r\n","import { connect } from \"react-redux\";\r\nimport { stateType } from \"../../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport NavList from \"./component\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentBook: state.book.currentBook,\r\n    htmlBook: state.reader.htmlBook,\r\n\r\n    bookmarks: state.reader.bookmarks,\r\n    notes: state.reader.notes,\r\n    digests: state.reader.digests,\r\n  };\r\n};\r\nconst actionCreator = {};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(NavList as any));\r\n","import React from \"react\";\r\nimport \"./navigationPanel.css\";\r\nimport ContentList from \"../../lists/contentList\";\r\nimport BookNavList from \"../../lists/navList\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { NavigationPanelProps, NavigationPanelState } from \"./interface\";\r\nimport SearchBox from \"../../../components/searchBox\";\r\nimport Parser from \"html-react-parser\";\r\nimport EmptyCover from \"../../../components/emptyCover\";\r\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\r\nimport { Tooltip } from \"react-tippy\";\r\n\r\nclass NavigationPanel extends React.Component<\r\n  NavigationPanelProps,\r\n  NavigationPanelState\r\n> {\r\n  constructor(props: NavigationPanelProps) {\r\n    super(props);\r\n    this.state = {\r\n      currentTab: \"contents\",\r\n      chapters: [],\r\n      isSearch: false,\r\n      searchList: null,\r\n      startIndex: 0,\r\n      currentIndex: 0,\r\n      isNavLocked:\r\n        StorageUtil.getReaderConfig(\"isNavLocked\") === \"yes\" ? true : false,\r\n    };\r\n  }\r\n  handleSearchState = (isSearch: boolean) => {\r\n    this.setState({ isSearch });\r\n  };\r\n  handleSearchList = (searchList: any) => {\r\n    this.setState({ searchList });\r\n  };\r\n  componentDidMount() {\r\n    this.props.handleFetchBookmarks();\r\n  }\r\n\r\n  handleChangeTab = (currentTab: string) => {\r\n    this.setState({ currentTab });\r\n  };\r\n  handleLock = () => {\r\n    this.setState({ isNavLocked: !this.state.isNavLocked }, () => {\r\n      StorageUtil.setReaderConfig(\r\n        \"isNavLocked\",\r\n        this.state.isNavLocked ? \"yes\" : \"no\"\r\n      );\r\n    });\r\n  };\r\n  renderSearchList = () => {\r\n    if (!this.state.searchList[0]) {\r\n      return (\r\n        <div className=\"navigation-panel-empty-bookmark\">\r\n          <Trans>Empty</Trans>\r\n        </div>\r\n      );\r\n    }\r\n    return this.state.searchList\r\n      .slice(\r\n        this.state.currentIndex * 10,\r\n        this.state.currentIndex * 10 + 10 > this.state.searchList.length\r\n          ? this.state.searchList.length\r\n          : this.state.currentIndex * 10 + 10\r\n      )\r\n      .map((item: any, index: number) => {\r\n        return (\r\n          <li\r\n            className=\"nav-search-list-item\"\r\n            key={index}\r\n            onClick={async () => {\r\n              let bookLocation = JSON.parse(item.cfi) || {};\r\n              await this.props.htmlBook.rendition.goToPosition(\r\n                JSON.stringify({\r\n                  text: bookLocation.text,\r\n                  chapterTitle: bookLocation.chapterTitle,\r\n                  count: bookLocation.count,\r\n                  percentage: bookLocation.percentage,\r\n                  cfi: bookLocation.cfi,\r\n                })\r\n              );\r\n            }}\r\n          >\r\n            {Parser(item.excerpt)}\r\n          </li>\r\n        );\r\n      });\r\n  };\r\n  renderSearchPage = () => {\r\n    let startIndex = this.state.startIndex;\r\n    let currentIndex =\r\n      startIndex > 0 ? startIndex + 2 : this.state.currentIndex;\r\n    let pageList: any[] = [];\r\n    let total = Math.ceil(this.state.searchList.length / 10);\r\n    if (total <= 5) {\r\n      for (let i = 0; i < total; i++) {\r\n        pageList.push(\r\n          <li\r\n            className={\r\n              currentIndex === i\r\n                ? \"nav-search-page-item active-page \"\r\n                : \"nav-search-page-item\"\r\n            }\r\n            onClick={() => {\r\n              this.setState({ currentIndex: i });\r\n            }}\r\n          >\r\n            {i + 1}\r\n          </li>\r\n        );\r\n      }\r\n    } else {\r\n      for (\r\n        let i = 0;\r\n        i < (total - startIndex < 5 ? total - startIndex : 5);\r\n        i++\r\n      ) {\r\n        let isShow = currentIndex > 2 ? i === 2 : currentIndex === i;\r\n        pageList.push(\r\n          <li\r\n            className={\r\n              isShow\r\n                ? \"nav-search-page-item active-page \"\r\n                : \"nav-search-page-item\"\r\n            }\r\n            onClick={() => {\r\n              if (i === 3 && startIndex === 0) {\r\n                this.setState({\r\n                  startIndex: 1,\r\n                  currentIndex: 3,\r\n                });\r\n                return;\r\n              }\r\n              this.setState({\r\n                startIndex: currentIndex > 2 ? i + startIndex - 2 : 0,\r\n                currentIndex: i + startIndex,\r\n              });\r\n            }}\r\n          >\r\n            {i + startIndex + 1}\r\n          </li>\r\n        );\r\n      }\r\n      if (total - startIndex < 5) {\r\n        for (let i = 0; i < 6 - pageList.length; i++) {\r\n          pageList.push(<li className=\"nav-search-page-item\">EOF</li>);\r\n        }\r\n      }\r\n    }\r\n    return pageList;\r\n  };\r\n  render() {\r\n    const searchProps = {\r\n      mode: this.state.isSearch ? \"\" : \"nav\",\r\n      width: \"100px\",\r\n      height: \"35px\",\r\n      isNavSearch: this.state.isSearch,\r\n      handleSearchState: this.handleSearchState,\r\n      handleSearchList: this.handleSearchList,\r\n    };\r\n    const bookmarkProps = {\r\n      currentTab: this.state.currentTab,\r\n    };\r\n    return (\r\n      <div className=\"navigation-panel\">\r\n        {this.state.isSearch ? (\r\n          <>\r\n            <div\r\n              className=\"nav-close-icon\"\r\n              onClick={() => {\r\n                this.handleSearchState(false);\r\n                this.props.handleSearch(false);\r\n                this.setState({ searchList: null });\r\n              }}\r\n            >\r\n              <span className=\"icon-close\"></span>\r\n            </div>\r\n\r\n            <div\r\n              className=\"header-search-container\"\r\n              style={this.state.isSearch ? { left: 40 } : {}}\r\n            >\r\n              <div\r\n                className=\"navigation-search-title\"\r\n                style={{ height: \"20px\", margin: \"0px 25px 13px\" }}\r\n              >\r\n                <Trans>Search in the book</Trans>\r\n              </div>\r\n              <SearchBox {...searchProps} />\r\n            </div>\r\n            <ul className=\"nav-search-list\">\r\n              {this.state.searchList ? this.renderSearchList() : null}\r\n            </ul>\r\n            <ul className=\"nav-search-page\">\r\n              {this.state.searchList ? this.renderSearchPage() : null}\r\n            </ul>\r\n          </>\r\n        ) : (\r\n          <>\r\n            <div className=\"navigation-header\">\r\n              <Tooltip\r\n                title={this.props.t(this.state.isNavLocked ? \"Unlock\" : \"Lock\")}\r\n                position=\"bottom\"\r\n                trigger=\"mouseenter\"\r\n                style={{\r\n                  position: \"absolute\",\r\n                  top: 0,\r\n                  right: 0,\r\n                  height: \"30px\",\r\n                }}\r\n              >\r\n                <span\r\n                  className={\r\n                    this.state.isNavLocked\r\n                      ? \"icon-lock nav-lock-icon\"\r\n                      : \"icon-unlock nav-lock-icon\"\r\n                  }\r\n                  onClick={() => {\r\n                    this.handleLock();\r\n                  }}\r\n                ></span>\r\n              </Tooltip>\r\n\r\n              {this.props.currentBook.cover &&\r\n              this.props.currentBook.cover !== \"noCover\" ? (\r\n                <img\r\n                  className=\"book-cover\"\r\n                  src={this.props.currentBook.cover}\r\n                  alt=\"\"\r\n                />\r\n              ) : (\r\n                <div className=\"book-cover\">\r\n                  <EmptyCover\r\n                    {...{\r\n                      format: this.props.currentBook.format,\r\n                      title: this.props.currentBook.name,\r\n                      scale: 0.86,\r\n                    }}\r\n                  />\r\n                </div>\r\n              )}\r\n\r\n              <p className=\"book-title\">{this.props.currentBook.name}</p>\r\n              <p className=\"book-arthur\">\r\n                <Trans>Author</Trans>:{\" \"}\r\n                <Trans>\r\n                  {this.props.currentBook.author\r\n                    ? this.props.currentBook.author\r\n                    : \"Unknown Authur\"}\r\n                </Trans>\r\n              </p>\r\n              <span className=\"reading-duration\">\r\n                <Trans>Reading Time</Trans>: {Math.floor(this.props.time / 60)}\r\n                &nbsp; min\r\n              </span>\r\n              <div className=\"navigation-search-box\">\r\n                <SearchBox {...searchProps} />\r\n              </div>\r\n\r\n              <div className=\"navigation-navigation\">\r\n                <span\r\n                  className=\"book-content-title\"\r\n                  onClick={() => {\r\n                    this.handleChangeTab(\"contents\");\r\n                  }}\r\n                  style={\r\n                    this.state.currentTab === \"contents\" ? {} : { opacity: 0.5 }\r\n                  }\r\n                >\r\n                  <Trans>Content</Trans>\r\n                </span>\r\n                <span\r\n                  className=\"book-bookmark-title\"\r\n                  style={\r\n                    this.state.currentTab === \"bookmarks\"\r\n                      ? {}\r\n                      : { opacity: 0.5 }\r\n                  }\r\n                  onClick={() => {\r\n                    this.handleChangeTab(\"bookmarks\");\r\n                  }}\r\n                >\r\n                  <Trans>Bookmark</Trans>\r\n                </span>\r\n                <span\r\n                  className=\"book-bookmark-title\"\r\n                  style={\r\n                    this.state.currentTab === \"notes\" ? {} : { opacity: 0.5 }\r\n                  }\r\n                  onClick={() => {\r\n                    this.handleChangeTab(\"notes\");\r\n                  }}\r\n                >\r\n                  <Trans>Note</Trans>\r\n                </span>\r\n                <span\r\n                  className=\"book-bookmark-title\"\r\n                  style={\r\n                    this.state.currentTab === \"digests\" ? {} : { opacity: 0.5 }\r\n                  }\r\n                  onClick={() => {\r\n                    this.handleChangeTab(\"digests\");\r\n                  }}\r\n                >\r\n                  <Trans>Highlight</Trans>\r\n                </span>\r\n              </div>\r\n            </div>\r\n            <div className=\"navigation-body-parent\">\r\n              <div className=\"navigation-body\">\r\n                {this.state.currentTab === \"contents\" ? (\r\n                  <ContentList />\r\n                ) : (\r\n                  <BookNavList {...bookmarkProps} />\r\n                )}\r\n              </div>\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default NavigationPanel;\r\n","//图书导航栏\r\nimport { connect } from \"react-redux\";\r\nimport { handleFetchBookmarks, handleSearch } from \"../../../store/actions\";\r\nimport { stateType } from \"../../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport NavigationPanel from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentBook: state.book.currentBook,\r\n    bookmarks: state.reader.bookmarks,\r\n    htmlBook: state.reader.htmlBook,\r\n  };\r\n};\r\nconst actionCreator = { handleFetchBookmarks, handleSearch };\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(NavigationPanel as any));\r\n","class Bookmark {\r\n  key: string;\r\n  bookKey: string;\r\n  cfi: string;\r\n  label: string;\r\n  percentage: number;\r\n  chapter: string;\r\n  constructor(\r\n    bookKey: string,\r\n    cfi: string,\r\n    label: string,\r\n    percentage: number,\r\n    chapter: string\r\n  ) {\r\n    this.key = new Date().getTime() + \"\"; // 唯一的键\r\n    this.bookKey = bookKey; // 所属的书籍的键\r\n    this.cfi = cfi; // 标记阅读位置的cfi\r\n    this.label = label; // 此项书签的别名\r\n    this.percentage = percentage; // 此项书签的摘要\r\n    this.chapter = chapter; // 此项书签的摘要\r\n  }\r\n}\r\n\r\nexport default Bookmark;\r\n","import React from \"react\";\r\nimport \"./operationPanel.css\";\r\nimport Bookmark from \"../../../model/Bookmark\";\r\nimport { Trans } from \"react-i18next\";\r\nimport localforage from \"localforage\";\r\nimport RecordLocation from \"../../../utils/readUtils/recordLocation\";\r\nimport { OperationPanelProps, OperationPanelState } from \"./interface\";\r\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\r\nimport ReadingTime from \"../../../utils/readUtils/readingTime\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport toast from \"react-hot-toast\";\r\ndeclare var document: any;\r\n\r\nclass OperationPanel extends React.Component<\r\n  OperationPanelProps,\r\n  OperationPanelState\r\n> {\r\n  timeStamp: number;\r\n  speed: number;\r\n  timer: any;\r\n\r\n  constructor(props: OperationPanelProps) {\r\n    super(props);\r\n    this.state = {\r\n      isBookmark: false, // 是否添加书签\r\n      time: 0,\r\n      currentPercentage: RecordLocation.getHtmlLocation(\r\n        this.props.currentBook.key\r\n      )\r\n        ? RecordLocation.getHtmlLocation(this.props.currentBook.key).percentage\r\n        : 0,\r\n      timeLeft: 0,\r\n    };\r\n    this.timeStamp = Date.now();\r\n    this.speed = 30000;\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.htmlBook.rendition.on(\"page-changed\", async () => {\r\n      this.speed = Date.now() - this.timeStamp;\r\n      this.timeStamp = Date.now();\r\n      let pageProgress = await this.props.htmlBook.rendition.getProgress();\r\n      this.setState({\r\n        timeLeft:\r\n          ((pageProgress.totalPage - pageProgress.currentPage) * this.speed) /\r\n          1000,\r\n      });\r\n      this.props.handleShowBookmark(false);\r\n    });\r\n  }\r\n  // 点击切换全屏按钮触发\r\n  handleScreen() {\r\n    StorageUtil.getReaderConfig(\"isFullscreen\") !== \"yes\"\r\n      ? this.handleFullScreen()\r\n      : this.handleExitFullScreen();\r\n  }\r\n  // 点击退出按钮的处理程序\r\n  handleExit() {\r\n    StorageUtil.setReaderConfig(\"isFullscreen\", \"no\");\r\n    this.props.handleReadingState(false);\r\n    window.speechSynthesis.cancel();\r\n    ReadingTime.setTime(this.props.currentBook.key, this.props.time);\r\n    this.handleExitFullScreen();\r\n    if (this.props.htmlBook) {\r\n      this.props.handleHtmlBook(null);\r\n    }\r\n  }\r\n  //控制进入全屏\r\n  handleFullScreen() {\r\n    let de: any = document.documentElement;\r\n    if (de.requestFullscreen) {\r\n      de.requestFullscreen();\r\n    }\r\n    StorageUtil.setReaderConfig(\"isFullscreen\", \"yes\");\r\n  }\r\n  // 退出全屏模式\r\n  handleExitFullScreen() {\r\n    //解决使用esc退出全屏，再退出阅读时发生的bug\r\n    if (!document.fullscreenElement) return;\r\n\r\n    if (document.exitFullscreen) {\r\n      document.exitFullscreen();\r\n    }\r\n    StorageUtil.setReaderConfig(\"isFullscreen\", \"no\");\r\n  }\r\n  handleAddBookmark = async () => {\r\n    let bookKey = this.props.currentBook.key;\r\n    let bookLocation = RecordLocation.getHtmlLocation(bookKey);\r\n    let text = bookLocation.text;\r\n    let chapter = bookLocation.chapterTitle;\r\n    let percentage = bookLocation.percentage;\r\n\r\n    let cfi = JSON.stringify(bookLocation);\r\n    if (!text) {\r\n      text = await this.props.htmlBook.rendition.visibleText();\r\n    }\r\n    text = text\r\n      .replace(/\\s\\s/g, \"\")\r\n      .replace(/\\r/g, \"\")\r\n      .replace(/\\n/g, \"\")\r\n      .replace(/\\t/g, \"\")\r\n      .replace(/\\f/g, \"\");\r\n\r\n    let bookmark = new Bookmark(\r\n      bookKey,\r\n      cfi,\r\n      text.substr(0, 200),\r\n      percentage,\r\n      chapter\r\n    );\r\n    let bookmarkArr = this.props.bookmarks;\r\n    bookmarkArr.push(bookmark);\r\n    this.props.handleBookmarks(bookmarkArr);\r\n    localforage.setItem(\"bookmarks\", bookmarkArr);\r\n    this.setState({ isBookmark: true });\r\n    toast.success(this.props.t(\"Add Successfully\"));\r\n    this.props.handleShowBookmark(true);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"book-operation-panel\">\r\n        <div className=\"book-opeartion-info\">\r\n          <span>\r\n            <Trans\r\n              i18nKey=\"Current Reading Time\"\r\n              count={Math.floor(Math.abs(Math.floor(this.props.time / 60)))}\r\n            >\r\n              Current Reading Time:\r\n              {{\r\n                count: Math.abs(Math.floor(this.props.time / 60)),\r\n              }}\r\n              min\r\n            </Trans>\r\n          </span>\r\n          &nbsp;&nbsp;&nbsp;\r\n          <span>\r\n            <Trans\r\n              i18nKey=\"Finish Reading Time\"\r\n              count={Math.ceil(this.state.timeLeft / 60)}\r\n            >\r\n              Finish Reading Time:\r\n              {{\r\n                count: `${Math.ceil(this.state.timeLeft / 60)}`,\r\n              }}\r\n              min\r\n            </Trans>\r\n          </span>\r\n        </div>\r\n        <div\r\n          className=\"exit-reading-button\"\r\n          onClick={() => {\r\n            this.handleExit();\r\n\r\n            if (StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\") {\r\n              this.props.history.push(\"/manager/home\");\r\n              document.title = \"Koodo Reader\";\r\n            } else {\r\n              window.close();\r\n            }\r\n          }}\r\n        >\r\n          <span className=\"icon-exit exit-reading-icon\"></span>\r\n          <span className=\"exit-reading-text\">\r\n            <Trans>Exit</Trans>\r\n          </span>\r\n        </div>\r\n        <div\r\n          className=\"add-bookmark-button\"\r\n          onClick={() => {\r\n            this.handleAddBookmark();\r\n          }}\r\n        >\r\n          <span className=\"icon-add add-bookmark-icon\"></span>\r\n          <span className=\"add-bookmark-text\">\r\n            <Trans>Add Bookmark</Trans>\r\n          </span>\r\n        </div>\r\n        <div\r\n          className=\"enter-fullscreen-button\"\r\n          onClick={() => {\r\n            this.handleScreen();\r\n          }}\r\n        >\r\n          <span className=\"icon-fullscreen enter-fullscreen-icon\"></span>\r\n          {StorageUtil.getReaderConfig(\"isFullscreen\") !== \"yes\" ? (\r\n            <span className=\"enter-fullscreen-text\">\r\n              <Trans>Enter Fullscreen</Trans>\r\n            </span>\r\n          ) : (\r\n            <span className=\"enter-fullscreen-text\">\r\n              <Trans>Exit Fullscreen</Trans>\r\n            </span>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(OperationPanel);\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleBookmarks,\r\n  handleFetchBookmarks,\r\n  handleOpenMenu,\r\n  handleShowBookmark,\r\n  handleSearch,\r\n  handleReadingState,\r\n  handleHtmlBook,\r\n  handleReadingBook,\r\n} from \"../../../store/actions\";\r\nimport { stateType } from \"../../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport OperationPanel from \"./component\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentBook: state.book.currentBook,\r\n    bookmarks: state.reader.bookmarks,\r\n    notes: state.reader.notes,\r\n    books: state.manager.books,\r\n    htmlBook: state.reader.htmlBook,\r\n    locations: state.progressPanel.locations,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleBookmarks,\r\n  handleReadingState,\r\n  handleFetchBookmarks,\r\n  handleOpenMenu,\r\n  handleShowBookmark,\r\n  handleSearch,\r\n  handleHtmlBook,\r\n  handleReadingBook,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(OperationPanel as any));\r\n","import React from \"react\";\r\nimport \"./progressPanel.css\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { ProgressPanelProps, ProgressPanelState } from \"./interface\";\r\nimport { Tooltip } from \"react-tippy\";\r\nimport _ from \"underscore\";\r\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\r\n\r\nclass ProgressPanel extends React.Component<\r\n  ProgressPanelProps,\r\n  ProgressPanelState\r\n> {\r\n  constructor(props: ProgressPanelProps) {\r\n    super(props);\r\n    this.state = {\r\n      displayPercentage: this.props.percentage ? this.props.percentage : 0,\r\n      currentChapter: this.props.currentChapter,\r\n      currentChapterIndex: 0,\r\n      currentPage: 0,\r\n      totalPage: 0,\r\n    };\r\n  }\r\n\r\n  async UNSAFE_componentWillReceiveProps(nextProps: ProgressPanelProps) {\r\n    if (nextProps.currentChapter && nextProps.htmlBook) {\r\n      let pageProgress = await nextProps.htmlBook.rendition.getProgress();\r\n      this.setState({\r\n        currentPage: pageProgress.currentPage,\r\n        totalPage: pageProgress.totalPage,\r\n        currentChapter: nextProps.currentChapter,\r\n        currentChapterIndex:\r\n          _.findIndex(\r\n            nextProps.htmlBook.flattenChapters.map((item) => {\r\n              item.label = item.label.trim();\r\n              return item;\r\n            }),\r\n            {\r\n              label: nextProps.currentChapter.trim(),\r\n            }\r\n          ) > -1\r\n            ? _.findIndex(\r\n                nextProps.htmlBook.flattenChapters.map((item) => {\r\n                  item.label = item.label.trim();\r\n                  return item;\r\n                }),\r\n                {\r\n                  label: nextProps.currentChapter.trim(),\r\n                }\r\n              )\r\n            : 0,\r\n        displayPercentage:\r\n          _.findIndex(\r\n            nextProps.htmlBook.flattenChapters.map((item) => {\r\n              item.label = item.label.trim();\r\n              return item;\r\n            }),\r\n            {\r\n              label: nextProps.currentChapter.trim(),\r\n            }\r\n          ) /\r\n          nextProps.htmlBook.flattenChapters.map((item) => {\r\n            item.label = item.label.trim();\r\n            return item;\r\n          }).length,\r\n      });\r\n    }\r\n    if (nextProps.percentage) {\r\n      this.setState({ displayPercentage: nextProps.percentage });\r\n    }\r\n  }\r\n\r\n  onProgressChange = (event: any) => {\r\n    const percentage = event.target.value / 100;\r\n    if (this.props.htmlBook.flattenChapters.length > 0) {\r\n      this.props.htmlBook.rendition.goToChapter(\r\n        this.props.htmlBook.flattenChapters[\r\n          Math.floor(this.props.htmlBook.flattenChapters.length * percentage)\r\n        ].label\r\n      );\r\n    }\r\n  };\r\n  //使进度百分比随拖动实时变化\r\n  onProgressInput = (event: any) => {\r\n    this.setState({ displayPercentage: event.target.value / 100 });\r\n  };\r\n  nextChapter = () => {\r\n    if (this.props.htmlBook.flattenChapters.length > 0) {\r\n      this.props.htmlBook.rendition.goToChapter(\r\n        this.props.htmlBook.flattenChapters[\r\n          _.findIndex(\r\n            this.props.htmlBook.flattenChapters.map((item) => {\r\n              item.label = item.label.trim();\r\n              return item;\r\n            }),\r\n            {\r\n              label: this.props.currentChapter.trim(),\r\n            }\r\n          ) <\r\n          this.props.htmlBook.flattenChapters.length - 1\r\n            ? _.findIndex(\r\n                this.props.htmlBook.flattenChapters.map((item) => {\r\n                  item.label = item.label.trim();\r\n                  return item;\r\n                }),\r\n                {\r\n                  label: this.props.currentChapter.trim(),\r\n                }\r\n              ) + 1\r\n            : this.props.htmlBook.flattenChapters.length - 1\r\n        ].label\r\n      );\r\n    }\r\n  };\r\n  prevChapter = () => {\r\n    if (this.props.htmlBook.flattenChapters.length > 0) {\r\n      this.props.htmlBook.rendition.goToChapter(\r\n        this.props.htmlBook.flattenChapters[\r\n          _.findIndex(\r\n            this.props.htmlBook.flattenChapters.map((item) => {\r\n              item.label = item.label.trim();\r\n              return item;\r\n            }),\r\n            {\r\n              label: this.props.currentChapter.trim(),\r\n            }\r\n          ) > 0\r\n            ? _.findIndex(\r\n                this.props.htmlBook.flattenChapters.map((item) => {\r\n                  item.label = item.label.trim();\r\n                  return item;\r\n                }),\r\n                {\r\n                  label: this.props.currentChapter.trim(),\r\n                }\r\n              ) - 1\r\n            : 0\r\n        ].label\r\n      );\r\n    }\r\n  };\r\n  handleJumpChapter = (event: any) => {\r\n    if (this.props.htmlBook.flattenChapters.length > 0) {\r\n      this.props.htmlBook.rendition.goToChapter(\r\n        this.props.htmlBook.flattenChapters[event.target.value].label\r\n      );\r\n    }\r\n  };\r\n  render() {\r\n    if (!this.props.htmlBook) {\r\n      return <div className=\"progress-panel\">Loading</div>;\r\n    }\r\n\r\n    return (\r\n      <div className=\"progress-panel\">\r\n        <p className=\"progress-text\" style={{ marginTop: 10 }}>\r\n          <span>\r\n            <Trans>Progress</Trans>:{\" \"}\r\n            {Math.round(\r\n              this.state.displayPercentage > 1\r\n                ? 100\r\n                : this.state.displayPercentage * 100\r\n            )}\r\n            %&nbsp;&nbsp;&nbsp;\r\n          </span>\r\n        </p>\r\n        <p className=\"progress-text\" style={{ marginTop: 0 }}>\r\n          <Trans>Pages</Trans>\r\n          <input\r\n            type=\"text\"\r\n            name=\"jumpPage\"\r\n            id=\"jumpPage\"\r\n            value={\r\n              StorageUtil.getReaderConfig(\"readerMode\") !== \"double\"\r\n                ? this.state.currentPage\r\n                : this.state.currentPage * 2 - 1\r\n            }\r\n          />\r\n          <span>\r\n            /{\" \"}\r\n            {StorageUtil.getReaderConfig(\"readerMode\") !== \"double\"\r\n              ? this.state.totalPage\r\n              : this.state.totalPage * 2 - 2}\r\n          </span>\r\n          &nbsp;&nbsp;&nbsp;\r\n          <Trans>Chapters</Trans>\r\n          <input\r\n            type=\"text\"\r\n            name=\"jumpChapter\"\r\n            id=\"jumpChapter\"\r\n            onBlur={(event) => {\r\n              this.handleJumpChapter(event);\r\n            }}\r\n            defaultValue={this.state.currentChapterIndex}\r\n          />\r\n          <span>/ {this.props.htmlBook.flattenChapters.length}</span>\r\n        </p>\r\n        <div>\r\n          <input\r\n            className=\"input-progress\"\r\n            defaultValue={Math.round(this.state.displayPercentage * 100)}\r\n            type=\"range\"\r\n            max=\"100\"\r\n            min=\"0\"\r\n            step=\"1\"\r\n            onMouseUp={(event) => {\r\n              this.onProgressChange(event);\r\n            }}\r\n            onTouchEnd={(event) => {\r\n              this.onProgressChange(event);\r\n            }}\r\n            onChange={(event) => {\r\n              this.onProgressInput(event);\r\n            }}\r\n            style={{ width: 300, left: 50, top: 73 }}\r\n          />\r\n        </div>\r\n\r\n        <div\r\n          className=\"previous-chapter\"\r\n          onClick={() => {\r\n            this.prevChapter();\r\n          }}\r\n        >\r\n          <Tooltip\r\n            title={this.props.t(\"Prev Chapter\")}\r\n            position=\"top\"\r\n            trigger=\"mouseenter\"\r\n          >\r\n            <span className=\"icon-dropdown previous-chapter-icon\"> </span>\r\n          </Tooltip>\r\n        </div>\r\n\r\n        <div\r\n          className=\"next-chapter\"\r\n          onClick={() => {\r\n            this.nextChapter();\r\n          }}\r\n        >\r\n          <Tooltip\r\n            title={this.props.t(\"Next Chapter\")}\r\n            position=\"top\"\r\n            trigger=\"mouseenter\"\r\n          >\r\n            <span className=\"icon-dropdown next-chapter-icon\"></span>\r\n          </Tooltip>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ProgressPanel;\r\n","import { connect } from \"react-redux\";\r\nimport { stateType } from \"../../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport ProgressPanel from \"./component\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentBook: state.book.currentBook,\r\n    isReading: state.book.isReading,\r\n    percentage: state.progressPanel.percentage,\r\n    currentChapter: state.reader.currentChapter,\r\n    htmlBook: state.reader.htmlBook,\r\n    renderFunc: state.book.renderFunc,\r\n  };\r\n};\r\nconst actionCreator = {};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(ProgressPanel as any));\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleActionDialog,\r\n  handleReadingState,\r\n  handleReadingBook,\r\n  handleHtmlBook,\r\n  handleRenderFunc,\r\n  handleFetchBooks,\r\n  handleCurrentChapter,\r\n  handleFetchNotes,\r\n  handleFetchBookmarks,\r\n  handleFetchPercentage,\r\n} from \"../../store/actions\";\r\nimport Viewer from \"./component\";\r\nimport { stateType } from \"../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    isOpenActionDialog: state.book.isOpenActionDialog,\r\n    currentBook: state.book.currentBook,\r\n    isReading: state.book.isReading,\r\n    htmlBook: state.reader.htmlBook,\r\n    books: state.manager.books,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleReadingState,\r\n  handleReadingBook,\r\n  handleActionDialog,\r\n  handleHtmlBook,\r\n  handleRenderFunc,\r\n  handleFetchBooks,\r\n  handleCurrentChapter,\r\n  handleFetchNotes,\r\n  handleFetchBookmarks,\r\n  handleFetchPercentage,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(Viewer as any));\r\n","import React from \"react\";\r\nimport PageWidget from \"../../containers/pageWidget\";\r\nimport SettingPanel from \"../../containers/panels/settingPanel\";\r\nimport NavigationPanel from \"../../containers/panels/navigationPanel\";\r\nimport OperationPanel from \"../../containers/panels/operationPanel\";\r\nimport { Toaster } from \"react-hot-toast\";\r\nimport ProgressPanel from \"../../containers/panels/progressPanel\";\r\nimport { ReaderProps, ReaderState } from \"./interface\";\r\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\nimport ReadingTime from \"../../utils/readUtils/readingTime\";\r\nimport Viewer from \"../../containers/htmlViewer\";\r\nimport _ from \"underscore\";\r\nimport localforage from \"localforage\";\r\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\r\nimport \"./index.css\";\r\n\r\nclass Reader extends React.Component<ReaderProps, ReaderState> {\r\n  messageTimer!: NodeJS.Timeout;\r\n  tickTimer!: NodeJS.Timeout;\r\n  constructor(props: ReaderProps) {\r\n    super(props);\r\n    this.state = {\r\n      isOpenRightPanel:\r\n        StorageUtil.getReaderConfig(\"isSettingLocked\") === \"yes\" ? true : false,\r\n      isOpenTopPanel: false,\r\n      isOpenBottomPanel: false,\r\n      hoverPanel: \"\",\r\n      isOpenLeftPanel:\r\n        StorageUtil.getReaderConfig(\"isNavLocked\") === \"yes\" ? true : false,\r\n\r\n      scale: StorageUtil.getReaderConfig(\"scale\") || 1,\r\n      margin: parseInt(StorageUtil.getReaderConfig(\"margin\")) || 30,\r\n      time: ReadingTime.getTime(this.props.currentBook.key),\r\n      isTouch: StorageUtil.getReaderConfig(\"isTouch\") === \"yes\",\r\n      isPreventTrigger:\r\n        StorageUtil.getReaderConfig(\"isPreventTrigger\") === \"yes\",\r\n      readerMode: StorageUtil.getReaderConfig(\"readerMode\") || \"double\",\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    if (StorageUtil.getReaderConfig(\"isMergeWord\") === \"yes\") {\r\n      document\r\n        .querySelector(\"body\")\r\n        ?.setAttribute(\"style\", \"background-color: rgba(0,0,0,0)\");\r\n    }\r\n    this.tickTimer = setInterval(() => {\r\n      let time = this.state.time;\r\n      time += 1;\r\n      this.setState({ time });\r\n    }, 1000);\r\n  }\r\n  UNSAFE_componentWillMount() {\r\n    let url = document.location.href.split(\"/\");\r\n    let key = url[url.length - 1].split(\"?\")[0];\r\n    this.props.handleFetchBooks();\r\n    localforage.getItem(\"books\").then((result: any) => {\r\n      let book;\r\n      //兼容在主窗口打开\r\n      if (this.props.currentBook.key) {\r\n        book = this.props.currentBook;\r\n      } else {\r\n        book =\r\n          result[_.findIndex(result, { key })] ||\r\n          JSON.parse(localStorage.getItem(\"tempBook\") || \"{}\");\r\n      }\r\n      this.props.handleReadingBook(book);\r\n      this.props.handleFetchPercentage(book);\r\n    });\r\n  }\r\n  //进入阅读器\r\n  handleEnterReader = (position: string) => {\r\n    //控制上下左右的菜单的显示\r\n    switch (position) {\r\n      case \"right\":\r\n        this.setState({\r\n          isOpenRightPanel: this.state.isOpenRightPanel ? false : true,\r\n        });\r\n        break;\r\n      case \"left\":\r\n        this.setState({\r\n          isOpenLeftPanel: this.state.isOpenLeftPanel ? false : true,\r\n        });\r\n        break;\r\n      case \"top\":\r\n        this.setState({\r\n          isOpenTopPanel: this.state.isOpenTopPanel ? false : true,\r\n        });\r\n        break;\r\n      case \"bottom\":\r\n        this.setState({\r\n          isOpenBottomPanel: this.state.isOpenBottomPanel ? false : true,\r\n        });\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  };\r\n  //退出阅读器\r\n  handleLeaveReader = (position: string) => {\r\n    //控制上下左右的菜单的显示\r\n    switch (position) {\r\n      case \"right\":\r\n        if (StorageUtil.getReaderConfig(\"isSettingLocked\") === \"yes\") {\r\n          break;\r\n        } else {\r\n          this.setState({ isOpenRightPanel: false });\r\n          break;\r\n        }\r\n\r\n      case \"left\":\r\n        if (StorageUtil.getReaderConfig(\"isNavLocked\") === \"yes\") {\r\n          break;\r\n        } else {\r\n          this.setState({ isOpenLeftPanel: false });\r\n          break;\r\n        }\r\n      case \"top\":\r\n        this.setState({ isOpenTopPanel: false });\r\n        break;\r\n      case \"bottom\":\r\n        this.setState({ isOpenBottomPanel: false });\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  };\r\n  handleLocation = () => {\r\n    setTimeout(async () => {\r\n      let position = await this.props.htmlBook.rendition.getPosition();\r\n      RecordLocation.recordHtmlLocation(\r\n        this.props.currentBook.key,\r\n        position.text,\r\n        position.chapterTitle,\r\n        position.count,\r\n        position.percentage,\r\n        position.cfi\r\n      );\r\n    }, 500);\r\n  };\r\n  render() {\r\n    const renditionProps = {\r\n      handleLeaveReader: this.handleLeaveReader,\r\n      handleEnterReader: this.handleEnterReader,\r\n      isShow:\r\n        this.state.isOpenLeftPanel ||\r\n        this.state.isOpenTopPanel ||\r\n        this.state.isOpenBottomPanel ||\r\n        this.state.isOpenRightPanel,\r\n    };\r\n    return (\r\n      <div className=\"viewer\">\r\n        {StorageUtil.getReaderConfig(\"isHidePageButton\") !== \"yes\" && (\r\n          <>\r\n            <div\r\n              className=\"previous-chapter-single-container\"\r\n              onClick={async () => {\r\n                this.props.htmlBook.rendition.prev();\r\n                this.handleLocation();\r\n              }}\r\n            >\r\n              <span className=\"icon-dropdown previous-chapter-single\"></span>\r\n            </div>\r\n            <div\r\n              className=\"next-chapter-single-container\"\r\n              onClick={async () => {\r\n                this.props.htmlBook.rendition.next();\r\n                this.handleLocation();\r\n              }}\r\n            >\r\n              <span className=\"icon-dropdown next-chapter-single\"></span>\r\n            </div>\r\n          </>\r\n        )}\r\n        {StorageUtil.getReaderConfig(\"isHideMenuButton\") !== \"yes\" && (\r\n          <div\r\n            className=\"reader-setting-icon-container\"\r\n            onClick={() => {\r\n              this.handleEnterReader(\"left\");\r\n              this.handleEnterReader(\"right\");\r\n              this.handleEnterReader(\"bottom\");\r\n              this.handleEnterReader(\"top\");\r\n            }}\r\n          >\r\n            <span className=\"icon-grid reader-setting-icon\"></span>\r\n          </div>\r\n        )}\r\n        <Toaster />\r\n\r\n        <div\r\n          className=\"left-panel\"\r\n          onMouseEnter={() => {\r\n            if (\r\n              this.state.isTouch ||\r\n              this.state.isOpenLeftPanel ||\r\n              this.state.isPreventTrigger\r\n            ) {\r\n              this.setState({ hoverPanel: \"left\" });\r\n              return;\r\n            }\r\n            this.handleEnterReader(\"left\");\r\n          }}\r\n          onMouseLeave={() => {\r\n            this.setState({ hoverPanel: \"\" });\r\n          }}\r\n          style={this.state.hoverPanel === \"left\" ? { opacity: 0.5 } : {}}\r\n          onClick={() => {\r\n            this.handleEnterReader(\"left\");\r\n          }}\r\n        >\r\n          <span className=\"icon-grid panel-icon\"></span>\r\n        </div>\r\n        <div\r\n          className=\"right-panel\"\r\n          onMouseEnter={() => {\r\n            if (\r\n              this.state.isTouch ||\r\n              this.state.isOpenRightPanel ||\r\n              this.state.isPreventTrigger\r\n            ) {\r\n              this.setState({ hoverPanel: \"right\" });\r\n              return;\r\n            }\r\n            this.handleEnterReader(\"right\");\r\n          }}\r\n          onMouseLeave={() => {\r\n            this.setState({ hoverPanel: \"\" });\r\n          }}\r\n          style={this.state.hoverPanel === \"right\" ? { opacity: 0.5 } : {}}\r\n          onClick={() => {\r\n            this.handleEnterReader(\"right\");\r\n          }}\r\n        >\r\n          <span className=\"icon-grid panel-icon\"></span>\r\n        </div>\r\n        <div\r\n          className=\"top-panel\"\r\n          onMouseEnter={() => {\r\n            if (\r\n              this.state.isTouch ||\r\n              this.state.isOpenTopPanel ||\r\n              this.state.isPreventTrigger\r\n            ) {\r\n              this.setState({ hoverPanel: \"top\" });\r\n              return;\r\n            }\r\n            this.handleEnterReader(\"top\");\r\n          }}\r\n          style={this.state.hoverPanel === \"top\" ? { opacity: 0.5 } : {}}\r\n          onMouseLeave={() => {\r\n            this.setState({ hoverPanel: \"\" });\r\n          }}\r\n          onClick={() => {\r\n            this.handleEnterReader(\"top\");\r\n          }}\r\n        >\r\n          <span className=\"icon-grid panel-icon\"></span>\r\n        </div>\r\n        <div\r\n          className=\"bottom-panel\"\r\n          onMouseEnter={() => {\r\n            if (\r\n              this.state.isTouch ||\r\n              this.state.isOpenBottomPanel ||\r\n              this.state.isPreventTrigger\r\n            ) {\r\n              this.setState({ hoverPanel: \"bottom\" });\r\n              return;\r\n            }\r\n            this.handleEnterReader(\"bottom\");\r\n          }}\r\n          style={this.state.hoverPanel === \"bottom\" ? { opacity: 0.5 } : {}}\r\n          onMouseLeave={() => {\r\n            this.setState({ hoverPanel: \"\" });\r\n          }}\r\n          onClick={() => {\r\n            this.handleEnterReader(\"bottom\");\r\n          }}\r\n        >\r\n          <span className=\"icon-grid panel-icon\"></span>\r\n        </div>\r\n        {this.props.currentBook.key && <Viewer {...renditionProps} />}\r\n        <div\r\n          className=\"setting-panel-container\"\r\n          onMouseLeave={(event) => {\r\n            this.handleLeaveReader(\"right\");\r\n          }}\r\n          style={\r\n            this.state.isOpenRightPanel\r\n              ? {}\r\n              : {\r\n                  transform: \"translateX(309px)\",\r\n                }\r\n          }\r\n        >\r\n          <SettingPanel />\r\n        </div>\r\n        <div\r\n          className=\"navigation-panel-container\"\r\n          onMouseLeave={(event) => {\r\n            this.handleLeaveReader(\"left\");\r\n          }}\r\n          style={\r\n            this.state.isOpenLeftPanel\r\n              ? {}\r\n              : {\r\n                  transform: \"translateX(-309px)\",\r\n                }\r\n          }\r\n        >\r\n          <NavigationPanel {...{ time: this.state.time }} />\r\n        </div>\r\n        <div\r\n          className=\"progress-panel-container\"\r\n          onMouseLeave={(event) => {\r\n            this.handleLeaveReader(\"bottom\");\r\n          }}\r\n          style={\r\n            this.state.isOpenBottomPanel\r\n              ? {}\r\n              : {\r\n                  transform: \"translateY(110px)\",\r\n                }\r\n          }\r\n        >\r\n          <ProgressPanel {...{ time: this.state.time }} />\r\n        </div>\r\n        <div\r\n          className=\"operation-panel-container\"\r\n          onMouseLeave={(event) => {\r\n            this.handleLeaveReader(\"top\");\r\n          }}\r\n          style={\r\n            this.state.isOpenTopPanel\r\n              ? {}\r\n              : {\r\n                  transform: \"translateY(-110px)\",\r\n                }\r\n          }\r\n        >\r\n          {this.props.htmlBook && (\r\n            <OperationPanel {...{ time: this.state.time }} />\r\n          )}\r\n        </div>\r\n        <PageWidget {...{ time: this.state.time }} />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Reader;\r\n","import {\r\n  handleFetchNotes,\r\n  handleFetchBookmarks,\r\n  handleFetchBooks,\r\n  handleReadingBook,\r\n  handleFetchPercentage,\r\n} from \"../../store/actions\";\r\nimport { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport Reader from \"./component\";\r\nimport { withTranslation } from \"react-i18next\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    currentBook: state.book.currentBook,\r\n    percentage: state.progressPanel.percentage,\r\n    htmlBook: state.reader.htmlBook,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleFetchNotes,\r\n  handleFetchBookmarks,\r\n  handleFetchBooks,\r\n  handleReadingBook,\r\n  handleFetchPercentage,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(Reader));\r\n","import React from \"react\";\r\nimport \"./style.css\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport { stateType } from \"../../store\";\r\nimport { connect } from \"react-redux\";\r\nimport { handleReadingState } from \"../../store/actions\";\r\nimport { isElectron } from \"react-device-detect\";\r\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\n\r\nconst BackToMain = (props: any) => {\r\n  return (\r\n    <div\r\n      className=\"back-main-container\"\r\n      onClick={() => {\r\n        if (\r\n          isElectron &&\r\n          StorageUtil.getReaderConfig(\"isOpenInMain\") !== \"yes\"\r\n        ) {\r\n          if (\r\n            window\r\n              .require(\"electron\")\r\n              .ipcRenderer.sendSync(\"check-main-open\", \"ping\")\r\n          ) {\r\n            window\r\n              .require(\"electron\")\r\n              .ipcRenderer.invoke(\"focus-on-main\", \"ping\");\r\n            window.close();\r\n          } else {\r\n            window\r\n              .require(\"electron\")\r\n              .ipcRenderer.invoke(\"create-new-main\", \"ping\");\r\n            window.close();\r\n          }\r\n        } else {\r\n          props.history.push(\"/manager/home\");\r\n          document.title = \"Koodo Reader\";\r\n          props.handleReadingState(false);\r\n        }\r\n      }}\r\n      style={document.URL.indexOf(\"djvu\") > -1 ? { bottom: \"60px\" } : {}}\r\n    >\r\n      <span className=\"icon-home back-home\"></span>\r\n    </div>\r\n  );\r\n};\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {};\r\n};\r\nconst actionCreator = { handleReadingState };\r\nexport default connect(mapStateToProps, actionCreator)(withRouter(BackToMain));\r\n","import React from \"react\";\r\nimport RecentBooks from \"../../utils/readUtils/recordRecent\";\r\nimport { ViewerProps, ViewerState } from \"./interface\";\r\nimport localforage from \"localforage\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport _ from \"underscore\";\r\nimport BookUtil from \"../../utils/fileUtils/bookUtil\";\r\nimport { toast } from \"react-hot-toast\";\r\nimport BackToMain from \"../../components/backToMain\";\r\nimport { djvuMouseEvent } from \"../../utils/serviceUtils/mouseEvent\";\r\n\r\ndeclare var window: any;\r\n\r\nclass Viewer extends React.Component<ViewerProps, ViewerState> {\r\n  constructor(props: ViewerProps) {\r\n    super(props);\r\n    this.state = {};\r\n  }\r\n\r\n  componentDidMount() {\r\n    let url = document.location.href.split(\"/\");\r\n    let key = url[url.length - 1].split(\"?\")[0];\r\n\r\n    localforage.getItem(\"books\").then((result: any) => {\r\n      let book;\r\n      //兼容在主窗口打开\r\n      if (this.props.currentBook.key) {\r\n        book = this.props.currentBook;\r\n      } else {\r\n        book =\r\n          result[_.findIndex(result, { key })] ||\r\n          JSON.parse(localStorage.getItem(\"tempBook\") || \"{}\");\r\n      }\r\n      BookUtil.fetchBook(key, true, book.path).then((result) => {\r\n        if (!result) {\r\n          toast.error(this.props.t(\"Book not exsits\"));\r\n          return;\r\n        }\r\n        this.props.handleReadingBook(book);\r\n        this.handleDjvu(result as ArrayBuffer);\r\n        this.props.handleReadingState(true);\r\n        RecentBooks.setRecent(key);\r\n        document.title = book.name + \" - Koodo Reader\";\r\n      });\r\n    });\r\n    document\r\n      .querySelector(\".ebook-viewer\")\r\n      ?.setAttribute(\"style\", \"height:100vh\");\r\n  }\r\n\r\n  handleDjvu = async (result: ArrayBuffer) => {\r\n    setTimeout(() => {\r\n      var ViewerInstance = new window.DjVu.Viewer();\r\n      ViewerInstance.render(document.querySelector(\".ebook-viewer\"));\r\n      ViewerInstance.loadDocument(result);\r\n      djvuMouseEvent();\r\n    }, 100);\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <div className=\"ebook-viewer\" id=\"page-area\">\r\n          Loading\r\n        </div>\r\n        <BackToMain />\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default withRouter(Viewer as any);\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleActionDialog,\r\n  handleReadingState,\r\n  handleReadingBook,\r\n} from \"../../store/actions\";\r\nimport Viewer from \"./component\";\r\nimport { stateType } from \"../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    isOpenActionDialog: state.book.isOpenActionDialog,\r\n    currentBook: state.book.currentBook,\r\n    isReading: state.book.isReading,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleReadingState,\r\n  handleReadingBook,\r\n  handleActionDialog,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(Viewer as any));\r\n","import React from \"react\";\r\nimport RecentBooks from \"../../utils/readUtils/recordRecent\";\r\nimport { ViewerProps, ViewerState } from \"./interface\";\r\nimport localforage from \"localforage\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport _ from \"underscore\";\r\nimport BookUtil from \"../../utils/fileUtils/bookUtil\";\r\nimport BackToMain from \"../../components/backToMain\";\r\nimport PopupMenu from \"../../components/popups/popupMenu\";\r\nimport { Toaster } from \"react-hot-toast\";\r\nimport { handleLinkJump } from \"../../utils/readUtils/linkUtil\";\r\nimport { pdfMouseEvent } from \"../../utils/serviceUtils/mouseEvent\";\r\nclass Viewer extends React.Component<ViewerProps, ViewerState> {\r\n  constructor(props: ViewerProps) {\r\n    super(props);\r\n    this.state = {\r\n      href: \"\",\r\n      title: \"\",\r\n      cfiRange: null,\r\n      contents: null,\r\n      rect: null,\r\n      pageWidth: 0,\r\n      pageHeight: 0,\r\n      loading: true,\r\n    };\r\n  }\r\n  UNSAFE_componentWillMount() {\r\n    this.props.handleFetchBookmarks();\r\n    this.props.handleFetchNotes();\r\n    this.props.handleFetchBooks();\r\n  }\r\n  componentDidMount() {\r\n    let url = document.location.href.split(\"/\");\r\n    let key = url[url.length - 1].split(\"?\")[0];\r\n    localforage.getItem(\"books\").then((result: any) => {\r\n      let book;\r\n      if (this.props.currentBook.key) {\r\n        book = this.props.currentBook;\r\n      } else {\r\n        book =\r\n          result[_.findIndex(result, { key })] ||\r\n          JSON.parse(localStorage.getItem(\"tempBook\") || \"{}\");\r\n      }\r\n\r\n      document.title = book.name + \" - Koodo Reader\";\r\n      this.props.handleReadingState(true);\r\n      RecentBooks.setRecent(key);\r\n      this.props.handleReadingBook(book);\r\n      this.setState({ title: book.name + \" - Koodo Reader\" });\r\n      this.setState({ href: BookUtil.getPDFUrl(book) });\r\n    });\r\n    document\r\n      .querySelector(\".ebook-viewer\")\r\n      ?.setAttribute(\"style\", \"height:100%\");\r\n    let pageArea = document.getElementById(\"page-area\");\r\n    if (!pageArea) return;\r\n    let iframe = pageArea.getElementsByTagName(\"iframe\")[0];\r\n    if (!iframe) return;\r\n    iframe.onload = () => {\r\n      let doc: any =\r\n        iframe.contentWindow || iframe.contentDocument?.defaultView;\r\n      this.setState({ loading: false });\r\n      pdfMouseEvent();\r\n      doc.document.addEventListener(\"click\", (event: any) => {\r\n        event.preventDefault();\r\n        handleLinkJump(event);\r\n      });\r\n\r\n      doc.document.addEventListener(\"mouseup\", () => {\r\n        if (!doc!.getSelection()) return;\r\n        var rect = doc!.getSelection()!.getRangeAt(0).getBoundingClientRect();\r\n        this.setState({\r\n          rect,\r\n          pageWidth: doc.document.body.scrollWidth,\r\n          pageHeight: doc.document.body.scrollHeight,\r\n        });\r\n        // iWin.getSelection() && showHighlight(getHightlightCoords());\r\n      });\r\n    };\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"ebook-viewer\" id=\"page-area\">\r\n        {!this.state.loading && (\r\n          <PopupMenu\r\n            {...{\r\n              rendition: {\r\n                on: (status: string, callback: any) => {\r\n                  callback();\r\n                },\r\n              },\r\n              rect: this.state.rect,\r\n              pageWidth: this.state.pageWidth,\r\n              pageHeight: this.state.pageHeight,\r\n              chapterIndex: 0,\r\n              chapter: \"0\",\r\n            }}\r\n          />\r\n        )}\r\n        <iframe\r\n          src={this.state.href}\r\n          title={this.state.title}\r\n          width=\"100%\"\r\n          height=\"100%\"\r\n        >\r\n          Loading\r\n        </iframe>\r\n        <BackToMain /> <Toaster />\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default withRouter(Viewer as any);\r\n","import { connect } from \"react-redux\";\r\nimport {\r\n  handleActionDialog,\r\n  handleReadingState,\r\n  handleReadingBook,\r\n  handleFetchNotes,\r\n  handleFetchBookmarks,\r\n  handleFetchBooks,\r\n} from \"../../store/actions\";\r\nimport Viewer from \"./component\";\r\nimport { stateType } from \"../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\n\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    isOpenActionDialog: state.book.isOpenActionDialog,\r\n    currentBook: state.book.currentBook,\r\n    isReading: state.book.isReading,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleReadingState,\r\n  handleReadingBook,\r\n  handleActionDialog,\r\n  handleFetchNotes,\r\n  handleFetchBookmarks,\r\n  handleFetchBooks,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(Viewer as any));\r\n","import React from \"react\";\r\nimport \"./manager.css\";\r\nimport { RedirectProps, RedirectState } from \"./interface\";\r\nimport { Trans } from \"react-i18next\";\r\nimport { getParamsFromUrl } from \"../../utils/syncUtils/common\";\r\nimport copy from \"copy-text-to-clipboard\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\r\nimport Lottie from \"react-lottie\";\r\nimport animationSuccess from \"../../assets/lotties/success.json\";\r\nimport toast, { Toaster } from \"react-hot-toast\";\r\nconst successOptions = {\r\n  loop: false,\r\n  autoplay: true,\r\n  animationData: animationSuccess,\r\n  rendererSettings: {\r\n    preserveAspectRatio: \"xMidYMid slice\",\r\n  },\r\n};\r\n\r\nclass Redirect extends React.Component<RedirectProps, RedirectState> {\r\n  timer!: NodeJS.Timeout;\r\n  constructor(props: RedirectProps) {\r\n    super(props);\r\n    this.state = {\r\n      isAuthed: false,\r\n      isError: false,\r\n      isCopied: false,\r\n      token: \"\",\r\n    };\r\n  }\r\n  handleFinish = () => {\r\n    this.props.handleLoadingDialog(false);\r\n    alert(\"数据恢复成功\");\r\n  };\r\n  showMessage = (message: string) => {\r\n    toast(this.props.t(message));\r\n  };\r\n  componentDidMount() {\r\n    //判断是否是获取token后的回调页面\r\n    let url = document.location.href;\r\n    if (document.location.hash === \"#/\") {\r\n      this.props.history.push(\"/manager/home\");\r\n    }\r\n    if (url.indexOf(\"error\") > -1) {\r\n      this.setState({ isError: true });\r\n      return false;\r\n    }\r\n    if (url.indexOf(\"code\") > -1) {\r\n      let params: any = getParamsFromUrl();\r\n      this.setState({ token: params.code });\r\n      this.setState({ isAuthed: true });\r\n      return false;\r\n    }\r\n    if (url.indexOf(\"access_token\") > -1) {\r\n      let params: any = getParamsFromUrl();\r\n      this.setState({ token: params.access_token });\r\n      this.setState({ isAuthed: true });\r\n      return false;\r\n    }\r\n  }\r\n\r\n  render() {\r\n    if (this.state.isError || this.state.isAuthed) {\r\n      return (\r\n        <div className=\"backup-page-finish-container\">\r\n          <div className=\"backup-page-finish\">\r\n            {this.state.isAuthed ? (\r\n              <Lottie options={successOptions} height={80} width={80} />\r\n            ) : (\r\n              <span className=\"icon-close auth-page-close-icon\"></span>\r\n            )}\r\n\r\n            <div className=\"backup-page-finish-text\">\r\n              <Trans>\r\n                {this.state.isAuthed\r\n                  ? \"Authorize Successfully\"\r\n                  : \"Authorize Failed\"}\r\n              </Trans>\r\n            </div>\r\n            {this.state.isAuthed ? (\r\n              <div\r\n                className=\"token-dialog-token-text\"\r\n                onClick={() => {\r\n                  copy(this.state.token);\r\n                  this.setState({ isCopied: true });\r\n                }}\r\n              >\r\n                {this.state.isCopied ? (\r\n                  <Trans>Copied</Trans>\r\n                ) : (\r\n                  <Trans>Copy Token</Trans>\r\n                )}\r\n              </div>\r\n            ) : null}\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"manager\">\r\n        <div className=\"empty-page-info-container\" style={{ margin: 100 }}>\r\n          <div className=\"empty-page-info-main\">\r\n            <Trans>It seems like you're lost</Trans>\r\n          </div>\r\n          <div\r\n            className=\"empty-page-info-sub\"\r\n            onClick={() => {\r\n              this.props.history.push(\"/manager/home\");\r\n            }}\r\n            style={{ marginTop: 10, cursor: \"pointer\" }}\r\n          >\r\n            <Trans>Return to home</Trans>\r\n          </div>\r\n        </div>\r\n        <img\r\n          src={\r\n            StorageUtil.getReaderConfig(\"appSkin\") === \"night\" ||\r\n            (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\r\n              StorageUtil.getReaderConfig(\"isOSNight\") === \"yes\")\r\n              ? \"./assets/empty_light.svg\"\r\n              : \"./assets/empty.svg\"\r\n          }\r\n          alt=\"\"\r\n          className=\"empty-page-illustration\"\r\n        />\r\n        <Toaster />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(Redirect);\r\n","import { connect } from \"react-redux\";\r\nimport \"./manager.css\";\r\nimport { stateType } from \"../../store\";\r\nimport { handleLoadingDialog } from \"../../store/actions\";\r\nimport Redirect from \"./component\";\r\nimport { withTranslation } from \"react-i18next\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {};\r\n};\r\nconst actionCreator = { handleLoadingDialog };\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(Redirect));\r\n","import React, { useEffect } from \"react\";\r\nimport { Route, Switch, HashRouter } from \"react-router-dom\";\r\nimport Manager from \"../pages/manager\";\r\nimport HtmlReader from \"../pages/htmlReader\";\r\nimport DjvuReader from \"../pages/djvuReader\";\r\nimport PDFReader from \"../pages/pdfReader\";\r\nimport _Redirect from \"../pages/redirect\";\r\nimport i18n from \"../i18n\";\r\nimport StorageUtil from \"../utils/serviceUtils/storageUtil\";\r\n\r\nconst Router = () => {\r\n  useEffect(() => {\r\n    const lng = StorageUtil.getReaderConfig(\"lang\");\r\n    if (lng) {\r\n      i18n.changeLanguage(lng);\r\n    } else {\r\n      if (navigator.language === \"zh-CN\" || navigator.language === \"zh-SG\") {\r\n        i18n.changeLanguage(\"zh\");\r\n      } else if (\r\n        navigator.language === \"zh-TW\" ||\r\n        navigator.language === \"zh-HK\"\r\n      ) {\r\n        i18n.changeLanguage(\"cht\");\r\n      } else if (navigator.language.startsWith(\"ru\")) {\r\n        i18n.changeLanguage(\"ru\");\r\n      } else if (navigator.language.startsWith(\"jp\")) {\r\n        i18n.changeLanguage(\"jp\");\r\n      } else if (navigator.language.startsWith(\"fr\")) {\r\n        i18n.changeLanguage(\"fr\");\r\n      } else if (navigator.language.startsWith(\"es\")) {\r\n        i18n.changeLanguage(\"es\");\r\n      } else if (navigator.language.startsWith(\"pt\")) {\r\n        i18n.changeLanguage(\"ptBR\");\r\n      } else if (navigator.language.startsWith(\"fa\")) {\r\n        i18n.changeLanguage(\"fa\");\r\n      } else {\r\n        i18n.changeLanguage(\"en\");\r\n      }\r\n    }\r\n  }, []);\r\n  return (\r\n    <HashRouter>\r\n      <Switch>\r\n        <Route component={Manager} path=\"/manager\" />\r\n        <Route component={DjvuReader} path=\"/djvu\" />\r\n        <Route component={HtmlReader} path=\"/epub\" />\r\n        <Route component={HtmlReader} path=\"/mobi\" />\r\n        <Route component={HtmlReader} path=\"/cbr\" />\r\n        <Route component={HtmlReader} path=\"/cbt\" />\r\n        <Route component={HtmlReader} path=\"/cbz\" />\r\n        <Route component={HtmlReader} path=\"/azw3\" />\r\n        <Route component={HtmlReader} path=\"/txt\" />\r\n        <Route component={HtmlReader} path=\"/docx\" />\r\n        <Route component={HtmlReader} path=\"/md\" />\r\n        <Route component={HtmlReader} path=\"/rtf\" />\r\n        <Route component={HtmlReader} path=\"/fb2\" />\r\n        <Route component={HtmlReader} path=\"/html\" />\r\n        <Route component={HtmlReader} path=\"/htm\" />\r\n        <Route component={HtmlReader} path=\"/xml\" />\r\n        <Route component={HtmlReader} path=\"/xhtml\" />\r\n        <Route component={HtmlReader} path=\"/href\" />\r\n        <Route component={PDFReader} path=\"/pdf\" />\r\n        <Route component={_Redirect} path=\"/\" />\r\n      </Switch>\r\n    </HashRouter>\r\n  );\r\n};\r\n\r\nexport default Router;\r\n","import GA from \"electron-google-analytics\";\r\nimport * as pkg from \"../../../package.json\";\r\n\r\nconst isDevelopment = process.env.NODE_ENV === \"development\";\r\n\r\ninterface EvOptions {\r\n  evLabel?: any;\r\n  evValue?: any;\r\n}\r\n\r\nconst hostname = \"https://reader.960960.xyz\";\r\n\r\nclass Analytics {\r\n  private readonly ga: any;\r\n\r\n  private clientId: any;\r\n\r\n  constructor() {\r\n    this.ga = new GA(\"G-LW49EYTQWY\", { debug: isDevelopment });\r\n\r\n    this.ga.set(\"version\", (pkg as any).version);\r\n  }\r\n\r\n  public getClientId(callback: any) {\r\n    if (this.clientId) {\r\n      callback(this.clientId);\r\n    }\r\n    var macaddress = window.require(\"macaddress\");\r\n    macaddress.one((err: any, mac: string) => {\r\n      this.clientId = mac;\r\n      callback(mac);\r\n    });\r\n  }\r\n\r\n  public async pageView(url: string, title?: string) {\r\n    this.getClientId(async (clientId: any) => {\r\n      try {\r\n        await this.ga.pageview(hostname, url, title, 1, clientId);\r\n      } catch (e) {\r\n        console.error(e);\r\n      }\r\n    });\r\n  }\r\n\r\n  public async event(evCategory: string, evAction: string, options: EvOptions) {\r\n    this.getClientId(async (clientId: any) => {\r\n      try {\r\n        await this.ga.event(evCategory, evAction, {\r\n          ...options,\r\n          clientID: clientId,\r\n        });\r\n      } catch (e) {\r\n        console.error(e);\r\n      }\r\n    });\r\n  }\r\n\r\n  public async exception(exDesc: string, exFatal: any) {\r\n    this.getClientId(async (clientId: any) => {\r\n      try {\r\n        await this.ga.exception(exDesc, exFatal);\r\n      } catch (e) {\r\n        console.error(e);\r\n      }\r\n    });\r\n  }\r\n  public removeScript() {\r\n    let elem = document.getElementById(\"analytic\");\r\n    if (!elem || !elem.parentNode) return;\r\n    elem.parentNode.removeChild(elem);\r\n  }\r\n}\r\n\r\nexport default new Analytics();\r\n","import { isElectron } from \"react-device-detect\";\r\nimport StorageUtil from \"./storageUtil\";\r\n\r\nexport const initTheme = () => {\r\n  const style = document.createElement(\"link\");\r\n  style.rel = \"stylesheet\";\r\n  let isNight = false;\r\n  if (isElectron) {\r\n    const { ipcRenderer } = window.require(\"electron\");\r\n    isNight = ipcRenderer.sendSync(\"system-color\");\r\n  } else {\r\n    isNight =\r\n      window.matchMedia &&\r\n      window.matchMedia(\"(prefers-color-scheme: dark)\").matches;\r\n  }\r\n  StorageUtil.setReaderConfig(\"isOSNight\", isNight ? \"yes\" : \"no\");\r\n  if (\r\n    StorageUtil.getReaderConfig(\"appSkin\") === \"night\" ||\r\n    (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\r\n      StorageUtil.getReaderConfig(\"isOSNight\") === \"yes\")\r\n  ) {\r\n    style.href = \"./assets/styles/dark.css\";\r\n  } else {\r\n    style.href = \"./assets/styles/default.css\";\r\n  }\r\n  document.head.appendChild(style);\r\n};\r\nexport const initSystemFont = () => {\r\n  if (StorageUtil.getReaderConfig(\"systemFont\")) {\r\n    let body = document.getElementsByTagName(\"body\")[0];\r\n    body.setAttribute(\r\n      \"style\",\r\n      \"font-family:\" + StorageUtil.getReaderConfig(\"systemFont\") + \"!important\"\r\n    );\r\n  }\r\n};\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./assets/styles/reset.css\";\r\nimport \"./assets/styles/global.css\";\r\nimport \"./assets/styles/style.css\";\r\nimport \"react-tippy/dist/tippy.css\";\r\nimport { Provider } from \"react-redux\";\r\nimport \"./i18n\";\r\nimport store from \"./store\";\r\nimport Router from \"./router/index\";\r\nimport StyleUtil from \"./utils/readUtils/styleUtil\";\r\nimport { isElectron } from \"react-device-detect\";\r\nimport { dropdownList } from \"./constants/dropdownList\";\r\nimport StorageUtil from \"./utils/serviceUtils/storageUtil\";\r\nimport ga from \"./utils/serviceUtils/analytics\";\r\nimport { initSystemFont, initTheme } from \"./utils/serviceUtils/launchUtil\";\r\ninitTheme();\r\ninitSystemFont();\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <Router />\r\n  </Provider>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\nif (isElectron && StorageUtil.getReaderConfig(\"isDisableAnalytics\") !== \"yes\") {\r\n  ga.event(\"Client\", \"show\", {\r\n    evLabel: \"startup\",\r\n  });\r\n} else if (StorageUtil.getReaderConfig(\"isDisableAnalytics\") === \"yes\") {\r\n  ga.removeScript();\r\n}\r\nif (isElectron) {\r\n  const fontList = window.require(\"font-list\");\r\n  fontList.getFonts({ disableQuoting: true }).then((result) => {\r\n    if (!result || result.length === 0) return;\r\n    dropdownList[0].option = result;\r\n    dropdownList[0].option.push(\"Built-in font\");\r\n  });\r\n}\r\nStyleUtil.applyTheme();\r\n","class TagUtil {\r\n  static setTags(tagName: string) {\r\n    let tagArr =\r\n      localStorage.getItem(\"noteTags\") !== \"{}\" &&\r\n      localStorage.getItem(\"noteTags\")\r\n        ? JSON.parse(localStorage.getItem(\"noteTags\") || \"\")\r\n        : [];\r\n    const index = tagArr.indexOf(tagName);\r\n    if (index > -1) {\r\n      tagArr.splice(index, 1);\r\n      tagArr.unshift(tagName);\r\n    } else {\r\n      tagArr.unshift(tagName);\r\n    }\r\n\r\n    localStorage.setItem(\"noteTags\", JSON.stringify(tagArr));\r\n  }\r\n\r\n  static clear(tagName: string) {\r\n    let tagArr =\r\n      localStorage.getItem(\"noteTags\") !== \"{}\" &&\r\n      localStorage.getItem(\"noteTags\")\r\n        ? JSON.parse(localStorage.getItem(\"noteTags\") || \"\")\r\n        : [];\r\n    const index = tagArr.indexOf(tagName);\r\n    if (index > -1) {\r\n      tagArr.splice(index, 1);\r\n    }\r\n    localStorage.setItem(\"noteTags\", JSON.stringify(tagArr));\r\n  }\r\n  static getAllTags() {\r\n    let tagArr =\r\n      localStorage.getItem(\"noteTags\") !== \"{}\" &&\r\n      localStorage.getItem(\"noteTags\")\r\n        ? JSON.parse(localStorage.getItem(\"noteTags\") || \"\")\r\n        : [];\r\n    return tagArr || [];\r\n  }\r\n}\r\n\r\nexport default TagUtil;\r\n","//笔记书摘的标签\r\nimport React from \"react\";\r\nimport \"./noteTag.css\";\r\nimport { NoteTagProps, NoteTagState } from \"./interface\";\r\nimport TagUtil from \"../../utils/readUtils/tagUtil\";\r\nimport DeleteIcon from \"../deleteIcon\";\r\nimport { Trans } from \"react-i18next\";\r\n\r\nclass NoteTag extends React.Component<NoteTagProps, NoteTagState> {\r\n  constructor(props: NoteTagProps) {\r\n    super(props);\r\n    this.state = {\r\n      tagIndex: [],\r\n      isInput: false,\r\n      deleteIndex: -1,\r\n      isShowTags: false,\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    if (this.props.isReading) {\r\n      this.setState({ tagIndex: this.tagToIndex(this.props.tag) });\r\n    }\r\n  }\r\n  UNSAFE_componentWillReceiveProps(nextProps: NoteTagProps) {\r\n    if (\r\n      this.props.isReading &&\r\n      nextProps.tag &&\r\n      nextProps.tag.length > 0 &&\r\n      this.props.tag !== nextProps.tag\r\n    ) {\r\n      this.setState({ tagIndex: this.tagToIndex(nextProps.tag) });\r\n    }\r\n  }\r\n  tagToIndex = (tag: string[]) => {\r\n    let temp: number[] = [];\r\n    if (!tag) return [];\r\n    for (let i = 0; i < TagUtil.getAllTags().length; i++) {\r\n      if (tag.indexOf(TagUtil.getAllTags()[i]) > -1) {\r\n        temp.push(i);\r\n      }\r\n    }\r\n    return temp;\r\n  };\r\n  indextoTag = (tagIndex: number[]) => {\r\n    let temp: any = [];\r\n    for (let i = 0; i < tagIndex.length; i++) {\r\n      temp.push(TagUtil.getAllTags()[tagIndex[i]]);\r\n    }\r\n    return temp;\r\n  };\r\n  handleChangeTag = (index: number) => {\r\n    let temp: number[] = [...this.state.tagIndex];\r\n    if (this.state.tagIndex.indexOf(index) > -1) {\r\n      temp = [...this.state.tagIndex];\r\n      let indexResult = temp.indexOf(index);\r\n      temp.splice(indexResult, 1);\r\n      this.setState({ tagIndex: temp });\r\n      this.props.handleTag(this.indextoTag(temp));\r\n    } else {\r\n      temp.push(index);\r\n      this.setState({ tagIndex: temp });\r\n      this.props.handleTag(this.indextoTag(temp));\r\n    }\r\n  };\r\n  handleAddTag = (event: any) => {\r\n    this.setState({ isInput: false });\r\n    if (!event.target.value) {\r\n      return;\r\n    }\r\n    TagUtil.setTags(event.target.value);\r\n    this.setState({ tagIndex: [] });\r\n    this.props.handleTag(this.indextoTag([]));\r\n  };\r\n  handleInput = () => {\r\n    this.setState({ isInput: true }, () => {\r\n      document.getElementById(\"newTag\")?.focus();\r\n    });\r\n  };\r\n  handleShowTags = (bool: boolean) => {\r\n    this.setState({ isShowTags: bool }, () => {\r\n      if (document.querySelector(\".card-list-container\")) {\r\n        (document.querySelector(\".card-list-container\") as any)?.setAttribute(\r\n          \"style\",\r\n          `height:calc(100% - ${\r\n            (document.querySelector(\".card-list-container\") as any)?.offsetTop\r\n          }px)`\r\n        );\r\n      }\r\n    });\r\n  };\r\n  render() {\r\n    const renderTag = () => {\r\n      let noteTags = this.props.isCard ? this.props.tag : TagUtil.getAllTags();\r\n      return noteTags.map((item: any, index: number) => {\r\n        return (\r\n          <li\r\n            key={item}\r\n            className={\r\n              this.state.tagIndex.indexOf(index) > -1 && !this.props.isCard\r\n                ? \"tag-list-item active-tag \"\r\n                : \"tag-list-item\"\r\n            }\r\n          >\r\n            <div className=\"delete-tag-container\">\r\n              {this.state.tagIndex.indexOf(index) > -1 &&\r\n              !this.props.isReading &&\r\n              !this.props.isCard ? (\r\n                <DeleteIcon\r\n                  {...{\r\n                    tagName: item,\r\n                    mode: \"tags\",\r\n                    index: index,\r\n                    handleChangeTag: this.handleChangeTag,\r\n                  }}\r\n                />\r\n              ) : null}\r\n            </div>\r\n            <div\r\n              className=\"center\"\r\n              onClick={() => {\r\n                this.handleChangeTag(index);\r\n              }}\r\n            >\r\n              <Trans>{item}</Trans>\r\n            </div>\r\n          </li>\r\n        );\r\n      });\r\n    };\r\n    return (\r\n      <div\r\n        className=\"note-tag-container\"\r\n        style={this.props.isReading ? { width: \"1999px\" } : {}}\r\n      >\r\n        {this.props.isReading || this.props.isCard ? null : (\r\n          <div className=\"tag-title\">\r\n            <Trans>All Tags</Trans>\r\n            <span\r\n              className=\"icon-dropdown tag-dropdown-icon\"\r\n              onClick={() => {\r\n                this.handleShowTags(!this.state.isShowTags);\r\n              }}\r\n              style={\r\n                !this.state.isShowTags ? {} : { transform: \"rotate(-90deg)\" }\r\n              }\r\n            ></span>\r\n          </div>\r\n        )}\r\n\r\n        {(this.state.isShowTags ||\r\n          this.props.isReading ||\r\n          this.props.isCard) && (\r\n          <ul className=\"tag-container\">\r\n            {!this.props.isCard && (\r\n              <li\r\n                className=\"tag-list-item-new\"\r\n                onClick={() => {\r\n                  this.handleInput();\r\n                }}\r\n                style={this.state.isInput ? { width: \"80px\" } : {}}\r\n              >\r\n                <div className=\"center\">\r\n                  {this.state.isInput ? (\r\n                    <input\r\n                      type=\"text\"\r\n                      name=\"newTag\"\r\n                      id=\"newTag\"\r\n                      onBlur={(event) => {\r\n                        this.handleAddTag(event);\r\n                      }}\r\n                    />\r\n                  ) : (\r\n                    <span className=\"icon-add\"></span>\r\n                  )}\r\n                </div>\r\n              </li>\r\n            )}\r\n            {renderTag()}\r\n          </ul>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default NoteTag;\r\n","import { connect } from \"react-redux\";\r\nimport { handleSearchResults, handleSearch } from \"../../store/actions\";\r\nimport { stateType } from \"../../store\";\r\nimport { withTranslation } from \"react-i18next\";\r\nimport NoteTag from \"./component\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    isReading: state.book.isReading,\r\n    noteKey: state.reader.noteKey,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleSearchResults,\r\n  handleSearch,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(NoteTag as any));\r\n","import { getIframeDoc } from \"../serviceUtils/docUtil\";\r\nimport StorageUtil from \"../serviceUtils/storageUtil\";\r\n\r\nclass styleUtil {\r\n  // 为 iframe 添加默认的样式\r\n  static addDefaultCss() {\r\n    let doc = getIframeDoc();\r\n    if (!doc) return;\r\n\r\n    let css = this.getDefaultCss();\r\n    let background = document.querySelector(\".viewer\");\r\n    if (!background) return;\r\n    background.setAttribute(\r\n      \"style\",\r\n      `background-color:${\r\n        StorageUtil.getReaderConfig(\"isMergeWord\") === \"yes\"\r\n          ? \"rgba(0,0,0,0)\"\r\n          : StorageUtil.getReaderConfig(\"backgroundColor\")\r\n      };filter: brightness(${\r\n        StorageUtil.getReaderConfig(\"brightness\") || 1\r\n      }) invert(${StorageUtil.getReaderConfig(\"isInvert\") === \"yes\" ? 1 : 0})`\r\n    );\r\n    if (!doc.head) {\r\n      return;\r\n    }\r\n\r\n    let style = doc.createElement(\"style\");\r\n    style.id = \"default-style\";\r\n    style.textContent = css;\r\n    doc.head.appendChild(style);\r\n  }\r\n  // 获取为文档默认应用的css样式\r\n  static getDefaultCss() {\r\n    let colors = [\"#FBF1D1\", \"#EFEEB0\", \"#CAEFC9\", \"#76BEE9\"];\r\n    let lines = [\"#FF0000\", \"#000080\", \"#0000FF\", \"#2EFF2E\"];\r\n\r\n    return `::selection{background:#f3a6a68c}::-moz-selection{background:#f3a6a68c}[class*=color-]:hover{cursor:pointer;background-image:linear-gradient(0,rgba(0,0,0,.075),rgba(0,0,0,.075))}.color-0{background-color:${colors[0]}}.color-1{background-color:${colors[1]}}.color-2{background-color:${colors[2]}}.color-3{background-color:${colors[3]}}.line-0{border-bottom:2px solid ${lines[0]}}.line-1{border-bottom:2px solid ${lines[1]}}.line-2{border-bottom:2px solid ${lines[2]}}.line-3{border-bottom:2px solid ${lines[3]}}}img{max-width:100% !important}`;\r\n  }\r\n  static getCustomCss(isJSON: boolean = true) {\r\n    if (isJSON) {\r\n      return `font-size: ${\r\n        StorageUtil.getReaderConfig(\"fontSize\") || 17\r\n      }px !important;line-height: ${\r\n        StorageUtil.getReaderConfig(\"lineHeight\") || \"1.25\"\r\n      } !important;font-family: ${\r\n        StorageUtil.getReaderConfig(\"fontFamily\") || \"\"\r\n      } !important;background-color: transparent;color: ${\r\n        StorageUtil.getReaderConfig(\"textColor\")\r\n          ? StorageUtil.getReaderConfig(\"textColor\")\r\n          : StorageUtil.getReaderConfig(\"backgroundColor\") ===\r\n              \"rgba(44,47,49,1)\" ||\r\n            StorageUtil.getReaderConfig(\"appSkin\") === \"night\" ||\r\n            (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\r\n              StorageUtil.getReaderConfig(\"isOSNight\") === \"yes\")\r\n          ? \"white\"\r\n          : \"\"\r\n      } !important;letter-spacing: ${\r\n        StorageUtil.getReaderConfig(\"letterSpacing\")\r\n          ? StorageUtil.getReaderConfig(\"letterSpacing\")\r\n          : \"\"\r\n      }px !important;text-align: ${\r\n        StorageUtil.getReaderConfig(\"textAlign\")\r\n          ? StorageUtil.getReaderConfig(\"textAlign\")\r\n          : \"\"\r\n      } !important;\r\n      font-weight: ${\r\n        StorageUtil.getReaderConfig(\"isBold\") === \"yes\" ? \"bold !important\" : \"\"\r\n      };font-style: ${\r\n        StorageUtil.getReaderConfig(\"isItalic\") === \"yes\"\r\n          ? \"italic !important\"\r\n          : \"\"\r\n      };text-shadow: ${\r\n        StorageUtil.getReaderConfig(\"isShadow\") === \"yes\"\r\n          ? \"2px 2px 2px #cccccc !important\"\r\n          : \"\"\r\n      };text-indent: ${\r\n        StorageUtil.getReaderConfig(\"isIndent\") === \"yes\" ? \"2rem\" : \"\"\r\n      };text-decoration: ${\r\n        StorageUtil.getReaderConfig(\"isUnderline\") === \"yes\"\r\n          ? \"underline !important\"\r\n          : \"\"\r\n      };margin-bottom: ${\r\n        StorageUtil.getReaderConfig(\"paraSpacing\") || 0\r\n      }px !important;padding:0px;word-wrap: break-word;`;\r\n    } else {\r\n      return {\r\n        \"a, article, cite, code, div, li, p, pre, span, table, body\": {\r\n          \"font-size\": `${\r\n            StorageUtil.getReaderConfig(\"fontSize\") || 17\r\n          }px !important`,\r\n          \"line-height\": `${\r\n            StorageUtil.getReaderConfig(\"lineHeight\") || \"1.25\"\r\n          } !important`,\r\n          \"font-family\": `${\r\n            StorageUtil.getReaderConfig(\"fontFamily\") || \"\"\r\n          } !important`,\r\n          \"background-color\": \"transparent\",\r\n          color: `${\r\n            StorageUtil.getReaderConfig(\"textColor\")\r\n              ? StorageUtil.getReaderConfig(\"textColor\")\r\n              : StorageUtil.getReaderConfig(\"backgroundColor\") ===\r\n                  \"rgba(44,47,49,1)\" ||\r\n                StorageUtil.getReaderConfig(\"appSkin\") === \"night\" ||\r\n                (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\r\n                  StorageUtil.getReaderConfig(\"isOSNight\") === \"yes\")\r\n              ? \"white\"\r\n              : \"\"\r\n          } !important`,\r\n          \"letter-spacing\": `${\r\n            StorageUtil.getReaderConfig(\"letterSpacing\")\r\n              ? `${StorageUtil.getReaderConfig(\"letterSpacing\")}px`\r\n              : \"\"\r\n          } !important`,\r\n          \"text-align\": `${\r\n            StorageUtil.getReaderConfig(\"textAlign\")\r\n              ? `${StorageUtil.getReaderConfig(\"textAlign\")}`\r\n              : \"\"\r\n          } !important`,\r\n          \"font-weight\": `${\r\n            StorageUtil.getReaderConfig(\"isBold\") === \"yes\"\r\n              ? \"bold !important\"\r\n              : \"\"\r\n          }`,\r\n          \"text-indent\": `${\r\n            StorageUtil.getReaderConfig(\"isIndent\") === \"yes\" ? \"2rem\" : \"\"\r\n          }`,\r\n          \"font-style\": `${\r\n            StorageUtil.getReaderConfig(\"isItalic\") === \"yes\"\r\n              ? \"italic !important\"\r\n              : \"\"\r\n          }`,\r\n          \"text-shadow\": `${\r\n            StorageUtil.getReaderConfig(\"isShadow\") === \"yes\"\r\n              ? \"2px 2px 2px #cccccc !important\"\r\n              : \"\"\r\n          }`,\r\n          \"text-decoration\": `${\r\n            StorageUtil.getReaderConfig(\"isUnderline\") === \"yes\"\r\n              ? \"underline !important\"\r\n              : \"\"\r\n          }`,\r\n          \"margin-bottom\": `${\r\n            StorageUtil.getReaderConfig(\"paraSpacing\") || 0\r\n          }px !important`,\r\n        },\r\n        body: {\r\n          padding: \"0px !important\",\r\n        },\r\n      };\r\n    }\r\n  }\r\n  static addStyle = (url: string) => {\r\n    const style = document.createElement(\"link\");\r\n    style.href = url;\r\n    style.rel = \"stylesheet\";\r\n    document.head.appendChild(style);\r\n  };\r\n\r\n  static applyTheme() {\r\n    StorageUtil.getReaderConfig(\"themeColor\") &&\r\n      StorageUtil.getReaderConfig(\"themeColor\") !== \"default\" &&\r\n      this.addStyle(\r\n        \"./assets/styles/\" + StorageUtil.getReaderConfig(\"themeColor\") + \".css\"\r\n      );\r\n  }\r\n}\r\n\r\nexport default styleUtil;\r\n","class ReadingTime {\r\n  static setTime(bookKey: string, time: number) {\r\n    let json = localStorage.getItem(\"readingTime\");\r\n    let obj = JSON.parse(json!) || {};\r\n    obj[bookKey] = time;\r\n    localStorage.setItem(\"readingTime\", JSON.stringify(obj));\r\n  }\r\n\r\n  static getTime(bookKey: string) {\r\n    let json = localStorage.getItem(\"readingTime\");\r\n    let obj = JSON.parse(json!) || {};\r\n    return obj[bookKey] || 0;\r\n  }\r\n  static getAllTime() {\r\n    let json = localStorage.getItem(\"readingTime\");\r\n    let obj = JSON.parse(json!) || {};\r\n    return obj || [];\r\n  }\r\n  static clearTime(bookKey: string) {\r\n    let json = localStorage.getItem(\"readingTime\");\r\n    let obj = JSON.parse(json!) || {};\r\n    delete obj[bookKey];\r\n    localStorage.setItem(\"readingTime\", JSON.stringify(obj));\r\n  }\r\n}\r\n\r\nexport default ReadingTime;\r\n","declare var window: any;\r\nvar pdfjsLib = window[\"pdfjs-dist/build/pdf\"];\r\nexport const getHightlightCoords = () => {\r\n  let pageArea = document.getElementById(\"page-area\");\r\n  if (!pageArea) return;\r\n  let iframe = pageArea.getElementsByTagName(\"iframe\")[0];\r\n  if (!iframe) return;\r\n  let iWin: any = iframe.contentWindow || iframe.contentDocument?.defaultView;\r\n  var pageIndex = iWin!.PDFViewerApplication.pdfViewer.currentPageNumber - 1;\r\n  var page = iWin!.PDFViewerApplication.pdfViewer.getPageView(pageIndex);\r\n  var pageRect = page.canvas.getClientRects()[0];\r\n  var selectionRects = iWin.getSelection()!.getRangeAt(0).getClientRects();\r\n  var viewport = page.viewport;\r\n  let tempRect: { bottom: number; top: number; left: number; right: number }[] =\r\n    [];\r\n  for (let i = 0; i < selectionRects.length; i++) {\r\n    if (i === 0) {\r\n      tempRect.push({\r\n        bottom: selectionRects[i].bottom,\r\n        top: selectionRects[i].top,\r\n        left: selectionRects[i].left,\r\n        right: selectionRects[i].right,\r\n      });\r\n    } else if (\r\n      Math.abs(\r\n        tempRect[tempRect.length - 1].bottom - selectionRects[i].bottom\r\n      ) < 5\r\n    ) {\r\n      if (tempRect[tempRect.length - 1].left > selectionRects[i].left) {\r\n        tempRect[tempRect.length - 1].left = selectionRects[i].left;\r\n      }\r\n      if (tempRect[tempRect.length - 1].right < selectionRects[i].right) {\r\n        tempRect[tempRect.length - 1].right = selectionRects[i].right;\r\n      }\r\n    } else {\r\n      tempRect.push({\r\n        bottom: selectionRects[i].bottom,\r\n        top: selectionRects[i].top,\r\n        left: selectionRects[i].left,\r\n        right: selectionRects[i].right,\r\n      });\r\n    }\r\n  }\r\n  var selected = tempRect.map(function (r: any) {\r\n    return viewport\r\n      .convertToPdfPoint(r.left - pageRect.x, r.top - pageRect.y)\r\n      .concat(\r\n        viewport.convertToPdfPoint(r.right - pageRect.x, r.bottom - pageRect.y)\r\n      );\r\n  });\r\n  return { page: pageIndex, coords: selected };\r\n};\r\nexport const getPDFCover = (file: ArrayBuffer) => {\r\n  return new Promise<string>((resolve, reject) => {\r\n    pdfjsLib\r\n      .getDocument({ data: file })\r\n      .promise.then((pdfDoc: any) => {\r\n        pdfDoc.getPage(1).then((page: any) => {\r\n          var scale = 1.5;\r\n          var viewport = page.getViewport({\r\n            scale: scale,\r\n          });\r\n          var canvas: any = document.getElementById(\"the-canvas\");\r\n          var context = canvas.getContext(\"2d\");\r\n          canvas.height =\r\n            viewport.height || viewport.viewBox[3]; /* viewport.height is NaN */\r\n          canvas.width =\r\n            viewport.width ||\r\n            viewport.viewBox[2]; /* viewport.width is also NaN */\r\n          var task = page.render({\r\n            canvasContext: context,\r\n            viewport: viewport,\r\n          });\r\n          task.promise.then(async () => {\r\n            let cover: any = canvas.toDataURL(\"image/jpeg\");\r\n\r\n            resolve(cover);\r\n          });\r\n        });\r\n      })\r\n      .catch((err: any) => {\r\n        resolve(\"\");\r\n      });\r\n  });\r\n};\r\n","import React from \"react\";\r\nimport \"./deleteIcon.css\";\r\nimport { DeleteIconProps, DeleteIconStates } from \"./interface\";\r\nimport localforage from \"localforage\";\r\nimport TagUtil from \"../../utils/readUtils/tagUtil\";\r\nimport DeletePopup from \"../dialogs/deletePopup\";\r\nimport toast from \"react-hot-toast\";\r\nclass DeleteIcon extends React.Component<DeleteIconProps, DeleteIconStates> {\r\n  constructor(props: DeleteIconProps) {\r\n    super(props);\r\n    this.state = {\r\n      deleteIndex: -1,\r\n      isOpenDelete: false,\r\n    };\r\n  }\r\n\r\n  handleDelete = () => {\r\n    let deleteItems =\r\n      this.props.mode === \"notes\"\r\n        ? this.props.notes\r\n        : this.props.mode === \"tags\"\r\n        ? TagUtil.getAllTags()\r\n        : this.props.bookmarks;\r\n    let deleteFunc =\r\n      this.props.mode === \"notes\"\r\n        ? this.props.handleFetchNotes\r\n        : this.props.handleFetchBookmarks;\r\n    deleteItems.forEach((item: any, index: number) => {\r\n      if (this.props.mode === \"tags\") {\r\n        item === this.props.tagName && TagUtil.clear(item);\r\n        return;\r\n      }\r\n      if (item.key === this.props.itemKey) {\r\n        deleteItems.splice(index, 1);\r\n        if (deleteItems.length === 0) {\r\n          localforage\r\n            .removeItem(this.props.mode)\r\n            .then(() => {\r\n              deleteFunc();\r\n              toast.success(this.props.t(\"Delete Successfully\"));\r\n            })\r\n            .catch(() => {\r\n              console.log(\"删除失败\");\r\n            });\r\n        } else {\r\n          localforage\r\n            .setItem(this.props.mode, deleteItems)\r\n            .then(() => {\r\n              deleteFunc();\r\n              toast.success(this.props.t(\"Delete Successfully\"));\r\n            })\r\n            .catch(() => {\r\n              console.log(\"修改失败\");\r\n            });\r\n        }\r\n      }\r\n    });\r\n  };\r\n  handleDeletePopup = (isOpenDelete: boolean) => {\r\n    this.setState({ isOpenDelete });\r\n    if (!isOpenDelete) {\r\n      this.props.handleChangeTag(this.props.index);\r\n    }\r\n  };\r\n  render() {\r\n    const deletePopupProps = {\r\n      name: this.props.tagName,\r\n      title: \"Delete this tag\",\r\n      description: \"This action will clear and remove this tag\",\r\n      handleDeletePopup: this.handleDeletePopup,\r\n      handleDeleteOpearion: this.handleDelete,\r\n    };\r\n    return (\r\n      <>\r\n        {this.state.isOpenDelete && <DeletePopup {...deletePopupProps} />}\r\n        <div\r\n          className=\"delete-digest-button\"\r\n          onClick={() => {\r\n            this.props.mode === \"tags\"\r\n              ? this.handleDeletePopup(true)\r\n              : this.handleDelete();\r\n          }}\r\n        >\r\n          <span className=\"icon-close delete-digest-icon\"></span>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DeleteIcon;\r\n","import { connect } from \"react-redux\";\r\nimport { stateType } from \"../../store\";\r\nimport {\r\n  handleFetchBookmarks,\r\n  handleFetchNotes,\r\n  handleShowBookmark,\r\n} from \"../../store/actions\";\r\nimport DeleteIcon from \"./component\";\r\nimport { withTranslation } from \"react-i18next\";\r\nconst mapStateToProps = (state: stateType) => {\r\n  return {\r\n    digests: state.reader.digests,\r\n    bookmarks: state.reader.bookmarks,\r\n    notes: state.reader.notes,\r\n    isReading: state.book.isReading,\r\n  };\r\n};\r\nconst actionCreator = {\r\n  handleFetchBookmarks,\r\n  handleFetchNotes,\r\n  handleShowBookmark,\r\n};\r\nexport default connect(\r\n  mapStateToProps,\r\n  actionCreator\r\n)(withTranslation()(DeleteIcon as any));\r\n"],"sourceRoot":""}